------------------------------------------------------------------------
r1952 | mdorr | 2024-07-29 13:40:04 -0700 (Mon, 29 Jul 2024) | 3 lines

Adding a LICENSE file


------------------------------------------------------------------------
r1951 | mdorf | 2024-07-11 17:25:50 -0700 (Thu, 11 Jul 2024) | 1 line

1. Added a PC (basicGKPreconditioner) for ConsDragDiffusion collision model. 2. Fixed parameters parsing for the BasicGKPrecondtioner model. 3. Added clarifying comments to RosenbluthPotentials calculations.
------------------------------------------------------------------------
r1950 | mdorf | 2024-06-30 15:04:36 -0700 (Sun, 30 Jun 2024) | 1 line

1. Fixed two bugs in the ConsDragDiff model (stable dt calculation and self-consistent frequency calculation), also miscellaneous performance improvements. 2. Added a new model for a prescribed source. 3. Added the physical coordinate option for arbitrary kinetic function
------------------------------------------------------------------------
r1949 | debo | 2024-06-17 12:56:56 -0700 (Mon, 17 Jun 2024) | 1 line

Updated PETSc initial setup to fix seg faults caused by changes in PETSc defaults
------------------------------------------------------------------------
r1948 | mdorf | 2024-04-18 21:48:01 -0700 (Thu, 18 Apr 2024) | 1 line

Added functionality to restart simulations for the case where initial dfn is used in the vorticity models
------------------------------------------------------------------------
r1947 | mdorr | 2024-03-26 10:56:59 -0700 (Tue, 26 Mar 2024) | 3 lines

Removing an erroneous assertion check.


------------------------------------------------------------------------
r1946 | mdorf | 2024-03-25 12:06:18 -0700 (Mon, 25 Mar 2024) | 1 line

Fixed a bug that was accidentally introduced in r1945
------------------------------------------------------------------------
r1945 | mdorf | 2024-03-25 11:47:06 -0700 (Mon, 25 Mar 2024) | 1 line

Improved the BGK collision model to conserve three moments
------------------------------------------------------------------------
r1944 | mdorr | 2024-02-21 22:31:07 -0800 (Wed, 21 Feb 2024) | 3 lines

Adding ghost box initialization as empty and adding an assert for non-empty adjacent block intersection in PhaseGeom::getShearedGhostBoxLayouts()


------------------------------------------------------------------------
r1943 | mdorr | 2024-02-20 19:07:38 -0800 (Tue, 20 Feb 2024) | 5 lines

Modified the construction of the ghost BoxLayouts in PhaseGeom::getShearedGhostBoxLayouts() to fix a bug that can sometimes occur in single null geometries depending upon the box decomposition.

Added checks in	OneDimData::createInterpolationRBF() and OneDimData::createInterpolationMBA() to make sure that the file being read actually exists.


------------------------------------------------------------------------
r1942 | mdorr | 2024-02-16 23:27:56 -0800 (Fri, 16 Feb 2024) | 4 lines

Fixing a bug in SpaceUtils::MaxNorm and adding SpaceUtils::L2Norm.  Replacing all other local MaxNorm and L2Norm implementations in the code by the SpaceUtils versions



------------------------------------------------------------------------
r1941 | mdorf | 2024-02-12 17:39:23 -0800 (Mon, 12 Feb 2024) | 1 line

Fixed a bug in the radial force balance diagnostics
------------------------------------------------------------------------
r1940 | mdorf | 2024-02-02 11:36:26 -0800 (Fri, 02 Feb 2024) | 1 line

Added the BGK collisional model
------------------------------------------------------------------------
r1939 | debo | 2024-01-22 17:50:15 -0800 (Mon, 22 Jan 2024) | 1 line

Removing checkpoint argument for preSolutionOpEval since it is called with only one checkpoint value
------------------------------------------------------------------------
r1938 | mdorf | 2024-01-12 11:49:39 -0800 (Fri, 12 Jan 2024) | 1 line

Improved the optimized time-integration scheme for the vorticity model.
------------------------------------------------------------------------
r1937 | mdorf | 2024-01-02 17:26:09 -0800 (Tue, 02 Jan 2024) | 1 line

Moved creation of the m_velocity member of the KineticSpecies class into the KineticSpecies::computeVelocity() function in order to reduce memory allocation in the BC classes
------------------------------------------------------------------------
r1936 | mdorr | 2023-12-14 17:06:40 -0800 (Thu, 14 Dec 2023) | 3 lines

Adding some input parameters to increase control of some large CFL cases.


------------------------------------------------------------------------
r1935 | debo | 2023-12-08 23:19:24 -0800 (Fri, 08 Dec 2023) | 1 line

PETSc: fixed erroneous initial dt when COGENT specifies CFL (instead of fixed_dt) and adaptive timestepping is being used
------------------------------------------------------------------------
r1934 | debo | 2023-12-08 16:54:21 -0800 (Fri, 08 Dec 2023) | 1 line

PETSc: fixed the stage-counting code in postTimeStage for restart run
------------------------------------------------------------------------
r1933 | debo | 2023-12-06 20:10:27 -0800 (Wed, 06 Dec 2023) | 1 line

Added restart capability to PETSc simulations; added two ARK methods for index-1 DAEs
------------------------------------------------------------------------
r1932 | mdorr | 2023-12-05 11:11:18 -0800 (Tue, 05 Dec 2023) | 3 lines

Passing in non-null vector arguments to HYPRE_BoomerAMGSetup(), which for some reason don't seem to be needed when running optimized, but are when running debug.


------------------------------------------------------------------------
r1931 | mdorf | 2023-11-09 17:35:33 -0800 (Thu, 09 Nov 2023) | 1 line

Updated OneBlockCoordSys class to follow SingleNullBlockCoordSys methods for computing Bfield and 3D mapping
------------------------------------------------------------------------
r1930 | mdorf | 2023-10-11 15:40:35 -0700 (Wed, 11 Oct 2023) | 1 line

Fixed a decomposition bug in 3D grid construction
------------------------------------------------------------------------
r1929 | mdorf | 2023-07-31 20:17:18 -0700 (Mon, 31 Jul 2023) | 1 line

Fixed a bug in the implementation of parallel mapped hyperviscosity, added ExB_gradN term with upwind discretization
------------------------------------------------------------------------
r1928 | angus1 | 2023-07-21 14:51:48 -0700 (Fri, 21 Jul 2023) | 1 line

adding a 5D IdealMhd input deck in sample_inputs for doing interchange simulations in a toroidal geometry. This input deck is suitable for regression testing.
------------------------------------------------------------------------
r1927 | angus1 | 2023-07-21 14:49:49 -0700 (Fri, 21 Jul 2023) | 1 line

fixed bug in ExtendedMhdOp related to NaNs in ghost layers. Multiple updates to IdealMhdOp related to different choices for Geometry/symmetry, and new additions for doing 3D tokamak simulations.
------------------------------------------------------------------------
r1926 | mdorf | 2023-07-20 12:23:19 -0700 (Thu, 20 Jul 2023) | 1 line

Added an option for mapped hyperviscosity; added cylindrical coordinates option in 3D
------------------------------------------------------------------------
r1925 | debo | 2023-07-19 15:36:14 -0700 (Wed, 19 Jul 2023) | 1 line

Implemented checking linearity of the function being solved by the Newton solver
------------------------------------------------------------------------
r1924 | mdorr | 2023-06-28 18:06:03 -0700 (Wed, 28 Jun 2023) | 3 lines

Fixing printing of the relative residual and removing unused variables


------------------------------------------------------------------------
r1923 | mdorf | 2023-06-19 19:54:24 -0700 (Mon, 19 Jun 2023) | 1 line

Fixed J factor for the hyperviscosity term; also miscellaneous refactoring/improvements in the vorticity model
------------------------------------------------------------------------
r1922 | mdorf | 2023-05-31 11:34:09 -0700 (Wed, 31 May 2023) | 1 line

Updated fluid capabilities: added stable-dt calculation, refactored RS term evaluation, etc
------------------------------------------------------------------------
r1921 | mdorr | 2023-05-18 08:49:58 -0700 (Thu, 18 May 2023) | 3 lines

Removing an unnecessary exclamation point in an error message string that breaks the NERSC build


------------------------------------------------------------------------
r1920 | mdorr | 2023-04-27 11:35:10 -0700 (Thu, 27 Apr 2023) | 3 lines

Updating the build scripts to include the latest compiler and HDF5 libraries as the defaults/examples


------------------------------------------------------------------------
r1919 | mdorr | 2023-04-26 15:04:05 -0700 (Wed, 26 Apr 2023) | 3 lines

Minor edits to remove the OPT=TRUE compiler warnings that appeared after the upgrade to gcc/gfortran 12.1.1


------------------------------------------------------------------------
r1918 | debo | 2023-04-17 18:14:35 -0700 (Mon, 17 Apr 2023) | 1 line

Fix in initializeTI() - cannot call setEMFields at this stage
------------------------------------------------------------------------
r1917 | mdorr | 2023-04-05 23:03:32 -0700 (Wed, 05 Apr 2023) | 3 lines

Moving the addition of the div(jpar) term when ALT_DIV_JPAR is defined back into the addDivJpar() member function.


------------------------------------------------------------------------
r1916 | mdorf | 2023-02-20 16:54:12 -0800 (Mon, 20 Feb 2023) | 1 line

Added hyperviscosity and other useful utilities to be used with fluid models
------------------------------------------------------------------------
r1915 | debo | 2023-02-14 19:50:43 -0800 (Tue, 14 Feb 2023) | 1 line

removed the requirement that ARK methods be first-stage-explicit; added two SSP IMEX methods with first stage implicit
------------------------------------------------------------------------
r1914 | angus1 | 2023-02-10 10:33:20 -0800 (Fri, 10 Feb 2023) | 1 line

updating/refactoring of ghost cell filling for fluid variables as needed for properly handling general 3D geometries.
------------------------------------------------------------------------
r1913 | angus1 | 2023-02-09 15:58:31 -0800 (Thu, 09 Feb 2023) | 1 line

removing my initials from some commented out exchange calls on metric quantities in MagGeom class.
------------------------------------------------------------------------
r1912 | angus1 | 2023-02-09 15:54:16 -0800 (Thu, 09 Feb 2023) | 1 line

updated OneBlockCoordSys to use POL namespace. Can load 2D axisymmetric grids in 3D now.
------------------------------------------------------------------------
r1911 | angus1 | 2023-02-09 10:15:47 -0800 (Thu, 09 Feb 2023) | 1 line

added some more infrastrucutre for fluid simulations with general non-orthogonal coordinates.
------------------------------------------------------------------------
r1910 | angus1 | 2023-02-08 15:08:15 -0800 (Wed, 08 Feb 2023) | 1 line

adding infrastructure for using node-centered variables in fluid modules.
------------------------------------------------------------------------
r1909 | angus1 | 2023-02-08 12:36:18 -0800 (Wed, 08 Feb 2023) | 1 line

added an ability to specify an array of output times in the input file. this is useful when the physical time scale of interest is dynamic.
------------------------------------------------------------------------
r1908 | angus1 | 2023-02-08 10:56:26 -0800 (Wed, 08 Feb 2023) | 1 line

added some functions to SpaceUtils for 3D EMHD/MHD modules. this includes the ZIP interpolation method.
------------------------------------------------------------------------
r1907 | mdorf | 2023-02-06 15:20:40 -0800 (Mon, 06 Feb 2023) | 1 line

Extended drift fluid model to include ExB nonlinearities; also fixed the order of hyperviscosity dissipation
------------------------------------------------------------------------
r1906 | debo | 2023-02-02 20:05:18 -0800 (Thu, 02 Feb 2023) | 1 line

1) Skipping EM fields computation in implicitOpImEx when no fluid or scalars are present; 2) consistently update EM fields and physical species objects for time-accurate simulations; 3) small indentation fix in GMRES screen op
------------------------------------------------------------------------
r1905 | mdorf | 2023-02-01 10:34:08 -0800 (Wed, 01 Feb 2023) | 1 line

Added code for the initialization of EMVorticity model, also fixed a few issues with the ALT_DIV_JPAR branch
------------------------------------------------------------------------
r1904 | mdorf | 2023-01-28 10:52:28 -0800 (Sat, 28 Jan 2023) | 1 line

Generalized capability for applying initialization constraints in fluid models; also added a separate class for an advection operator solver
------------------------------------------------------------------------
r1903 | mdorr | 2023-01-26 09:34:15 -0800 (Thu, 26 Jan 2023) | 3 lines

Setting previously unused vector arguments in the HYPRE_<solver name>Setup function calls


------------------------------------------------------------------------
r1902 | debo | 2023-01-23 11:31:33 -0800 (Mon, 23 Jan 2023) | 1 line

Bugfix in updating EM fields when running time-accurate simulations
------------------------------------------------------------------------
r1901 | debo | 2023-01-20 13:51:40 -0800 (Fri, 20 Jan 2023) | 1 line

Added an input flag to turn off performance-related optimizations that reduce time accuracy (on by default) ("gksystem.enable_ti_optimizations"); added the option to write out the serialized ODE vector to file (binary) at the same time as other solution outputs ("simulation.write_ode_vec"); added a utility code to compute diff between two ODE vector binary files (utils/odevec_diff.cpp); Newton solver prints reason convergence reason at exit
------------------------------------------------------------------------
r1900 | debo | 2023-01-19 21:50:24 -0800 (Thu, 19 Jan 2023) | 1 line

removed nfs temp file
------------------------------------------------------------------------
r1899 | mdorr | 2023-01-13 19:47:45 -0800 (Fri, 13 Jan 2023) | 3 lines

Undefining ALFVEN_WAVE_TEST


------------------------------------------------------------------------
r1898 | mdorr | 2023-01-13 14:47:38 -0800 (Fri, 13 Jan 2023) | 3 lines

Adding checks to ensure that the specified solver type is either BiCGStab or GMRES


------------------------------------------------------------------------
r1897 | mdorr | 2023-01-12 19:17:22 -0800 (Thu, 12 Jan 2023) | 3 lines

Adding the ability to specify parameters for the two subsolvers associated with the EM Alfven preconditioner.  Modified GKOps::setEMFields to only compute the Apar derivatives when the last boolean argument (renamed a_phase_space_update) is true.


------------------------------------------------------------------------
r1896 | ricketson1 | 2023-01-12 12:39:00 -0800 (Thu, 12 Jan 2023) | 1 line

Implemented improved method for generating SGCT grids that can accommodate increased anisotropy in resolution.
------------------------------------------------------------------------
r1895 | mdorf | 2023-01-10 14:11:18 -0800 (Tue, 10 Jan 2023) | 1 line

Added a hyper-viscosity term to the EMVorticity model
------------------------------------------------------------------------
r1894 | mdorr | 2023-01-10 11:44:43 -0800 (Tue, 10 Jan 2023) | 3 lines

Improving a couple comments and removing some unintentionally committed code.


------------------------------------------------------------------------
r1893 | mdorr | 2023-01-10 10:29:04 -0800 (Tue, 10 Jan 2023) | 7 lines

Refactoring to generalize interfaces related to electromagnetic	field data.

Previously, an EField object was used to store the electric field (in all of its various forms: cell/face-centered in configuration space and face-centered injected into phase space).  When a function needed electric field information, either a reference to the entire EField object was passed in, or just a LevelData obtained from an accessor, as in the calculation of the gyrokinetic velocity.  The EField object also provided all of the operations needed to update the potential (phi), in addition to the corresponding electric field.

Now, a new EMFields class is used to contain all electromagnetic field information (currently phi, E-field, Apar, Apar derivatives (needed for the GK velocity)).  All function	interfaces that	previously included an EField object (or something it provided) have been changed to use an EMFields object reference instead.  These interfaces will therefore not have to be changed as the electromagetic model is further developed, only EMFields.  EMFields is purely a container class.  Its members are intended to be updated by two new classes PhiOps and AparOps.  PhiOps (and derived special-case classes PhiAmpereOps and PhiSelfConsistentBCOps) provide the operations previously provided by EField (and corresponding special case derived classes) for updating the potential phi and corresponding electric field.  Analogously, AparOps provides the operations needed to update the data related to Apar in EMFields, currently its spatial and temporal derivates (provided by an EMVorticityOp).


------------------------------------------------------------------------
r1892 | debo | 2022-12-14 18:17:42 -0800 (Wed, 14 Dec 2022) | 1 line

Minor fix to screen output formatting
------------------------------------------------------------------------
r1891 | mdorf | 2022-11-16 10:31:07 -0800 (Wed, 16 Nov 2022) | 1 line

Updated diagnostics capabilities
------------------------------------------------------------------------
r1890 | mdorr | 2022-11-11 13:10:33 -0800 (Fri, 11 Nov 2022) | 3 lines

Modified the PhaseGeom plot routines to include a ProblemDomain with as many ghost cells as the data being plotted, which is needed in order to inspect physical ghost cell values in VisIt.


------------------------------------------------------------------------
r1889 | debo | 2022-11-10 14:00:10 -0800 (Thu, 10 Nov 2022) | 1 line

added further info in a sparse grids error messa
------------------------------------------------------------------------
r1888 | mdorf | 2022-10-31 11:54:00 -0700 (Mon, 31 Oct 2022) | 1 line

Fixed a bug in the implementation of the ExB current for the divFreeVel = true option
------------------------------------------------------------------------
r1887 | mdorr | 2022-10-28 17:48:22 -0700 (Fri, 28 Oct 2022) | 6 lines

Fixing bug in coupling_comp index calculation

---This line, and those below, will be ignored--

M    vlasov/GKVlasovAMG.cpp

------------------------------------------------------------------------
r1886 | mdorf | 2022-10-21 15:29:57 -0700 (Fri, 21 Oct 2022) | 1 line

Fixed a bug in the calculation of SelfConsistent BCs for the case of multiple ion species used together with the velocity renormalization; added local utilities to compute dot product for LevelData's
------------------------------------------------------------------------
r1885 | mdorr | 2022-10-14 20:34:06 -0700 (Fri, 14 Oct 2022) | 3 lines

Updating the Alfven wave EM preconditioner


------------------------------------------------------------------------
r1884 | mdorr | 2022-10-13 19:12:46 -0700 (Thu, 13 Oct 2022) | 3 lines

Recommitting Hypre 2.25.0


------------------------------------------------------------------------
r1883 | mdorr | 2022-10-13 17:34:54 -0700 (Thu, 13 Oct 2022) | 3 lines

Temporarily removing Hypre to brute force resolve an apparent tree conflict introduced by r1881


------------------------------------------------------------------------
r1882 | mdorr | 2022-10-13 13:58:26 -0700 (Thu, 13 Oct 2022) | 3 lines

Fixing accidental commit in r1881


------------------------------------------------------------------------
r1881 | mdorr | 2022-10-13 13:23:23 -0700 (Thu, 13 Oct 2022) | 3 lines

Updating to Hypre 2.25.0


------------------------------------------------------------------------
r1880 | mdorf | 2022-08-09 15:48:54 -0700 (Tue, 09 Aug 2022) | 1 line

1. Fixed a bug in the full EM vorticity preconditioner; 2. Fixed a bug in the LinearizedUnlike operator (found by Alex Knyazev); 3. Added BpolMagnitude output to the magnetic field data diagnostics
------------------------------------------------------------------------
r1879 | mdorr | 2022-08-02 19:44:23 -0700 (Tue, 02 Aug 2022) | 3 lines

Adding another version of the Alfven wave EMVorticity preconditioner.


------------------------------------------------------------------------
r1878 | mdorf | 2022-08-01 15:01:23 -0700 (Mon, 01 Aug 2022) | 1 line

Added BE option for the EMVorticity model; also added enforcement of pointwise positivity
------------------------------------------------------------------------
r1877 | mdorf | 2022-07-25 18:24:19 -0700 (Mon, 25 Jul 2022) | 1 line

Added capability to compute toroidal flux function and safety factor; also added a matlab script to read onetwo files and post-process plasma profiles by flattening at the core boundary and extrapolating to sol.
------------------------------------------------------------------------
r1876 | mdorr | 2022-07-14 14:37:45 -0700 (Thu, 14 Jul 2022) | 3 lines

Adding the ability to specify the AMG strong threshold for the MGR coarse correction solve from the input.


------------------------------------------------------------------------
r1875 | mdorr | 2022-07-12 15:55:07 -0700 (Tue, 12 Jul 2022) | 3 lines

Fixing the assignment of global DOFs for multiple fluid species.


------------------------------------------------------------------------
r1874 | mdorr | 2022-07-06 22:41:59 -0700 (Wed, 06 Jul 2022) | 3 lines

Updating PhaseGeom::getShearedGhostBoxLayouts() to only perform the "no man's land" optimization for single null geometries.  Some other refactoring and cleanup, including the removal of a hardwired parameter that was likely problem-dependent.


------------------------------------------------------------------------
r1873 | mdorf | 2022-07-03 19:36:58 -0700 (Sun, 03 Jul 2022) | 1 line

Added several preconditioning options for the electromagnetic vorticity model
------------------------------------------------------------------------
r1872 | mdorr | 2022-06-30 14:35:07 -0700 (Thu, 30 Jun 2022) | 3 lines

Adding an approximate ideal restriction (AIR) option for use with Hypre's BoomerAMG solver.


------------------------------------------------------------------------
r1871 | mdorr | 2022-06-24 20:26:02 -0700 (Fri, 24 Jun 2022) | 3 lines

Restoring the MGR_schur flag accidentally omitted in r1868.


------------------------------------------------------------------------
r1870 | mdorr | 2022-06-22 16:09:12 -0700 (Wed, 22 Jun 2022) | 3 lines

Changing the MGR frelax_method default from 2 to 1


------------------------------------------------------------------------
r1869 | mdorr | 2022-06-16 22:02:29 -0700 (Thu, 16 Jun 2022) | 3 lines

Changing BiCGStab and GMRES tolerances from absolute to relative.  Regression tests updated accordingly.


------------------------------------------------------------------------
r1868 | mdorr | 2022-06-16 20:34:26 -0700 (Thu, 16 Jun 2022) | 3 lines

Updating MBSolver and MBHypreSolver files per Joshua's r1865 commit to his branch


------------------------------------------------------------------------
r1863 | mdorr | 2022-06-14 16:17:13 -0700 (Tue, 14 Jun 2022) | 3 lines

Adding the ability to include matrix blocks corresponding to discretizations of advection operators.  This is a partial merge of Joshua's two field neutrals branch.


------------------------------------------------------------------------
r1860 | mdorr | 2022-06-10 11:01:30 -0700 (Fri, 10 Jun 2022) | 3 lines

Fixing problem affecting the plotting of configuration space state variables that aren't a fluid species.


------------------------------------------------------------------------
r1859 | mdorf | 2022-06-07 15:09:41 -0700 (Tue, 07 Jun 2022) | 1 line

Updated EM vorticity model
------------------------------------------------------------------------
r1856 | mdorf | 2022-06-05 12:24:38 -0700 (Sun, 05 Jun 2022) | 1 line

Added initial implementation of electromagnetic effects to the vorticity model
------------------------------------------------------------------------
r1855 | mdorr | 2022-05-31 12:49:48 -0700 (Tue, 31 May 2022) | 3 lines

Modifying the construction of the sheared interpolation ghost box layouts to fix the "no mans's land" problem 


------------------------------------------------------------------------
r1854 | mdorr | 2022-05-31 11:10:26 -0700 (Tue, 31 May 2022) | 7 lines

Fixing the assignment of degrees of freedom for the case of more than one species variable in VorticityOp.

Changing the degrees of freedom vector argument of the ODEVector copy member to a const reference.




------------------------------------------------------------------------
r1852 | mdorf | 2022-05-18 12:08:43 -0700 (Wed, 18 May 2022) | 1 line

Major refactoring of the vorticity model; added vorticty diffusion term to the new vorticity model
------------------------------------------------------------------------
r1851 | mdorr | 2022-05-17 16:04:49 -0700 (Tue, 17 May 2022) | 3 lines

Adding GKPoisson::updateBoundaryDataAddingCoefs() to pick up the unmapped coefficients before calling EllipticOp::updateBoundaryData.  Modified the associated calls in VorticityOp.  


------------------------------------------------------------------------
r1850 | mdorf | 2022-05-09 19:02:30 -0700 (Mon, 09 May 2022) | 1 line

Added a memory diagnostics and a capability to run simulations from a precomputed geometry and Bfield data
------------------------------------------------------------------------
r1849 | debo | 2022-04-28 18:17:58 -0700 (Thu, 28 Apr 2022) | 1 line

1) PETSc Interface: setting default preconditioner side to right, 2) Adding species-wise diagnostics when reporting Vlasov timescales and CFL, 3) Vlasov timescales now uses the same computation as dt (that includes linear stability formula) - hence, reported CFL and CFL in input file are now consistent for the fastest scale
------------------------------------------------------------------------
r1848 | debo | 2022-04-28 13:14:10 -0700 (Thu, 28 Apr 2022) | 1 line

PETSc interface: fixed bug that made the code use preconditioner even if input file asked for no preconditioner
------------------------------------------------------------------------
r1847 | debo | 2022-04-27 15:41:48 -0700 (Wed, 27 Apr 2022) | 1 line

PETSc interface: minor rearrangement of setting intial dt so that it works with input files where CFL is specified
------------------------------------------------------------------------
r1846 | mdorr | 2022-04-26 18:16:57 -0700 (Tue, 26 Apr 2022) | 3 lines

Replacing some unneeded FluxBoxes with FArrayBoxes


------------------------------------------------------------------------
r1845 | mdorr | 2022-04-26 17:11:30 -0700 (Tue, 26 Apr 2022) | 3 lines

Fixing an array dimensioning bug in LogRectEllipticOp.cpp resulting from the assumption of a single block.


------------------------------------------------------------------------
r1844 | mdorf | 2022-04-25 16:01:15 -0700 (Mon, 25 Apr 2022) | 1 line

Added a simple drift-fludi model; extended vorticity model to include fluid species
------------------------------------------------------------------------
r1842 | angus1 | 2022-03-24 12:17:18 -0700 (Thu, 24 Mar 2022) | 1 line

fixed a bug in IdealMhdOp for 3D runs. Updated 
------------------------------------------------------------------------
r1841 | mdorr | 2022-03-21 10:19:52 -0700 (Mon, 21 Mar 2022) | 3 lines

Removing boundary condition specifications at periodic boundaries, which have always been ignored but now generate an error


------------------------------------------------------------------------
r1840 | mdorr | 2022-03-19 13:18:26 -0700 (Sat, 19 Mar 2022) | 7 lines

Changed zero_efield to no_efield to make it clearer that no efield is included at all.  However, zero_efield will also still work in existing inputs.

Now automatically setting fixed_efield true when no_efield is true, eliminating the need to include it in the input.

Updated sample inputs correspondingly


------------------------------------------------------------------------
r1839 | angus1 | 2022-03-18 14:56:45 -0700 (Fri, 18 Mar 2022) | 1 line

missed a file during previous commit.
------------------------------------------------------------------------
r1838 | angus1 | 2022-03-18 14:52:31 -0700 (Fri, 18 Mar 2022) | 1 line

fixed bug in divergence of viscosity calc used in MHD fluid Ops.
------------------------------------------------------------------------
r1837 | mdorf | 2022-03-12 20:04:27 -0800 (Sat, 12 Mar 2022) | 1 line

Extended the prescribed source model to support relaxation and thermalization; added codim2 ghost filling for 5D anomalous transport; removed stage check for parallel velocity update in the ConsDragDiff collision model; removed setting Neumann factor for Vorticity preconditioner
------------------------------------------------------------------------
r1836 | mdorr | 2022-03-03 15:11:07 -0800 (Thu, 03 Mar 2022) | 3 lines

Adding a member to fill codim 2 cells at the phase space physical boundary.


------------------------------------------------------------------------
r1835 | mdorf | 2022-03-02 18:23:46 -0800 (Wed, 02 Mar 2022) | 1 line

some cosmetic changes to ConsDragDiffusion collision model
------------------------------------------------------------------------
r1833 | mdorr | 2022-02-26 15:50:19 -0800 (Sat, 26 Feb 2022) | 3 lines

Setting the number of ghost cells for the unmapped coefficients to IntVect::Unit


------------------------------------------------------------------------
r1831 | debo | 2022-02-25 18:15:37 -0800 (Fri, 25 Feb 2022) | 1 line

Implemented a way to have multiple block PCs for the RHS of a fluidOp
------------------------------------------------------------------------
r1829 | mdorr | 2022-02-24 20:04:16 -0800 (Thu, 24 Feb 2022) | 3 lines

Removing an assumption that the mapped and unmapped coefficients passed into EllipticOp::modifyForNeumannAndNaturalBCs() have the same number of ghost cells 


------------------------------------------------------------------------
r1828 | mdorf | 2022-02-23 13:22:04 -0800 (Wed, 23 Feb 2022) | 1 line

Major refactoring of the GKVorticity class; also extended vorticity diffusion options
------------------------------------------------------------------------
r1826 | mdorr | 2022-02-10 15:05:30 -0800 (Thu, 10 Feb 2022) | 3 lines

Correcting the modifications resulting from the imposition of true Neumann or natural boundary conditions in the block formulation of the polarization density corrected vorticity model preconditioner.


------------------------------------------------------------------------
r1823 | mdorr | 2022-01-31 18:26:43 -0800 (Mon, 31 Jan 2022) | 3 lines

Adding an option to swap the C and F point variables in the MGR solver, set the interpolation and restriction options to 2 and 0, respectively, and set the maximum iterations to 1.  This combination causes the C-reduced Schur complement of the block formulation of the polarization density corrected vorticity operator to match the original fourth-order scalar operator, which is then solved by AMG.  Also added an input to specify the strong threshold parameter for AMG.


------------------------------------------------------------------------
r1822 | mdorf | 2022-01-27 19:23:03 -0800 (Thu, 27 Jan 2022) | 1 line

Added operator splitting time integration scheme for the vorticity problem
------------------------------------------------------------------------
r1819 | mdorf | 2022-01-25 09:00:18 -0800 (Tue, 25 Jan 2022) | 1 line

Fixed a bug in the skeleton implementation of logical sheath BCs
------------------------------------------------------------------------
r1818 | debo | 2021-12-16 21:15:11 -0800 (Thu, 16 Dec 2021) | 1 line

BandedMatrix: doing MPI_Allreduce in blocks to not exceed a wierd message size limit - this fixes the imex_collisions memscape error; fixed a small bug that could have led to MPI freeze.
------------------------------------------------------------------------
r1817 | mdorf | 2021-12-14 18:06:47 -0800 (Tue, 14 Dec 2021) | 1 line

Extending the dissipation term option in the electron vorticity equation and preconditioner
------------------------------------------------------------------------
r1816 | mdorr | 2021-12-10 15:14:58 -0800 (Fri, 10 Dec 2021) | 5 lines

Adding the ability to specify physical (in addition to the previous mapped) Neumann or natural boundary conditions in operators derived from EllipticOp using EllipticOpBC.  The new Neumann condition is now specified as "neumann" in inputs, with the previous mapped Neumann specifed as "mapped_neumann".  The nightly tests and sample_inputs have been updated correspondingly.

Adding three new test codes to test the new boundary conditions in slab, annular and single null geometries


------------------------------------------------------------------------
r1815 | mdorr | 2021-12-06 17:08:48 -0800 (Mon, 06 Dec 2021) | 3 lines

Adding a potential scaling factor in the electron vorticity preconditioner


------------------------------------------------------------------------
r1814 | mdorr | 2021-12-06 14:20:20 -0800 (Mon, 06 Dec 2021) | 3 lines

Removing the need to independently specify rmin and rmax for the miller poloidal velocity test option.  These parameters are now obtained from OneBlockCoordSys.


------------------------------------------------------------------------
r1813 | mdorf | 2021-12-06 13:15:48 -0800 (Mon, 06 Dec 2021) | 1 line

Adding reading (from a g-file) and plotting of the boundary wall geometry to the grid generator
------------------------------------------------------------------------
r1812 | mdorr | 2021-12-05 17:36:47 -0800 (Sun, 05 Dec 2021) | 3 lines

Adding a dissipation term to the electron vorticity equation and preconditioner


------------------------------------------------------------------------
r1811 | mdorf | 2021-12-04 19:34:10 -0800 (Sat, 04 Dec 2021) | 1 line

Adding the g-file for DIII-D_119919
------------------------------------------------------------------------
r1810 | mdorf | 2021-12-04 16:22:51 -0800 (Sat, 04 Dec 2021) | 1 line

Adding DIII-D grid examples
------------------------------------------------------------------------
r1809 | mdorf | 2021-12-04 16:20:10 -0800 (Sat, 04 Dec 2021) | 1 line

Adding parallel capabilities to the COGENT grid generator; also improving matlab routines
------------------------------------------------------------------------
r1808 | mdorr | 2021-12-01 17:11:09 -0800 (Wed, 01 Dec 2021) | 3 lines

Adding ParmParsing of miller velocity test parameters


------------------------------------------------------------------------
r1807 | mdorr | 2021-11-24 13:31:04 -0800 (Wed, 24 Nov 2021) | 3 lines

Removing an unnecessary preconditioner update performed even when the a_update_potential argument is passed in as false


------------------------------------------------------------------------
r1806 | mdorr | 2021-11-23 16:13:25 -0800 (Tue, 23 Nov 2021) | 3 lines

Setting base class geometry pointer in overridden define() member


------------------------------------------------------------------------
r1805 | mdorf | 2021-11-22 19:25:30 -0800 (Mon, 22 Nov 2021) | 1 line

Adding safety factor diagnostics
------------------------------------------------------------------------
r1804 | mdorr | 2021-11-19 09:13:02 -0800 (Fri, 19 Nov 2021) | 3 lines

Changing computeBcDivergence() to call computeFluxDivergence() instead of repeating nearly the same code.  The one small difference between the two only effected the neoclassical tests, but only negligibly so.  


------------------------------------------------------------------------
r1803 | mdorr | 2021-11-16 10:44:22 -0800 (Tue, 16 Nov 2021) | 3 lines

Modifying script to only compare files in the plt_* subdirectories


------------------------------------------------------------------------
r1802 | mdorf | 2021-11-14 09:52:54 -0800 (Sun, 14 Nov 2021) | 1 line

Fixed a bug introduced in r1801 that broke the 4D COGENT build
------------------------------------------------------------------------
r1801 | mdorf | 2021-11-13 19:39:11 -0800 (Sat, 13 Nov 2021) | 1 line

Added diagnostics to plot 2D poloidal meshes at the lo and hi side of the toroidal block interface
------------------------------------------------------------------------
r1800 | jchristopher | 2021-11-10 11:34:50 -0800 (Wed, 10 Nov 2021) | 1 line

Updated formatting and minor fixes to 2x2 block-matrix TwoFieldNeutrals diffusion terms
------------------------------------------------------------------------
r1799 | mdorf | 2021-11-04 17:46:46 -0700 (Thu, 04 Nov 2021) | 1 line

Cleaned-up toroidalBlockRemapping function and added a new interpolation method that includes mapping curvature
------------------------------------------------------------------------
r1798 | mdorr | 2021-10-27 12:24:54 -0700 (Wed, 27 Oct 2021) | 3 lines

Adding XTRACXXFLAGS macro to build scripts


------------------------------------------------------------------------
r1797 | mdorr | 2021-10-20 22:05:04 -0700 (Wed, 20 Oct 2021) | 3 lines

Adding a slab geometry option


------------------------------------------------------------------------
r1796 | mdorr | 2021-10-19 20:48:36 -0700 (Tue, 19 Oct 2021) | 3 lines

Adding a new test velocity, where the velocity is defined by the flux surface poloidal tangent vector in a Miller-type geometry defined from a mapping file


------------------------------------------------------------------------
r1795 | mdorf | 2021-10-18 14:39:56 -0700 (Mon, 18 Oct 2021) | 1 line

Added second part of the code for Boussinesq correction option
------------------------------------------------------------------------
r1794 | mdorf | 2021-10-16 10:30:47 -0700 (Sat, 16 Oct 2021) | 1 line

Added C2 option for advection and Boussinesq option for GKPoisson
------------------------------------------------------------------------
r1793 | mdorr | 2021-10-15 13:50:58 -0700 (Fri, 15 Oct 2021) | 3 lines

Changing the matrix construction internal test to use the solver's MultiBlockLevelExchange object rather than the geometry's fillInternalGhosts, which may use a different interpolation order.  Added a right-hand side plot.


------------------------------------------------------------------------
r1792 | jchristopher | 2021-10-14 16:26:25 -0700 (Thu, 14 Oct 2021) | 1 line

Updated multiblock x-point test to be a system of equations. Currently both solution components should return the same value.
------------------------------------------------------------------------
r1791 | jchristopher | 2021-10-14 16:24:37 -0700 (Thu, 14 Oct 2021) | 1 line

A few minor fixes to rhs_from_bc. Now only the current component gets set to zero and multiplied by alpha.
------------------------------------------------------------------------
r1790 | mdorr | 2021-10-14 12:30:05 -0700 (Thu, 14 Oct 2021) | 3 lines

Adding rhs_from_bc component to modifyStencilFromBCs argument list


------------------------------------------------------------------------
r1789 | mdorr | 2021-10-14 09:59:20 -0700 (Thu, 14 Oct 2021) | 3 lines

Correcting the number of components in the m_rhs_from_bc member.


------------------------------------------------------------------------
r1788 | mdorr | 2021-10-06 21:16:29 -0700 (Wed, 06 Oct 2021) | 3 lines

Adding multiblock solver X-point test


------------------------------------------------------------------------
r1787 | mdorr | 2021-10-06 21:11:26 -0700 (Wed, 06 Oct 2021) | 3 lines

Changing an accessor to return a pointer instead of a reference


------------------------------------------------------------------------
r1786 | mdorf | 2021-10-06 09:56:01 -0700 (Wed, 06 Oct 2021) | 1 line

Fixed Fortran out-of-bound index error in diagnostics
------------------------------------------------------------------------
r1785 | mdorr | 2021-09-28 19:47:37 -0700 (Tue, 28 Sep 2021) | 3 lines

Removing Dirichlet-defaulted boundary condition.  Uncommented corresponding lines in a sample input that depended upon it (and the regression test)


------------------------------------------------------------------------
r1784 | debo | 2021-09-27 18:33:11 -0700 (Mon, 27 Sep 2021) | 1 line

Small bugfix in SG-friendly version of averaging for cells; added the option of plotting individual sparse grids solutions interpolated onto the full grid
------------------------------------------------------------------------
r1783 | ricketson1 | 2021-09-23 12:39:24 -0700 (Thu, 23 Sep 2021) | 1 line

Bug fix in the sparse grid version of computeCompFaceFluxes and its call from GKVlasov
------------------------------------------------------------------------
r1782 | mdorr | 2021-09-22 11:34:38 -0700 (Wed, 22 Sep 2021) | 3 lines

Doing another commit message test.


------------------------------------------------------------------------
r1781 | mdorr | 2021-09-22 10:33:37 -0700 (Wed, 22 Sep 2021) | 3 lines

Fixing an output message (and testing new commit message workaround for LLNL).


------------------------------------------------------------------------
r1780 | mdorf | 2021-09-19 14:02:18 -0700 (Sun, 19 Sep 2021) | 1 line

Fixed cylindrical Bcomponent diagnostcs
------------------------------------------------------------------------
r1779 | debo | 2021-09-15 15:18:55 -0700 (Wed, 15 Sep 2021) | 1 line

removed an unused var
------------------------------------------------------------------------
r1778 | debo | 2021-09-15 11:11:24 -0700 (Wed, 15 Sep 2021) | 1 line

1) Overhauled the process of selecting and plotting various diagnostics; 2) For sparse grids, use combination technique on each diagnostic rather than entire phase space solution; 3) Making SpaceUtils, SGInterp, and Lee's FourthOrderUtils multidim; and other small changes
------------------------------------------------------------------------
r1777 | ricketson1 | 2021-09-13 14:07:47 -0700 (Mon, 13 Sep 2021) | 1 line

(De)averaging between cell averages and cell centers implemented for sparse grid interpolation
------------------------------------------------------------------------
r1776 | debo | 2021-09-01 15:58:00 -0700 (Wed, 01 Sep 2021) | 1 line

added missing file; squashed warnings; removed commented code
------------------------------------------------------------------------
r1775 | debo | 2021-09-01 14:41:00 -0700 (Wed, 01 Sep 2021) | 1 line

Implemented multidomain and sparse grids simulation capabilities
------------------------------------------------------------------------
r1774 | mdorf | 2021-08-27 16:41:21 -0700 (Fri, 27 Aug 2021) | 1 line

Extended Reyonlds-stress term to work with the 4D code; fixed calculation of the normalized flux for the 5D toroidal geometry
------------------------------------------------------------------------
r1773 | angus1 | 2021-08-26 13:41:37 -0700 (Thu, 26 Aug 2021) | 1 line

removing some unused members from OneBlockCoordSys class
------------------------------------------------------------------------
r1772 | mdorf | 2021-08-17 16:00:23 -0700 (Tue, 17 Aug 2021) | 1 line

Added new diagnostics capabilities (mainly to plot ExB fluxes); set default calculation of RS-term to use UW3 scheme
------------------------------------------------------------------------
r1771 | mdorr | 2021-08-10 14:48:34 -0700 (Tue, 10 Aug 2021) | 3 lines

Changing the MGR solver to use an index array to specify the C and F points


------------------------------------------------------------------------
r1770 | ricketson1 | 2021-08-04 13:29:06 -0700 (Wed, 04 Aug 2021) | 1 line

Adding sparse grid stencils to advectUtils and their calls in GKVlasov.  Also getting rid of a wrapper function in advectUtil/mappedAdvectionFlux that's never used (GKVlasov implements its own version of the wrapper)
------------------------------------------------------------------------
r1769 | debo | 2021-07-20 20:31:32 -0700 (Tue, 20 Jul 2021) | 1 line

Bugfix in ARK Butcher tables that cause a memory leak; removed MBPETScSolver option from TwoFieldNeutralPC
------------------------------------------------------------------------
r1768 | mdorr | 2021-07-19 19:51:58 -0700 (Mon, 19 Jul 2021) | 3 lines

Fixing memory leaks


------------------------------------------------------------------------
r1767 | ricketson1 | 2021-07-16 12:03:14 -0700 (Fri, 16 Jul 2021) | 1 line

Fixed fortran indes overflow bug in sparse grid cell averaging stencil
------------------------------------------------------------------------
r1766 | debo | 2021-07-14 11:45:48 -0700 (Wed, 14 Jul 2021) | 1 line

Small corrections to the external time integrator interfaces
------------------------------------------------------------------------
r1765 | jchristopher | 2021-07-13 15:11:44 -0700 (Tue, 13 Jul 2021) | 1 line

Initial construction of analytic preconditioner. It currently solves the existing preconditioner but now as a 2x2 block matrix instead of two 1x1 matrices. Adds a new inputs file parameter 'fluid_model.neutrals.use_analytic_pc' that can be set to true to enable the analytic preconditioner or set to false to use the existing preconditioner. The default is false (using the existing preconditioner).
------------------------------------------------------------------------
r1764 | mdorf | 2021-07-06 20:18:00 -0700 (Tue, 06 Jul 2021) | 1 line

Removed cashing of face-coordinates (introduced in r1763) to save memory; also small revisions in energy-conservation diagnostics
------------------------------------------------------------------------
r1763 | mdorf | 2021-07-03 11:16:18 -0700 (Sat, 03 Jul 2021) | 1 line

Improved some diagnostics capabilities; added 1/B option to mu normalization
------------------------------------------------------------------------
r1762 | debo | 2021-07-01 19:46:21 -0700 (Thu, 01 Jul 2021) | 1 line

SUNDIALS interface: fixed the solution time written to plot files
------------------------------------------------------------------------
r1761 | debo | 2021-07-01 17:19:09 -0700 (Thu, 01 Jul 2021) | 1 line

added a README that describes how to run COGENT with SUNDIALS and PETSc, added reporting of step norm and wall time
------------------------------------------------------------------------
r1760 | debo | 2021-07-01 11:06:31 -0700 (Thu, 01 Jul 2021) | 1 line

added the option to use SUNDIALS' adaptive timestepping and a small bugfix
------------------------------------------------------------------------
r1759 | debo | 2021-06-29 21:36:34 -0700 (Tue, 29 Jun 2021) | 1 line

Implemented the SUNDIALS interface: it can be used to simulate cases without the vorticity model; has no preOpEval-based optimizations; seems to be working well for explicit and IMEX simulations; will get compiled and included automatically if SUNDIALS is available and SUNDIALS_DIR is set as an environment var pointing to the SUNDIALS installation dir; add "ti_implementation = sundials" in input file to use this; can use ARKODE's own methods as well as the ARK/RK methods implemented in COGENT
------------------------------------------------------------------------
r1758 | mdorr | 2021-06-27 12:19:10 -0700 (Sun, 27 Jun 2021) | 4 lines

Adding support for constructing Hypre matrices using stencils with extrapolated boundary conditions (needed by the electron vorticity preconditioner with the polarization density correction).



------------------------------------------------------------------------
r1757 | debo | 2021-06-25 14:55:03 -0700 (Fri, 25 Jun 2021) | 1 line

added Makefile screen output on whether compiling with PETSc or not.
------------------------------------------------------------------------
r1756 | debo | 2021-06-24 18:57:37 -0700 (Thu, 24 Jun 2021) | 1 line

Some further streamlining of the high-level time integration and simulation interfaces; resuscitated the PETSc interface - it now works for cases without vorticity model and without the preOpEval optimizations, and it uses the native multiphysics preconditioner; compilation with PETSc is now very easy - if PETSc exists and PETSC_DIR is defined in the environment, COGENT will automatically compile with the PETSc interface
------------------------------------------------------------------------
r1755 | debo | 2021-06-24 17:15:14 -0700 (Thu, 24 Jun 2021) | 1 line

Removed a bunch of compile warnings (unused vars and reorders)
------------------------------------------------------------------------
r1754 | mdorf | 2021-06-20 19:59:42 -0700 (Sun, 20 Jun 2021) | 1 line

Refined full energy density and kinetic energy density diagnostics; added energy conservation check
------------------------------------------------------------------------
r1753 | mdorf | 2021-06-18 14:58:51 -0700 (Fri, 18 Jun 2021) | 1 line

Fixed out-of-bound Fortran debug-type error
------------------------------------------------------------------------
r1752 | mdorf | 2021-06-17 11:30:06 -0700 (Thu, 17 Jun 2021) | 1 line

Updated GKVorticity model to compute self-consistent conductivity; extended calculation of flux function to larger radii for toroidal annulus case
------------------------------------------------------------------------
r1751 | debo | 2021-06-14 19:41:25 -0700 (Mon, 14 Jun 2021) | 1 line

Moved time integrators from GKSystem to the main driver level; GKSystem is now the interface between native and external time integrators and COGENT physics; some changes in class names - Simulation is now COGENTTimeIntegration, GKVector is now ODEVector; inheriting GKSystem from a purely virtual class called AppCtxt so that low-level code (eg, fluid ops) don't need to include GKSystem.H for preconditioner functions
------------------------------------------------------------------------
r1750 | mdorf | 2021-06-10 19:05:34 -0700 (Thu, 10 Jun 2021) | 1 line

Added an option for an explicit update of consistent BCs while using implicit Vlasov
------------------------------------------------------------------------
r1749 | mdorf | 2021-06-07 14:16:23 -0700 (Mon, 07 Jun 2021) | 1 line

Fixed a bug in prescribed sources (showed up for local velocity normalization); added Krook relaxation option
------------------------------------------------------------------------
r1748 | mdorr | 2021-06-03 00:21:13 -0700 (Thu, 03 Jun 2021) | 3 lines

Fixing some memory leaks


------------------------------------------------------------------------
r1747 | debo | 2021-05-28 16:58:47 -0700 (Fri, 28 May 2021) | 1 line

Cleaned up the preconditioner interface - multiphysicsPC is the only PC at the higher level including single-implicit-term cases, streamlined initializing preconditioners and the logic behind skipping their updates at time steps and stages, simplified the setting up of Fokker-Planck and Vlasov preconditioners
------------------------------------------------------------------------
r1746 | mdorr | 2021-05-25 12:21:10 -0700 (Tue, 25 May 2021) | 4 lines

Removing accidentally commited diagnostic.



------------------------------------------------------------------------
r1745 | mdorr | 2021-05-25 12:03:03 -0700 (Tue, 25 May 2021) | 3 lines

Exposing an MGR solver option specifying the method to be used for the A_ff solve.  Also changed the AMG A_FF solver default max iterations to 2.


------------------------------------------------------------------------
r1744 | mdorf | 2021-05-18 21:09:51 -0700 (Tue, 18 May 2021) | 1 line

Added flux-integrated diagnostics; removed double evaluation of executeInernalExchanges for mixedBoundariesCase (which is current 2nd order)
------------------------------------------------------------------------
r1743 | mdorf | 2021-05-17 21:58:53 -0700 (Mon, 17 May 2021) | 1 line

Cleaned-up some utilities used for diagnostics and initialization
------------------------------------------------------------------------
r1742 | mdorf | 2021-05-16 09:59:27 -0700 (Sun, 16 May 2021) | 1 line

Cleaned-up debugging code from Anomalous.cpp
------------------------------------------------------------------------
r1741 | mdorf | 2021-05-16 09:56:01 -0700 (Sun, 16 May 2021) | 1 line

Extended to 5D and cleaned up anomalous transport model; fix a bug in a prescribed sources model
------------------------------------------------------------------------
r1740 | mdorr | 2021-05-15 14:03:49 -0700 (Sat, 15 May 2021) | 3 lines

Adding FillCorners to PhaseGeom::fillInternalGhosts() and fixing codim loop index.  Moving exchange in MagGeom to be consistent with PhaseGeom analog.


------------------------------------------------------------------------
r1739 | debo | 2021-05-08 16:23:15 -0700 (Sat, 08 May 2021) | 1 line

small bugfix to stage-skipping logic while lagging Vlasov preconditioner
------------------------------------------------------------------------
r1738 | debo | 2021-05-07 18:12:06 -0700 (Fri, 07 May 2021) | 1 line

Passing time step and stage number to preconditioner update functions to allow for lagging; Implemented preconditioner update lagging for implicit Vlasov; two tiny fixes/cleanups - removed m_shift from ExplicitStageFunction and fixed a GMRES screen op thing
------------------------------------------------------------------------
r1737 | mdorr | 2021-05-07 14:00:45 -0700 (Fri, 07 May 2021) | 3 lines

Exposing more MGR solver parameters to input


------------------------------------------------------------------------
r1736 | mdorr | 2021-05-06 16:43:20 -0700 (Thu, 06 May 2021) | 7 lines

Added MGR solver frelax_amg_threshold parameter to specify the strong threshold coarsening parameter when using AMG to solve the fine grid (A_FF) block.

Changed MGR to use a prescribed A_FF block AMG smoother rather than the built in (and possibly broken) single V-cycle default

Added input option to enable/disable GKVorticity block preconditioner symmetrization (defaulted true)


------------------------------------------------------------------------
r1735 | angus1 | 2021-05-03 08:27:12 -0700 (Mon, 03 May 2021) | 1 line

new OneBlockCoordSys, major refactoring to fluid BCs, extendedMhdOp works for non-orthogonal coords
------------------------------------------------------------------------
r1734 | mdorf | 2021-04-27 13:40:55 -0700 (Tue, 27 Apr 2021) | 1 line

Added heat sources; also did some performance optimization of ConsDragDiff collision model
------------------------------------------------------------------------
r1733 | mdorf | 2021-04-20 20:16:31 -0700 (Tue, 20 Apr 2021) | 1 line

Fixed bugs in the 5D implementation of the ConsDragDiff collision model
------------------------------------------------------------------------
r1732 | mdorf | 2021-04-19 12:18:51 -0700 (Mon, 19 Apr 2021) | 1 line

Removed run-terminating diagnostics that were left in r1730
------------------------------------------------------------------------
r1731 | mdorf | 2021-04-17 17:16:30 -0700 (Sat, 17 Apr 2021) | 1 line

Updated anomalous.in test case to be consistent with r1730
------------------------------------------------------------------------
r1730 | mdorf | 2021-04-17 17:14:19 -0700 (Sat, 17 Apr 2021) | 1 line

Extended ConsDragDiff model to work in 5D and with local velocity normalization; revised ExBdata diagnostics; revised LocalizedKineticFunction to work with local velocity normalization
------------------------------------------------------------------------
r1729 | ricketson1 | 2021-04-15 15:01:04 -0700 (Thu, 15 Apr 2021) | 1 line

Initial condition functions now have options to use classical stencils or new sparse grids stencils when computing cell averages
------------------------------------------------------------------------
r1728 | mdorf | 2021-04-13 12:04:04 -0700 (Tue, 13 Apr 2021) | 1 line

Extended velocity normalization to support 5D multiblock
------------------------------------------------------------------------
r1727 | ricketson1 | 2021-04-12 11:32:19 -0700 (Mon, 12 Apr 2021) | 1 line

Fixing bug that had sparse grid stencils turned on by default in LocalizedKineticFunction... now turned off by default
------------------------------------------------------------------------
r1726 | angus1 | 2021-04-08 10:37:14 -0700 (Thu, 08 Apr 2021) | 1 line

fixed some box issues in fortran calls from MhdOps
------------------------------------------------------------------------
r1725 | debo | 2021-04-02 18:17:24 -0700 (Fri, 02 Apr 2021) | 1 line

Optimized the calculation of the Poisson LHS when including FLR effects
------------------------------------------------------------------------
r1724 | debo | 2021-04-01 18:45:36 -0700 (Thu, 01 Apr 2021) | 1 line

Implemented the FLR switching in the Vlasov E-Field calculation
------------------------------------------------------------------------
r1723 | mdorf | 2021-03-20 13:18:00 -0700 (Sat, 20 Mar 2021) | 1 line

Merged some of the local velocity normalization code from the norm branch into the trunk to support collisionless simulations
------------------------------------------------------------------------
r1722 | debo | 2021-03-19 16:32:21 -0700 (Fri, 19 Mar 2021) | 1 line

small bugfix in gyroradius calculation: use absolute value of charge because electrons exist
------------------------------------------------------------------------
r1720 | mdorf | 2021-03-18 11:18:52 -0700 (Thu, 18 Mar 2021) | 1 line

Updated EllipticOpBC classes to support recycling BCs for the two-field neutral model
------------------------------------------------------------------------
r1719 | debo | 2021-03-17 18:36:54 -0700 (Wed, 17 Mar 2021) | 1 line

1) Implemented handling of multiple species by FLR-Poisson where all the species may not include FLR effects; 2) Implemented a switch function that allows gradual switching from FLR to long-wavelength-limit near the boundaries (or anywhere else) - this function can be specified through the grid function library; 3) Calculation of gyroaveraged E-Field uses full-sized phase space objects since using optimized computeGradient for flat phase space objects still has a bug
------------------------------------------------------------------------
r1716 | mdorf | 2021-03-16 11:27:44 -0700 (Tue, 16 Mar 2021) | 1 line

Fixed a bug introduced in r1714
------------------------------------------------------------------------
r1715 | mdorf | 2021-03-14 20:36:31 -0700 (Sun, 14 Mar 2021) | 1 line

Fixed input inconsistency (outer plate BC type was not set for fluid BCs)
------------------------------------------------------------------------
r1714 | mdorf | 2021-03-14 20:34:13 -0700 (Sun, 14 Mar 2021) | 1 line

Additional refactoring of the configuraiton BC classes
------------------------------------------------------------------------
r1713 | mdorf | 2021-03-14 19:02:35 -0700 (Sun, 14 Mar 2021) | 1 line

Initial clean-up and reorganization of the configuration BC classes
------------------------------------------------------------------------
r1712 | mdorf | 2021-03-08 20:08:03 -0800 (Mon, 08 Mar 2021) | 1 line

Updated sample inputs for the fluid neutral tests
------------------------------------------------------------------------
r1711 | mdorf | 2021-03-08 20:03:03 -0800 (Mon, 08 Mar 2021) | 1 line

Added recycling BCs for TwoFieldNeutrals model. Also performed some refactoring of both one-field and two-field neutral model classes
------------------------------------------------------------------------
r1710 | debo | 2021-03-04 21:42:25 -0800 (Thu, 04 Mar 2021) | 1 line

Fixed a bug in computing mu in the gyroaverage operator; other changes: added an inject-and-expand-configuration-to-phase function that will create full-sized phase space objects from configuration space objects, cleaned up some code, in debug mode of gyroaverage operator, save and plot the computed gyroradii at all points and mu values.
------------------------------------------------------------------------
r1709 | debo | 2021-02-24 18:02:25 -0800 (Wed, 24 Feb 2021) | 1 line

1) Implemented 3rd order (tricubic) interpolation for gyro-orbit points in 3D, 2) Bugfix in the way gyro-orbit points are computed in 3D, 3) added stencil compression, 4) added interpolation for gyroaveraging in the mapped space and made it the default, 5) Cleaned up a bunch of code in FLR GKPoisson
------------------------------------------------------------------------
r1708 | mdorf | 2021-02-21 13:20:52 -0800 (Sun, 21 Feb 2021) | 1 line

Added the missing mass factor to the OneFieldOp self-consistent diffusion model; added diagnostics to TwoFieldNeutralModel
------------------------------------------------------------------------
r1707 | mdorf | 2021-02-20 13:14:37 -0800 (Sat, 20 Feb 2021) | 1 line

Added a conservative recycling BC (and removed a non-consiervative option). Renamed recenty-added functions in the Vlasov class and added some comments to improve code readability
------------------------------------------------------------------------
r1706 | mdorf | 2021-02-19 21:31:05 -0800 (Fri, 19 Feb 2021) | 1 line

Miscellaneous updates to fluid neutral models
------------------------------------------------------------------------
r1705 | mdorf | 2021-02-17 21:15:18 -0800 (Wed, 17 Feb 2021) | 1 line

Additional clean-up of Vlasov classes
------------------------------------------------------------------------
r1704 | mdorr | 2021-02-16 21:11:26 -0800 (Tue, 16 Feb 2021) | 3 lines

Added face moments


------------------------------------------------------------------------
r1703 | mdorf | 2021-02-15 13:21:42 -0800 (Mon, 15 Feb 2021) | 1 line

Included additional revisions omitted at the previous commit (r1702)
------------------------------------------------------------------------
r1702 | mdorf | 2021-02-15 12:05:52 -0800 (Mon, 15 Feb 2021) | 1 line

Cleaned up Vlasov classes
------------------------------------------------------------------------
r1701 | mdorr | 2021-02-14 19:05:34 -0800 (Sun, 14 Feb 2021) | 3 lines

Fixed ParmParse prefix


------------------------------------------------------------------------
r1700 | debo | 2021-02-12 16:41:02 -0800 (Fri, 12 Feb 2021) | 1 line

Corrected a mass factor in the gyro-Poisson equation with FLR effects
------------------------------------------------------------------------
r1699 | debo | 2021-02-10 16:53:19 -0800 (Wed, 10 Feb 2021) | 1 line

Implemented 3rd and 4th order order interpolation for gyroaveraging in 2D; cleaned up the FLR code in GKPoisson
------------------------------------------------------------------------
r1698 | mdorr | 2021-02-10 11:52:21 -0800 (Wed, 10 Feb 2021) | 5 lines

Reorganizing and cleaning up the handling of solver parameters.

Adding null constructors for some fluid operators so that they can be used to create their state variables without constructing everything else (e.g. solvers).


------------------------------------------------------------------------
r1697 | mdorf | 2021-02-08 14:05:32 -0800 (Mon, 08 Feb 2021) | 1 line

Updated fluid_diffusion_sn_impl test input to be consistent with changes introduced in r1696
------------------------------------------------------------------------
r1696 | mdorf | 2021-02-08 14:01:02 -0800 (Mon, 08 Feb 2021) | 1 line

1. Added recycling BC for a single-null geometry. 2.Misc. updates to fluid neutral models. 3. Added second-order extrapolation of moment quantities to ghosts to avoid division by zero for certain BC choices
------------------------------------------------------------------------
r1695 | mdorf | 2021-02-05 13:30:22 -0800 (Fri, 05 Feb 2021) | 1 line

Fixed index out of bound issue occuring in the debug mode
------------------------------------------------------------------------
r1694 | debo | 2021-01-29 15:05:39 -0800 (Fri, 29 Jan 2021) | 1 line

bugfix in trilinear interpolation and squashed a bunch of compiler warnings by reordering initializations and removing unused variables
------------------------------------------------------------------------
r1693 | debo | 2021-01-29 15:03:46 -0800 (Fri, 29 Jan 2021) | 1 line

1) Fixed the bilinear and trilinear interpolation for gyro-orbit points for cases where the cell is "degenerate", 2) Corrected the nondimensionalized polarization density term in gyro-Poisson equation, 3) Other fixes in the gyroaveraging operator and gyro-Poisson equation implementation
------------------------------------------------------------------------
r1692 | mdorr | 2021-01-27 18:25:00 -0800 (Wed, 27 Jan 2021) | 3 lines

Refactored the vorticity model input and modified the sample inputs accordingly


------------------------------------------------------------------------
r1691 | mdorf | 2021-01-26 15:57:19 -0800 (Tue, 26 Jan 2021) | 1 line

Added self-consistent fluid neutrals (presently, only a simple diffusion model is implemented)
------------------------------------------------------------------------
r1690 | mdorr | 2021-01-25 13:23:50 -0800 (Mon, 25 Jan 2021) | 3 lines

Fixed some memory leaks


------------------------------------------------------------------------
r1689 | mdorr | 2021-01-20 10:26:19 -0800 (Wed, 20 Jan 2021) | 3 lines

Added cout writing of the GMRES and BiCGStab final residuals and number of iterations taken


------------------------------------------------------------------------
r1688 | mdorr | 2021-01-12 11:23:38 -0800 (Tue, 12 Jan 2021) | 12 lines

Extended MBHypreSolver to accommodate block systems in which each block is an elliptic operator. Added interfaces to the Hypre ILU and MGR solvers (requires Hypre v2.20.0 placed in the hypre directory in the r1687 commit). The available input options are now GMRES, AMG, ILU or MGR.  For example:

gkpoisson.linear_solver.precond.method = "MGR"

Modified GKVorticity to specify the inclusion of the polarization density correction only through a constructor argument (i.e., not ParmParsed as previously).  When the correction is specified, a block system is constructed and solved using the MBHypreSolver block solver.

Performed some minor refactoring of GKPoisson to support the above that propagated small changes to its derived classes.

Modified VorticityOp to pass in the polarization density correction flag through the constructor.  The use of the correction for the IMEX option is still being investigated, but should be working for the old vorticity option.



------------------------------------------------------------------------
r1687 | mdorr | 2021-01-07 11:26:39 -0800 (Thu, 07 Jan 2021) | 3 lines

Adding Hypre version 2.20.0 to access the latest versions of the ILU and MGR solvers.  This required the addition of an internal Hypre header to MBHypreSolver.cpp and GKVlasovAMG.cpp


------------------------------------------------------------------------
r1686 | mdorr | 2021-01-07 11:17:39 -0800 (Thu, 07 Jan 2021) | 3 lines

Removing Hypre version 2.18.2 in preparation for replacement by version 2.20,0


------------------------------------------------------------------------
r1685 | mdorf | 2020-12-14 21:43:19 -0800 (Mon, 14 Dec 2020) | 1 line

Added recycling BCs and generalized OneFieldOp class to include kinetic ions
------------------------------------------------------------------------
r1684 | mdorf | 2020-12-04 20:12:22 -0800 (Fri, 04 Dec 2020) | 1 line

Improved and extended ExBdata diagnostics
------------------------------------------------------------------------
r1683 | mdorr | 2020-12-02 15:16:58 -0800 (Wed, 02 Dec 2020) | 3 lines

Adding use_old_amg_setup initialization to constructor from header


------------------------------------------------------------------------
r1682 | angus1 | 2020-10-08 12:58:38 -0700 (Thu, 08 Oct 2020) | 1 line

updating idealMhdOp to work in 3D
------------------------------------------------------------------------
r1681 | mdorf | 2020-09-05 09:37:40 -0700 (Sat, 05 Sep 2020) | 1 line

Added an option to include polarization density corrections to the electron pressure term. Presently this option is only supprted by the old vorticity model.
------------------------------------------------------------------------
r1680 | debo | 2020-09-02 17:57:15 -0700 (Wed, 02 Sep 2020) | 1 line

Fixed initial guess for ARK when solutionOp is nontrivial; added a tolerance for computing scales that is the same as the Newton solver abs tol
------------------------------------------------------------------------
r1679 | ligocki | 2020-08-28 01:04:20 -0700 (Fri, 28 Aug 2020) | 2 lines

Added a space to try to trigger a commit email...

------------------------------------------------------------------------
r1678 | mdorr | 2020-08-27 17:16:56 -0700 (Thu, 27 Aug 2020) | 5 lines

Adding a BiCGStab solver (converted from the Chombo version) for use with the ARK integrator.  Added a switch to the Newton solver to use either this as the Jacobian solver, or the previous GMRES solver, with the latter remaining the default.

Fixed the handling of outflow BCs with UW3 in the Vlasov preconditioner.


------------------------------------------------------------------------
r1677 | mdorr | 2020-08-20 18:47:17 -0700 (Thu, 20 Aug 2020) | 3 lines

Adding diagnostics


------------------------------------------------------------------------
r1676 | debo | 2020-08-19 12:34:04 -0700 (Wed, 19 Aug 2020) | 1 line

added the option of using scaled norms for IMEX solves. it is off by default. to use it, add "ark.scaled_norms = true" to the input file.
------------------------------------------------------------------------
r1675 | mdorf | 2020-08-19 11:53:13 -0700 (Wed, 19 Aug 2020) | 1 line

Added diagnostics for a local safety factor
------------------------------------------------------------------------
r1674 | mdorr | 2020-08-13 18:17:54 -0700 (Thu, 13 Aug 2020) | 3 lines

Fixing issues related to the mapping Jacobian in the Vlasov preconditioner.


------------------------------------------------------------------------
r1673 | mdorf | 2020-08-04 12:15:24 -0700 (Tue, 04 Aug 2020) | 1 line

Extended consistentBC and flux-surface averaging capabilities to support calculations in SN geometries with multiple toroidal blocks
------------------------------------------------------------------------
r1672 | mdorf | 2020-08-02 15:42:53 -0700 (Sun, 02 Aug 2020) | 1 line

Refactored kinetic species boundary condition classes to support BCs that depend on the data from other kinetic species
------------------------------------------------------------------------
r1671 | mdorf | 2020-08-02 12:04:18 -0700 (Sun, 02 Aug 2020) | 1 line

Added accessors to GKVorticity class members required for a preconditioner operator
------------------------------------------------------------------------
r1670 | mdorf | 2020-07-30 13:13:01 -0700 (Thu, 30 Jul 2020) | 1 line

Added ExB velocity and shear diagnostics; added update_interval option for recomputing a Hypre matrix for the implicit Vlasov solve
------------------------------------------------------------------------
r1669 | mdorf | 2020-07-22 11:16:47 -0700 (Wed, 22 Jul 2020) | 1 line

Moved the inhomogeneous BC contribution from the high-order polarization density correction operator to the RHS of the linear (GMRES) solver
------------------------------------------------------------------------
r1668 | mdorf | 2020-07-13 19:34:45 -0700 (Mon, 13 Jul 2020) | 1 line

Fixed a bug in the implementation of the polarization density corrections in the old vorticity model; also added infrustructure to discretize the Reynolds stress term with uwinding schemes
------------------------------------------------------------------------
r1667 | debo | 2020-07-09 19:22:41 -0700 (Thu, 09 Jul 2020) | 1 line

Minor changes to avoid warnings when compiling in debug mode; the remaining warnings are external to COGENT
------------------------------------------------------------------------
r1666 | debo | 2020-07-08 17:02:01 -0700 (Wed, 08 Jul 2020) | 1 line

A few bugfixes related to the gyroaveraging operator; printing the absolute and relative step norms in time integration; adding input parameters to control whether to include FLR effects in Vlasov and Poisson calculations
------------------------------------------------------------------------
r1665 | ricketson1 | 2020-07-08 11:32:11 -0700 (Wed, 08 Jul 2020) | 1 line

Restoring GNUmakefile to its default parameters, modified in previous commit.
------------------------------------------------------------------------
r1664 | ricketson1 | 2020-07-08 11:30:55 -0700 (Wed, 08 Jul 2020) | 1 line

Beginning to put in new stencil capability that is friendly to sparse grids
------------------------------------------------------------------------
r1663 | mdorr | 2020-07-02 15:59:00 -0700 (Thu, 02 Jul 2020) | 3 lines

Extending implicit Vlasov to single null geometry.


------------------------------------------------------------------------
r1662 | mdorr | 2020-06-24 13:11:01 -0700 (Wed, 24 Jun 2020) | 3 lines

Adding 5D build to hypre config template.


------------------------------------------------------------------------
r1661 | mdorr | 2020-06-23 13:39:28 -0700 (Tue, 23 Jun 2020) | 3 lines

Adding ELM implicit Vlasov input


------------------------------------------------------------------------
r1660 | debo | 2020-06-19 18:48:51 -0700 (Fri, 19 Jun 2020) | 1 line

Streamlined the updating of physical kinetic and fluid speciesin GKOps; consequently fixed the inconsistent time integration bug
------------------------------------------------------------------------
r1659 | mdorr | 2020-06-18 11:01:00 -0700 (Thu, 18 Jun 2020) | 3 lines

Changing hypre option calls that were problematic on Cori.


------------------------------------------------------------------------
r1658 | mdorf | 2020-06-17 09:02:06 -0700 (Wed, 17 Jun 2020) | 1 line

Extended the self-consistent BC option to support a single radial S-C boundary only for the case of LogRectCoordSys
------------------------------------------------------------------------
r1657 | mdorr | 2020-06-16 11:48:07 -0700 (Tue, 16 Jun 2020) | 3 lines

Removing unused ghost cells in the tanGradF variable in PhaseGeom::computeMetricTermProductAverage.


------------------------------------------------------------------------
r1656 | mdorf | 2020-06-12 20:06:57 -0700 (Fri, 12 Jun 2020) | 1 line

Fixed a sign bug in the calculations of polarization density correction; extended subtractFSdiv to single-null geometries; miscellaneous performance optimizations
------------------------------------------------------------------------
r1655 | mdorr | 2020-06-10 10:11:19 -0700 (Wed, 10 Jun 2020) | 4 lines

Removing the clearing of a couple std::map members, since defineBlockBC() might be called more than once (e.g., from both ExplicitStageJacobian and ImplicitStageJacobian)



------------------------------------------------------------------------
r1654 | mdorr | 2020-06-06 19:24:22 -0700 (Sat, 06 Jun 2020) | 3 lines

Extending the implicit Vlasov preconditioner to multiblock sheared annular geometry.


------------------------------------------------------------------------
r1653 | mdorf | 2020-06-04 15:28:19 -0700 (Thu, 04 Jun 2020) | 1 line

Fixed a bug in the simple_boltzmann model introduced in r1562
------------------------------------------------------------------------
r1652 | mdorf | 2020-06-04 12:18:16 -0700 (Thu, 04 Jun 2020) | 1 line

Merged Ilon's revisions for the simple_boltzmann model; also misc. improvements to the GKVorticity class
------------------------------------------------------------------------
r1651 | mdorf | 2020-06-04 10:04:02 -0700 (Thu, 04 Jun 2020) | 1 line

Fixed a ParmParse bug in LogicalSheathBC
------------------------------------------------------------------------
r1650 | mdorf | 2020-06-02 21:15:24 -0700 (Tue, 02 Jun 2020) | 1 line

Refactored GK-vorticity code; added code to support polarization density correction for the old vorticity model
------------------------------------------------------------------------
r1649 | mdorf | 2020-05-31 13:36:22 -0700 (Sun, 31 May 2020) | 1 line

Merged Ilon's revisions for (1) diagnostics, (2) sheathBCs, and (3) fixed_krho2 E-field option with the repo code
------------------------------------------------------------------------
r1648 | mdorf | 2020-05-28 11:54:30 -0700 (Thu, 28 May 2020) | 1 line

Some code refactoring to optimize the performance of self-consistent BC calculations and the iterative GKPoissonBoltzmann solve
------------------------------------------------------------------------
r1647 | mdorr | 2020-05-28 10:47:00 -0700 (Thu, 28 May 2020) | 3 lines

Adding barriers before the clock reads


------------------------------------------------------------------------
r1646 | mdorr | 2020-05-27 18:11:11 -0700 (Wed, 27 May 2020) | 4 lines

Moving SparseCoupling from src/poisson to src/util to make it also available to the kinetic Vlasov solver.



------------------------------------------------------------------------
r1645 | mdorf | 2020-05-24 16:06:49 -0700 (Sun, 24 May 2020) | 1 line

Added a new method for poloidal interpolation for the case of a sheared SN geoemtry
------------------------------------------------------------------------
r1644 | mdorf | 2020-05-19 17:22:57 -0700 (Tue, 19 May 2020) | 1 line

Extended canonical Maxwellian initialization to 4D single-null; revised injectToroidal to be consistent with physical coordinate injection
------------------------------------------------------------------------
r1643 | mdorf | 2020-05-15 20:28:47 -0700 (Fri, 15 May 2020) | 1 line

Extended self-consistent BCs and fluxBC to 3D/5D
------------------------------------------------------------------------
r1642 | mdorr | 2020-05-13 17:51:50 -0700 (Wed, 13 May 2020) | 3 lines

Setting the build dimensions back to its usual 4D default


------------------------------------------------------------------------
r1641 | mdorr | 2020-05-13 17:49:22 -0700 (Wed, 13 May 2020) | 3 lines

Removing the input directory that was superceded by sample_inputs years ago.


------------------------------------------------------------------------
r1640 | angus1 | 2020-05-11 19:09:14 -0700 (Mon, 11 May 2020) | 1 line

refactoring some high-level functionality from previous check-in
------------------------------------------------------------------------
r1639 | angus1 | 2020-05-11 08:45:43 -0700 (Mon, 11 May 2020) | 1 line

initial commit of ExtendedMhd fluid operator
------------------------------------------------------------------------
r1638 | mdorf | 2020-05-07 15:46:02 -0700 (Thu, 07 May 2020) | 1 line

Fix a 5D bug for the Linearized collision model
------------------------------------------------------------------------
r1637 | angus1 | 2020-04-30 10:01:49 -0700 (Thu, 30 Apr 2020) | 1 line

added new symmetry BC for fluid and new ibc class for localized pinch profiles
------------------------------------------------------------------------
r1636 | angus1 | 2020-04-30 08:58:43 -0700 (Thu, 30 Apr 2020) | 1 line

adding some geometry specific functionality for fluid modules
------------------------------------------------------------------------
r1635 | angus1 | 2020-04-29 14:34:15 -0700 (Wed, 29 Apr 2020) | 1 line

adding some basic utils for fluid operator calculations
------------------------------------------------------------------------
r1634 | mdorf | 2020-04-26 14:36:09 -0700 (Sun, 26 Apr 2020) | 1 line

Updated sample inputs to be consistent with the new BC parsing
------------------------------------------------------------------------
r1633 | mdorf | 2020-04-26 13:58:13 -0700 (Sun, 26 Apr 2020) | 1 line

1. Extended FS-averaged particle and heat fluxes diagnostics to 5D. 2. Improved condition for toroidal periodicity (now supports calculations with phi_max > Pi). 3. Cleaned up BC ParmParse
------------------------------------------------------------------------
r1632 | mdorr | 2020-04-25 11:26:10 -0700 (Sat, 25 Apr 2020) | 3 lines

Adding an implicit Vlasov option using the BoomerAMG AIR solver.


------------------------------------------------------------------------
r1631 | mdorr | 2020-04-24 14:46:23 -0700 (Fri, 24 Apr 2020) | 3 lines

Removing the hypre-2.9.0b directory and replacing it with a hypre directory that will contain a version of hypre consistent with the current COGENT revision.  This directory now contains the latest hypre release: v2.18.2.


------------------------------------------------------------------------
r1630 | mdorf | 2020-04-17 12:46:05 -0700 (Fri, 17 Apr 2020) | 1 line

Added BC capability to perform flux-driven calculations; also some cosmetic changes to the logical sheath interface
------------------------------------------------------------------------
r1629 | mdorf | 2020-04-10 17:27:07 -0700 (Fri, 10 Apr 2020) | 1 line

added cosmetic changes to LinearizedUnlike model
------------------------------------------------------------------------
r1628 | mdorf | 2020-04-05 12:58:31 -0700 (Sun, 05 Apr 2020) | 1 line

Performance optimizaton. Significant refactoring of the Linearized collision model; also trimmed extra ghosts in GKPoisson::computeCoefficients() function
------------------------------------------------------------------------
r1627 | geyko1 | 2020-04-02 18:33:58 -0700 (Thu, 02 Apr 2020) | 1 line

Changed the name of the 1d utils folder.
------------------------------------------------------------------------
r1626 | geyko1 | 2020-04-02 18:30:08 -0700 (Thu, 02 Apr 2020) | 1 line

1. Optimized the code, so that it compiles in MacOS. 2. Radial utils were made easier to read and use, as templates were removed.
------------------------------------------------------------------------
r1625 | mdorf | 2020-04-01 17:10:02 -0700 (Wed, 01 Apr 2020) | 1 line

Performance optimization for UnlikeCollisions, updateVelocityNormals, and Anomalous; several new CH timers added.
------------------------------------------------------------------------
r1624 | angus1 | 2020-03-30 08:08:32 -0700 (Mon, 30 Mar 2020) | 1 line

removed one-sided differencing at mu_max from dfB_dmu used in anomalous
------------------------------------------------------------------------
r1623 | mdorf | 2020-03-28 12:49:00 -0700 (Sat, 28 Mar 2020) | 1 line

Fixed the issue with ConsDgradDiff model introduced in r1600; also improved dbf_dmu calculation in the anomalous transport model
------------------------------------------------------------------------
r1622 | mdorf | 2020-03-27 11:34:45 -0700 (Fri, 27 Mar 2020) | 1 line

1. Added new diagnostics (gradPoverN). 2 Fixed fillInternalGhost to support an input with no ghosts (e.g., was required for dfn plotting).  3. Fixed the index overrun issue in FORT_DFBDMU_CELL_CENTER function of Anomalous.cpp. 4. Generalized injectConfigurationToPhase() to support pre-defined destinations. 5. Miscellaneous performance optimization refactoring for Vlasov and Transport models.
------------------------------------------------------------------------
r1621 | angus1 | 2020-03-26 06:56:10 -0700 (Thu, 26 Mar 2020) | 1 line

commented out restart option in anomalous input
------------------------------------------------------------------------
r1620 | angus1 | 2020-03-25 11:42:24 -0700 (Wed, 25 Mar 2020) | 1 line

adding anomalous to sample_inputs folder
------------------------------------------------------------------------
r1619 | mdorf | 2020-03-22 16:23:38 -0700 (Sun, 22 Mar 2020) | 1 line

Fixed a bug in Anomalous transport model introduced in r1608
------------------------------------------------------------------------
r1618 | mdorf | 2020-03-21 20:36:29 -0700 (Sat, 21 Mar 2020) | 1 line

Added unlike-species collision model
------------------------------------------------------------------------
r1617 | debo | 2020-03-19 22:51:01 -0700 (Thu, 19 Mar 2020) | 1 line

removing a useless alloc
------------------------------------------------------------------------
r1616 | debo | 2020-03-19 22:44:51 -0700 (Thu, 19 Mar 2020) | 1 line

Fixing the previous commit for non-trivial LHS
------------------------------------------------------------------------
r1615 | debo | 2020-03-19 19:37:46 -0700 (Thu, 19 Mar 2020) | 1 line

in multiphysics PC, with only one PC, setting the initial guess to rhs/shift
------------------------------------------------------------------------
r1614 | geyko1 | 2020-03-15 19:26:53 -0700 (Sun, 15 Mar 2020) | 1 line

Fixed MAXDIM 4
------------------------------------------------------------------------
r1613 | geyko1 | 2020-03-15 18:56:47 -0700 (Sun, 15 Mar 2020) | 1 line

Fixed a problem with the 5D build due to the absence of proper paths to configuration/1d
------------------------------------------------------------------------
r1612 | geyko1 | 2020-03-12 14:07:09 -0700 (Thu, 12 Mar 2020) | 1 line

Added custom magnetic field option in CylindricalBlockCoordSys class
------------------------------------------------------------------------
r1611 | mdorf | 2020-03-11 10:23:46 -0700 (Wed, 11 Mar 2020) | 1 line

Modified the input for the two_field_neutrals case to improve GMRES convergence
------------------------------------------------------------------------
r1610 | debo | 2020-02-26 11:56:04 -0800 (Wed, 26 Feb 2020) | 1 line

Bugfix in filling transverse domain boundary ghost cells for a fluxbox
------------------------------------------------------------------------
r1609 | mdorf | 2020-02-09 14:15:54 -0800 (Sun, 09 Feb 2020) | 1 line

Added code infrustructure to support logical sheath BC development
------------------------------------------------------------------------
r1608 | mdorf | 2020-02-06 17:47:04 -0800 (Thu, 06 Feb 2020) | 1 line

Refactoring of anomalous transport model and related infrastructure for the purposes of performance optimization
------------------------------------------------------------------------
r1607 | mdorf | 2020-02-04 17:10:14 -0800 (Tue, 04 Feb 2020) | 1 line

Added diagnostics for minimal cell size; added a designated function to handle distribution (packing) of poloidal grid points
------------------------------------------------------------------------
r1606 | mdorf | 2020-01-27 12:50:03 -0800 (Mon, 27 Jan 2020) | 1 line

Minor changes to Vlasov operator to improve performance for the case of divergence-free GK velocity
------------------------------------------------------------------------
r1605 | mdorf | 2020-01-27 11:43:32 -0800 (Mon, 27 Jan 2020) | 1 line

Improved grid generator for efficient handling of a fine poloidal resolution in the X-point region
------------------------------------------------------------------------
r1604 | mdorr | 2020-01-25 12:46:02 -0800 (Sat, 25 Jan 2020) | 11 lines

Adding boolean member to MagGeom and PhaseGeom to specify whether or not the geometry is being described using a field-aligned mapping (only applies for 3D single null for now).

Modified fillInternalGhosts in MagGeom and PhaseGeom to fill toroidal extrablock ghosts using an extrablock exchange rather than interpolateFromShearedGhosts when a field-aligned mapped is not being used (and extrablock exchanges are specified).

Adjusted the single null sawtooth interpolation to tolerate some roundoff error when a non-field aligned mapping is being used.

Made a small efficiency improvement in getExtrablockGhostLayout in both MagGeom and PhaseGeom.




------------------------------------------------------------------------
r1603 | mdorr | 2020-01-22 16:37:25 -0800 (Wed, 22 Jan 2020) | 3 lines

Fixing some bugs in the single null solver.


------------------------------------------------------------------------
r1602 | mdorf | 2020-01-22 11:34:53 -0800 (Wed, 22 Jan 2020) | 1 line

Added an option to strip extrablock ghost cells from the mapping
------------------------------------------------------------------------
r1601 | mdorr | 2020-01-19 11:06:48 -0800 (Sun, 19 Jan 2020) | 9 lines

Modified MagGeom::exchangeExtrablockGhosts() and PhaseGeom::exchangeExtrablockGhosts() to enable both the specification of the block boundaries as well as the exchange direction(s).  This enabled some clean up of the calculation of the interpolation stencil data computed at toroidal block boundaries needed for the construction of the multiblock preconditioners.

SingleNullCoordSys::toroidalBlockRemapping() was modified to attempt to better handle the determination of the valid neighboring block cell corresponding to a toroidal extrablock ghost.

ToroidalBlockLevelExchange was modified to also work with flux-aligned mappings single null mappings lacking smooth extension beyond block boundaries.

Fixed a bug in the initialization of the potential upon restart that had been affecting the new vorticity model.


------------------------------------------------------------------------
r1600 | mdorf | 2020-01-16 12:54:59 -0800 (Thu, 16 Jan 2020) | 1 line

Cleaned-up code related to default ghosts
------------------------------------------------------------------------
r1599 | mdorf | 2020-01-15 14:36:44 -0800 (Wed, 15 Jan 2020) | 1 line

Updated EllipticOp and extrapBoundaryGhosts operations to be consistent with a 5D single-null multiblock sheared geometry. Also, some performance optimization stuff
------------------------------------------------------------------------
r1598 | mdorf | 2019-12-28 18:12:52 -0800 (Sat, 28 Dec 2019) | 1 line

Added 5D ITG vorticity tests for annular geometry
------------------------------------------------------------------------
r1597 | mdorf | 2019-12-26 17:16:43 -0800 (Thu, 26 Dec 2019) | 1 line

Added polarization density correction to the new vorticity model; also added an option for not injecting E-field each GMRES stage of the potential solve if we don't update coefficeints (i.e., do not update distribution function)
------------------------------------------------------------------------
r1596 | mdorf | 2019-12-20 12:13:34 -0800 (Fri, 20 Dec 2019) | 1 line

Added an input file for a LHDI test
------------------------------------------------------------------------
r1595 | mdorf | 2019-12-20 12:08:19 -0800 (Fri, 20 Dec 2019) | 1 line

Updated FullFluidOp model
------------------------------------------------------------------------
r1594 | debo | 2019-12-16 18:56:10 -0800 (Mon, 16 Dec 2019) | 1 line

Implemented FLR effects in gyro-Poisson op - needs debugging
------------------------------------------------------------------------
r1593 | mdorr | 2019-12-16 11:14:28 -0800 (Mon, 16 Dec 2019) | 3 lines

Adding the precomputation of physical boundary boxes and moving them to MagCoordSys.


------------------------------------------------------------------------
r1592 | debo | 2019-12-12 20:20:47 -0800 (Thu, 12 Dec 2019) | 1 line

except for when called from evalRHS, computeVelocity ignores gyrokinetic-ness of species; also, gyroaveraged Efield needs a ghost point in mu
------------------------------------------------------------------------
r1591 | mdorr | 2019-12-11 12:14:17 -0800 (Wed, 11 Dec 2019) | 3 lines

Removing a temporary modification accidentally commited in r1513.  This slightly affected the nodal field data evaluations in the divergence-free velocity option.  


------------------------------------------------------------------------
r1590 | angus1 | 2019-12-03 12:17:02 -0800 (Tue, 03 Dec 2019) | 1 line

adding some functionality for handling time-evolving variables on cell faces and cell edges
------------------------------------------------------------------------
r1589 | ligocki | 2019-11-27 14:40:59 -0800 (Wed, 27 Nov 2019) | 2 lines

Added an openMPI include directory...

------------------------------------------------------------------------
r1588 | mdorr | 2019-11-21 14:25:34 -0800 (Thu, 21 Nov 2019) | 3 lines

Removing a diagnostic inadvertently left on in the previous commit.


------------------------------------------------------------------------
r1587 | mdorr | 2019-11-21 14:09:52 -0800 (Thu, 21 Nov 2019) | 3 lines

Adding the ability to specify EllipticOp boundary conditions on only a part of a block boundary (e.g., single null sawteeth).


------------------------------------------------------------------------
r1586 | angus1 | 2019-11-21 11:11:58 -0800 (Thu, 21 Nov 2019) | 1 line

updating sample input decks that use ideal mhd module
------------------------------------------------------------------------
r1585 | angus1 | 2019-11-21 10:09:59 -0800 (Thu, 21 Nov 2019) | 1 line

added general viscosity term to ideal mhd module
------------------------------------------------------------------------
r1584 | angus1 | 2019-11-21 07:36:54 -0800 (Thu, 21 Nov 2019) | 1 line

refactoring getting/setting metric members in MagGeom class... and added some functionality for stress tensor calculations
------------------------------------------------------------------------
r1583 | mdorr | 2019-11-18 15:04:10 -0800 (Mon, 18 Nov 2019) | 3 lines

In fillInternalGhosts() (both MagGeom and PhaseGeom), moving interpFromShearedGhosts ahead of the corner copies.


------------------------------------------------------------------------
r1582 | mdorr | 2019-11-17 16:39:19 -0800 (Sun, 17 Nov 2019) | 7 lines

Added new virtual members containsPhysicalBoundary(int block_number, int dir, Side::LoHiSide side) to MagCoordSys and PhaseCoordSys.  Modified BCUtils::isPhysicalBoundary() to make calls to these new functions instead of the previous BlockBoundary::isDomain() function it used before.  For the sheared geometry case, SingleNullPhaseCoordSys::containsPhysicalBoundary returns true when called in the toroidal direction, even though those boundaries are again set as block interfaces.  Changed the single null toroidal block boundaries back to block interfaces (i.e., periodic shifts in the case of one block).

Cleanup up some residual stuff that should have been done related to the new extrablock exchange of the previous commit.

Removed the no longer used vlasov/MappedAdvectionOp.H


------------------------------------------------------------------------
r1581 | mdorr | 2019-11-14 17:45:12 -0800 (Thu, 14 Nov 2019) | 3 lines

Adding a new version of extrablockExchange that does not use BlockRegisters.  The old version is still there for now, but the new version is the default.


------------------------------------------------------------------------
r1580 | debo | 2019-11-11 17:28:36 -0800 (Mon, 11 Nov 2019) | 1 line

In multifluidphysicsPC, if there is just one component, just apply it and save on some unnecessary operations
------------------------------------------------------------------------
r1579 | mdorr | 2019-11-10 11:10:56 -0800 (Sun, 10 Nov 2019) | 3 lines

Replacing all CornerCopiers with the new codim-by-codim approach controlled by CoDimCopyManager.


------------------------------------------------------------------------
r1578 | mdorf | 2019-11-02 16:10:02 -0700 (Sat, 02 Nov 2019) | 1 line

Added full fluid model (to support LHDI simulations). Extended Efield class to accumulate charge and mass from both kinetic and fluid species. Extended initial Maxwellian capability to enforce density to the input profile
------------------------------------------------------------------------
r1577 | mdorr | 2019-10-30 14:43:43 -0700 (Wed, 30 Oct 2019) | 3 lines

Fixing the doubling of stencil weights on the boundaries of blocks treated as interblock interfaces in directions that are also declared periodic.  This is only relevant to single block cases.


------------------------------------------------------------------------
r1576 | mdorf | 2019-10-19 11:51:09 -0700 (Sat, 19 Oct 2019) | 1 line

Fixed a bug in the ExB calculation used by old-velocity model in Vorticity.cpp
------------------------------------------------------------------------
r1575 | mdorf | 2019-10-15 11:46:56 -0700 (Tue, 15 Oct 2019) | 1 line

Improved vorticity model to support 5D and old GK-velocity options
------------------------------------------------------------------------
r1574 | mdorr | 2019-10-15 08:57:53 -0700 (Tue, 15 Oct 2019) | 3 lines

Moving the AMG setup in MBHypreSolver from just before the solve to just after the matrix construction to eliminate the unnecessary recomputation when the matrix doesn't change.  Also split the specification of solver methods and convergence parameters in both MBHypreSolver and MBPETScSolver.  This resulted in minor modifications of everything that derives from EllipticOp.


------------------------------------------------------------------------
r1573 | debo | 2019-09-26 15:02:07 -0700 (Thu, 26 Sep 2019) | 1 line

Cleaned up (somewhat) the logic behind optimizing various function calls during time integration so that it is all in one place, and time integration and solver functions are clean; also fixed the reason that prevented implicit integration of Vlasov terms
------------------------------------------------------------------------
r1572 | mdorr | 2019-09-25 16:21:04 -0700 (Wed, 25 Sep 2019) | 3 lines

Fixing bug in blockRemapping() for the eight block case affecting the determination of the valid block containing points near the X point.


------------------------------------------------------------------------
r1571 | mdorr | 2019-09-18 11:22:34 -0700 (Wed, 18 Sep 2019) | 3 lines

Correcting check on number of poloidal blocks.  Previously, the total number of blocks was used, which is now the number of poloidal blocks times the number of toroidal sectors.


------------------------------------------------------------------------
r1570 | mdorr | 2019-09-18 11:01:43 -0700 (Wed, 18 Sep 2019) | 3 lines

Turning off block boundary flux averaging for sheared geometries.


------------------------------------------------------------------------
r1569 | mdorf | 2019-09-12 19:12:39 -0700 (Thu, 12 Sep 2019) | 1 line

Substantial revisons of multiblock single-null capability
------------------------------------------------------------------------
r1568 | mdorr | 2019-09-12 16:30:18 -0700 (Thu, 12 Sep 2019) | 3 lines

Removing ghost cells from efield plots.


------------------------------------------------------------------------
r1567 | debo | 2019-08-14 14:43:56 -0700 (Wed, 14 Aug 2019) | 1 line

Bugfix in solutionPC() - need to copy computational state, not physical; implemented a default PC for Vlasov that does nothing; removed a useless line
------------------------------------------------------------------------
r1566 | angus1 | 2019-08-13 11:57:28 -0700 (Tue, 13 Aug 2019) | 1 line

adding edge and face vars to FluidSpecies class
------------------------------------------------------------------------
r1565 | angus1 | 2019-08-13 11:28:01 -0700 (Tue, 13 Aug 2019) | 1 line

adding some BC tools for edge and face vars
------------------------------------------------------------------------
r1564 | angus1 | 2019-08-13 09:58:37 -0700 (Tue, 13 Aug 2019) | 1 line

adding some infrastructure for edge and face variables
------------------------------------------------------------------------
r1563 | mdorr | 2019-08-08 17:25:05 -0700 (Thu, 08 Aug 2019) | 5 lines

Adding an accessor PhaseGrid::pids(int box_number) to return a Vector<int> containing the processor IDs of the boxes returned by PhaseGeom::velocitySlice(int box_number).

Changing the return type of PhaseGeom::velocitySlice() to be a Vector<VEL::Box> instead of a List<VEL::Box> to ensure consistency between these two accessors.   This triggered the need for a few small changes in RosenBluthPotentials.cpp 


------------------------------------------------------------------------
r1562 | dmartin | 2019-08-01 15:25:21 -0700 (Thu, 01 Aug 2019) | 3 lines

remove hardwired paths to mpi compilers


------------------------------------------------------------------------
r1561 | dmartin | 2019-08-01 15:24:51 -0700 (Thu, 01 Aug 2019) | 2 lines

updated some MPI functions calls which were using deprecated MPI API.

------------------------------------------------------------------------
r1560 | mdorf | 2019-07-17 12:59:37 -0700 (Wed, 17 Jul 2019) | 1 line

Fixed a bug in DefineBoundaries; separated the use of m_sheared_inter_stincils for SN and all other geometries. This revision should now reproduce (up to very small differences) the results of r1555 for 5D universal instability and ITG tests.
------------------------------------------------------------------------
r1559 | mdorf | 2019-07-15 16:00:34 -0700 (Mon, 15 Jul 2019) | 1 line

Added code to support a non-periodic toroidal domain for a single-block case; revised ghostVect in the reversed Copier
------------------------------------------------------------------------
r1558 | mdorf | 2019-07-09 17:33:23 -0700 (Tue, 09 Jul 2019) | 1 line

Refactored SingleNull BC code for the purposes of better performance
------------------------------------------------------------------------
r1557 | mdorf | 2019-07-03 12:53:31 -0700 (Wed, 03 Jul 2019) | 1 line

Substantial code refactoring for the purposes of better performance
------------------------------------------------------------------------
r1556 | mdorr | 2019-06-28 14:14:40 -0700 (Fri, 28 Jun 2019) | 3 lines

Adding initial code to use field-aligned mappings in a 3D single null geometry with multiple toroidal blocks.


------------------------------------------------------------------------
r1555 | mdorf | 2019-06-24 11:51:38 -0700 (Mon, 24 Jun 2019) | 1 line

Restored DataArray (nodal box) BC option for EllipticOp BCs
------------------------------------------------------------------------
r1554 | mdorf | 2019-06-21 15:55:17 -0700 (Fri, 21 Jun 2019) | 1 line

Small changes in the 4th-order code for the two-field neutral model
------------------------------------------------------------------------
r1553 | mdorf | 2019-06-20 18:48:08 -0700 (Thu, 20 Jun 2019) | 1 line

Added the test of two-field neutral model
------------------------------------------------------------------------
r1552 | mdorf | 2019-06-20 17:09:13 -0700 (Thu, 20 Jun 2019) | 1 line

Improved two-field neutral model; Fixed 4th-order bug in species Dirichet BC
------------------------------------------------------------------------
r1551 | angus1 | 2019-06-15 14:21:09 -0700 (Sat, 15 Jun 2019) | 1 line

fixing issue with upWindToFaces() for 4th order
------------------------------------------------------------------------
r1550 | angus1 | 2019-06-14 17:09:03 -0700 (Fri, 14 Jun 2019) | 1 line

refactoring IdealMhdOp
------------------------------------------------------------------------
r1549 | angus1 | 2019-06-14 12:05:07 -0700 (Fri, 14 Jun 2019) | 1 line

fluid cell_var IC set for each component now
------------------------------------------------------------------------
r1548 | mdorr | 2019-06-13 18:31:24 -0700 (Thu, 13 Jun 2019) | 3 lines

Fixing physical_coordinates_pol variable that was declared but not defined.


------------------------------------------------------------------------
r1547 | angus1 | 2019-06-13 13:33:27 -0700 (Thu, 13 Jun 2019) | 1 line

significant refactoring of IdealMHDOp for speed
------------------------------------------------------------------------
r1546 | angus1 | 2019-06-13 13:21:29 -0700 (Thu, 13 Jun 2019) | 1 line

refactoring fluid Flux/Edge BCs
------------------------------------------------------------------------
r1545 | angus1 | 2019-06-13 11:51:57 -0700 (Thu, 13 Jun 2019) | 1 line

overloading some SpaceUtils to operator on Boxes
------------------------------------------------------------------------
r1544 | angus1 | 2019-06-04 19:59:45 -0700 (Tue, 04 Jun 2019) | 1 line

refactoring use of preOpEval... fixing bug
------------------------------------------------------------------------
r1543 | angus1 | 2019-05-31 08:21:07 -0700 (Fri, 31 May 2019) | 1 line

changing m_ghostVect in GKSystem.cpp back to 4
------------------------------------------------------------------------
r1542 | angus1 | 2019-05-30 21:01:52 -0700 (Thu, 30 May 2019) | 1 line

putting m_ghost_vect in GKOps.H back to 4
------------------------------------------------------------------------
r1541 | angus1 | 2019-05-30 20:54:30 -0700 (Thu, 30 May 2019) | 1 line

refactoring convertToPhysical() calls for fluids
------------------------------------------------------------------------
r1540 | mdorf | 2019-05-23 16:58:20 -0700 (Thu, 23 May 2019) | 1 line

Major refactoring of GridFunction classes
------------------------------------------------------------------------
r1539 | angus1 | 2019-05-21 15:27:39 -0700 (Tue, 21 May 2019) | 1 line

cleaning up fluid BCs
------------------------------------------------------------------------
r1538 | mdorr | 2019-05-21 13:23:05 -0700 (Tue, 21 May 2019) | 3 lines

Removing unneeded exchanges from getPointwiseN(LD<FluxBox>&) and getPointwiseNJinverse(LD<FluxBox>&).


------------------------------------------------------------------------
r1537 | mdorf | 2019-05-20 16:20:34 -0700 (Mon, 20 May 2019) | 1 line

Updated GNUmakefile.multidim by adding src/advectUtil to CFG_DIM folders
------------------------------------------------------------------------
r1536 | mdorf | 2019-05-20 16:18:39 -0700 (Mon, 20 May 2019) | 1 line

Added two-field neutral model, also some minor changes to ImEx preconditioner infrastructure
------------------------------------------------------------------------
r1535 | angus1 | 2019-05-16 14:35:07 -0700 (Thu, 16 May 2019) | 1 line

fixing bug that prevented 5D build
------------------------------------------------------------------------
r1534 | angus1 | 2019-05-14 10:54:57 -0700 (Tue, 14 May 2019) | 1 line

deleting unsimplified fluid samples
------------------------------------------------------------------------
r1533 | angus1 | 2019-05-14 10:49:06 -0700 (Tue, 14 May 2019) | 1 line

simplifying fluid samples
------------------------------------------------------------------------
r1532 | angus1 | 2019-05-14 10:32:00 -0700 (Tue, 14 May 2019) | 1 line

adding fluid module samples
------------------------------------------------------------------------
r1531 | angus1 | 2019-05-13 20:53:46 -0700 (Mon, 13 May 2019) | 1 line

updating IdealMhd computeDt()
------------------------------------------------------------------------
r1530 | angus1 | 2019-05-13 14:26:18 -0700 (Mon, 13 May 2019) | 1 line

updating fluid modules
------------------------------------------------------------------------
r1529 | geyko1 | 2019-05-08 13:57:58 -0700 (Wed, 08 May 2019) | 1 line

Fixed entropy_mode.in to be compatible with the new geometries
------------------------------------------------------------------------
r1528 | mdorf | 2019-05-01 15:32:25 -0700 (Wed, 01 May 2019) | 1 line

Improved defineBoundaries() function of LogRectCoordSys class for a toroidal multiblock case; also added the capability to subtract flux-surface averaged parallel divergence to the Vorticity solve
------------------------------------------------------------------------
r1527 | mdorf | 2019-04-22 20:44:59 -0700 (Mon, 22 Apr 2019) | 1 line

Restored m_no_parallel_streaming flag in computeGKVelocities
------------------------------------------------------------------------
r1526 | geyko1 | 2019-04-19 20:28:21 -0700 (Fri, 19 Apr 2019) | 3 lines

1. Fixed a bug with a mass factor in MomentumDensityKernel class in species/kinetic/Kernels.H
2. Added 3 magnetic configuration: constant, toroidal and bennett in src/coord/configuration/CylindricalBlockCoordSys.cpp and src/coord/configuration/CylindricalBlockCoordSys.H

------------------------------------------------------------------------
r1525 | mdorf | 2019-04-11 15:07:22 -0700 (Thu, 11 Apr 2019) | 1 line

Fixed minor bugs in the implementation of vorticity model extensions
------------------------------------------------------------------------
r1524 | mdorf | 2019-04-10 10:58:30 -0700 (Wed, 10 Apr 2019) | 1 line

Added 5D ITG test case for localy field-aligned multiblock code
------------------------------------------------------------------------
r1523 | mdorf | 2019-04-02 17:43:57 -0700 (Tue, 02 Apr 2019) | 1 line

Extended (a) SubtractMaxwellian Vlasov option and (b) Vorticity model to be compatible with the old velocity formulation
------------------------------------------------------------------------
r1522 | mdorr | 2019-04-02 09:46:25 -0700 (Tue, 02 Apr 2019) | 3 lines

Some speed improvements to help in 5D, mainly involving the precomputation of physical coordinates and normalized magnetic flux used in the application of boundary conditions.  Only the MaxwellianKineticFunction and Arbitrary GridFunction classes have been updated, since we still intend refactor these and other boundary condition class to remove redundant code.


------------------------------------------------------------------------
r1521 | debo | 2019-03-27 18:50:48 -0700 (Wed, 27 Mar 2019) | 1 line

1) Implemented selective implicit treatement of species Vlasov terms, 2) Cleaned up and extended the CFL-based dt calculation, etc to be more flexible given that we are going to be more flexible with what terms are treated implicitly, 3) implemented the preconditioning interface for Vlasov (but without an actual preconditioner), 4) bugfix in gyroaveraging operator
------------------------------------------------------------------------
r1520 | debo | 2019-03-26 18:51:51 -0700 (Tue, 26 Mar 2019) | 1 line

Finished up the gyroaveraging operator in 3D - implemented the trilinear interpolation for arbitrary points
------------------------------------------------------------------------
r1519 | mdorr | 2019-03-20 18:50:48 -0700 (Wed, 20 Mar 2019) | 5 lines

Adding toroidal periodicity to the single null block ProblemDomains (to be revisited when there are more than one block in the toroidal dimension).

Removing the reading of the mapping and flux files from the single null constructor, which was calling derived class functions before the base class construction was complete, leading to some bad behavior.  The mapping and flux files are now read by calling a readFiles() member after the single null object is constructed.


------------------------------------------------------------------------
r1518 | debo | 2019-03-20 17:58:40 -0700 (Wed, 20 Mar 2019) | 1 line

1) Extended the gyroaveraging interface to apply the operator on phase space objects; 2) Added a gyroaveragedChargeDensity() function in kinetic species that returns the charge density computed from the gyroaveraged distribution function; 3) In EField calculation, use gyroaveraged charge density on RHS of the Poisson's equation if the species is specified as gyrokinetic; 4) Cleaned up the gyroaveraging operator including some bugfixes and overhaul of the point-lookup algorithm. NOTE: In 3D, using a coefficient of 1/8 right now to compute field at gyro-orbit point from surrounding 8 points, will implemented more accurate coefficients shortly.
------------------------------------------------------------------------
r1517 | mdorf | 2019-03-19 11:26:25 -0700 (Tue, 19 Mar 2019) | 1 line

Added toroidal IC option for a 3D SingleNull geometry
------------------------------------------------------------------------
r1516 | mdorf | 2019-03-19 11:10:42 -0700 (Tue, 19 Mar 2019) | 1 line

Added headers for C++11 arrays; required to support build on MacOS
------------------------------------------------------------------------
r1515 | mdorr | 2019-03-15 12:49:19 -0700 (Fri, 15 Mar 2019) | 9 lines

Adding a field-aligned mapping option for the 3D single null geometry, enabled in input files via:

gksystem.magnetic_geometry_mapping.singlenull.field_aligned_mapping = true

with the default set to false.

Also renaming coord/configuration/poloidal to coord/configuration/2d and adding coord/configuration/3d to contain configuration geometry files that are explicitly 2D or 3D, respectively.


------------------------------------------------------------------------
r1514 | mdorr | 2019-03-07 16:04:55 -0800 (Thu, 07 Mar 2019) | 3 lines

Replacing absolute path names for the mapping and flux files with local.


------------------------------------------------------------------------
r1513 | mdorr | 2019-03-07 14:23:18 -0800 (Thu, 07 Mar 2019) | 13 lines

Refactoring the single null geometries to:

1. Enable limited 3D operation.  Current restrictions:
   a. one periodic toroidal block
   b. toroidal mapping only (i.e. not yet field-aligned)
   c. model geometry implementation still needs work

2. Remove much replicated code by deriving all single null geometries from SingleNullBlockCoordSys and SingleNullCoordSys.  There is now a "poloidal" subdirectory of src/coord/configuration containing code that is always 2D (e.g., the code that reads the mapping and flux files) regardless of whether CFG_DIM=2 or CFG_DIM=3.

Also added a 5D flux-aligned single null loss cone sample problem "sn_flux_aligned".



------------------------------------------------------------------------
r1512 | mdorf | 2019-03-04 18:59:27 -0800 (Mon, 04 Mar 2019) | 1 line

Fixed the zero_larmor option
------------------------------------------------------------------------
r1511 | mdorf | 2019-03-04 16:53:07 -0800 (Mon, 04 Mar 2019) | 1 line

Added 5D single-block ITG test case; used for CYCLONE Base Case verification
------------------------------------------------------------------------
r1510 | mdorf | 2019-03-04 16:18:30 -0800 (Mon, 04 Mar 2019) | 1 line

Minor code modifications to support CYCLONE baseline case testing. Includes harmonic filtering capability, plotting non-zonal potential component, some modifications to CanonicalMaxwellian. Also, updated simple_boltzmann model
------------------------------------------------------------------------
r1509 | debo | 2019-02-21 20:19:12 -0800 (Thu, 21 Feb 2019) | 1 line

1) Implemented the computation of electric field from gyroaveraged potential, 2) updated Vlasov velocity calculation to use this gyroaveraged E-field if species is specified to be gyrokinetic (kinetic_species.<n>.is_gyrokinetic = true [default - false]), 3) added gradient calculation functions to PhaseGeom on the same lines as what was available in MagGeom and also functions that compute CFG-space-only gradients of phase space objects, and 4) Unified some multidim gradient calculation and interpolation/extrapolation functions in SpaceUtils that are called by EllipticOp, MagGeom, and PhaseGeom.
------------------------------------------------------------------------
r1508 | mdorf | 2019-02-20 17:44:51 -0800 (Wed, 20 Feb 2019) | 1 line

Added inspect function for BoxLayoutData objects
------------------------------------------------------------------------
r1507 | mdorf | 2019-01-29 11:05:55 -0800 (Tue, 29 Jan 2019) | 1 line

Fixed a bug in implementation of magnetic flux function for arbitrary q2
------------------------------------------------------------------------
r1506 | mdorf | 2019-01-28 18:17:43 -0800 (Mon, 28 Jan 2019) | 1 line

Added new option for canonical Maxwellian profiles
------------------------------------------------------------------------
r1505 | mdorf | 2019-01-28 18:04:37 -0800 (Mon, 28 Jan 2019) | 1 line

Added magnetic flux function calculation for arbitrary q2 in ToroidalBlockCoordSys geometry class
------------------------------------------------------------------------
r1504 | mdorf | 2019-01-28 12:29:44 -0800 (Mon, 28 Jan 2019) | 1 line

Added ionization term to fluid diffusion model
------------------------------------------------------------------------
r1503 | mdorf | 2019-01-22 15:58:01 -0800 (Tue, 22 Jan 2019) | 1 line

Fixed indexing in 2D pointwise calculation of metric factors
------------------------------------------------------------------------
r1502 | mdorf | 2019-01-22 10:15:00 -0800 (Tue, 22 Jan 2019) | 1 line

Fxied a bug in the calculation of magnetic field data for toroidal geometry class
------------------------------------------------------------------------
r1501 | mdorr | 2019-01-17 10:10:34 -0800 (Thu, 17 Jan 2019) | 3 lines

Fixing vparallel index in compute_bstar_parallel.


------------------------------------------------------------------------
r1500 | debo | 2018-12-13 18:29:43 -0800 (Thu, 13 Dec 2018) | 1 line

Gyroaverage operator and the gyroaveraged variables are now phase-space (collapsed along vpar) data.
------------------------------------------------------------------------
r1499 | mdorr | 2018-12-11 12:37:12 -0800 (Tue, 11 Dec 2018) | 3 lines

Fixing the restart for the fixed_efield option.


------------------------------------------------------------------------
r1491 | mdorr | 2018-12-07 10:54:56 -0800 (Fri, 07 Dec 2018) | 4 lines

Reparing and refactoring the old vorticity model.  Modified the new step_const_coef option.



------------------------------------------------------------------------
r1490 | mdorr | 2018-12-06 12:40:01 -0800 (Thu, 06 Dec 2018) | 3 lines

Adding my test script that tests both the 4D and 5D builds


------------------------------------------------------------------------
r1489 | debo | 2018-12-06 11:32:08 -0800 (Thu, 06 Dec 2018) | 1 line

Fixed the gyroavg op; the code compiles in 5D again
------------------------------------------------------------------------
r1488 | debo | 2018-12-05 17:09:31 -0800 (Wed, 05 Dec 2018) | 1 line

Added the option for species to be either drift-kinetic or gyrokinetic (kinetic_species.1.is_gyrokinetic = true/false[default]); gyroaverage operator is defined and allocated only for gyrokinetic species
------------------------------------------------------------------------
r1487 | mdorr | 2018-12-05 16:27:33 -0800 (Wed, 05 Dec 2018) | 3 lines

Removing some residual debugging code.


------------------------------------------------------------------------
r1486 | debo | 2018-12-04 17:16:20 -0800 (Tue, 04 Dec 2018) | 1 line

Implemented a basic gyroaveraging operator for 4D (2D)
------------------------------------------------------------------------
r1485 | mdorr | 2018-12-03 17:05:24 -0800 (Mon, 03 Dec 2018) | 3 lines

Fixing a mistake introduced in r1483 that could possibly affect results even if step_const_coef is false.


------------------------------------------------------------------------
r1484 | mdorf | 2018-12-03 15:29:54 -0800 (Mon, 03 Dec 2018) | 1 line

Updated ToroidalBlockRemapping function by adding higher-order methods, and fixing a bug in the old low-order approach (not used by default). 2. Fixed bugs in toroidal magnetic geometry. 3. Minor updates in geometry classes (e.g.,. added the second-order option for magnetic geometry). 4. Fixed a minor bug in the initialization of m_initial_zero (in GKPoissonBoltzmann). 5. Added canonical Maxwellian option for a 5D initial distribution function.
------------------------------------------------------------------------
r1483 | mdorr | 2018-12-02 08:25:53 -0800 (Sun, 02 Dec 2018) | 3 lines

Adding step_const_coef input flag (defaulted false) for use in specifying that operator coefficients varying on the transport time scale will be treated as constant over a time step.  This improves performance by reducing the number of coefficient evaluations performed in multiple RK stages, which typically involve costly moment and other calculations.  This option should only be used with awareness of its possible effect on temporal accuracy.


------------------------------------------------------------------------
r1482 | mdorr | 2018-11-28 09:04:20 -0800 (Wed, 28 Nov 2018) | 5 lines

Creating GKOps::preSolutionOpEval() to contain the operations in GKOps::preOpEval() specific to the solution operator (mass matrix).

Also adding a few more timers.


------------------------------------------------------------------------
r1481 | mdorr | 2018-11-21 13:26:28 -0800 (Wed, 21 Nov 2018) | 3 lines

Restoring preOpEval call only if a_its==0.


------------------------------------------------------------------------
r1480 | mdorr | 2018-11-20 15:40:08 -0800 (Tue, 20 Nov 2018) | 3 lines

Splitting off the calculation of the part of divJperp due to magnetic drifts so that it can be precalculated in preOpEval.


------------------------------------------------------------------------
r1479 | mdorr | 2018-11-15 14:19:06 -0800 (Thu, 15 Nov 2018) | 3 lines

Fixing BC name in fluiddiffusion_sn_impl.in and getting rid of some unresolved svn merge debris in fluid_diffusion.in.


------------------------------------------------------------------------
r1478 | mdorr | 2018-11-15 14:16:48 -0800 (Thu, 15 Nov 2018) | 3 lines

Fixing destructor bugs in MBSolver, GKPoisson and ToroidalBlockLevelExchangeCenter, plus some other minor cleanup.


------------------------------------------------------------------------
r1477 | mdorf | 2018-11-14 13:26:44 -0800 (Wed, 14 Nov 2018) | 1 line

Updated the checkpoint file to be consistent with the repo code
------------------------------------------------------------------------
r1476 | mdorf | 2018-11-14 11:43:57 -0800 (Wed, 14 Nov 2018) | 1 line

Fixed bugs in toroidal geometry implementation. Added pointwise metrics option. Utilized cashed metrics in various MagGeom functions
------------------------------------------------------------------------
r1475 | mdorr | 2018-11-08 15:32:58 -0800 (Thu, 08 Nov 2018) | 3 lines

Fixing the old vorticity model restart.  Moved coefficient setting in VorticityOp to the preOpEval() member for efficiency.


------------------------------------------------------------------------
r1474 | mdorr | 2018-11-06 14:13:29 -0800 (Tue, 06 Nov 2018) | 3 lines

Adding the new ToroidalBlockLevelExchangeCenter object to the m_precond_Qsolver call for the sheared geometry case.


------------------------------------------------------------------------
r1473 | mdorr | 2018-11-04 12:24:24 -0800 (Sun, 04 Nov 2018) | 3 lines

Adding a few #if CFG_DIM==3 statements to fix the 4D build.


------------------------------------------------------------------------
r1472 | mdorf | 2018-11-01 15:15:23 -0700 (Thu, 01 Nov 2018) | 1 line

Initial commit of the locally field-aligned multiblock toroidal geometry
------------------------------------------------------------------------
r1471 | mdorr | 2018-11-01 10:37:53 -0700 (Thu, 01 Nov 2018) | 3 lines

Adding a preliminary toroidal block level exchange to support 3D multiblock solves in sheared toroidal geometry.


------------------------------------------------------------------------
r1470 | mdorr | 2018-10-30 11:08:04 -0700 (Tue, 30 Oct 2018) | 3 lines

Removing unused scripts.


------------------------------------------------------------------------
r1469 | mdorr | 2018-10-30 10:59:42 -0700 (Tue, 30 Oct 2018) | 3 lines

Fixing some memory leaks, primarily by replacing some bare points with RefCountedPtrs, adding some RefCountedPtrs as data members to a few classes, enabling the removal of several RefCountedPtr.neverDelete() calls.  Also added a Destroy call to remove previously constructed Hypre matrices before making a new one.


------------------------------------------------------------------------
r1468 | mdorr | 2018-10-24 17:18:36 -0700 (Wed, 24 Oct 2018) | 3 lines

Adding some virtual base class destructors to stop some compiler warnings.  Also removing some unused variables.


------------------------------------------------------------------------
r1467 | mdorr | 2018-10-21 18:42:33 -0700 (Sun, 21 Oct 2018) | 7 lines

Updating VorticityOp to improve the efficiency of the div_J_perp calculation by precomputing the part due solely to magnetic drifts in the constructor.  The part due to ExB drifts is now computed from the ion density rather than the previous expensive moment calculation.

A preOpEval member has also been added to the fluid operators to enable the precalculation of expensive stuff (like moments) before the evaluation of operators.

A couple more GK velocity options have been added.


------------------------------------------------------------------------
r1461 | mdorr | 2018-10-13 16:02:59 -0700 (Sat, 13 Oct 2018) | 3 lines

Adding macros to define the velocity options (previously hardwired to 0,1,2) and added a couple more.


------------------------------------------------------------------------
r1460 | mdorr | 2018-10-13 16:01:05 -0700 (Sat, 13 Oct 2018) | 2 lines

Adding the time_implicit=false flag to DIII-D_vorticity_rerun.in and cleaning up.

------------------------------------------------------------------------
r1458 | mdorr | 2018-10-13 11:43:13 -0700 (Sat, 13 Oct 2018) | 3 lines

Removing ancient move-script stuff.


------------------------------------------------------------------------
r1456 | mdorf | 2018-10-11 13:59:31 -0700 (Thu, 11 Oct 2018) | 1 line

Small revision to subSpaceSolve: average part of phi_tilde is subtracted after the linear solve
------------------------------------------------------------------------
r1455 | mdorr | 2018-10-11 11:20:07 -0700 (Thu, 11 Oct 2018) | 3 lines

Generalizing to 3D.


------------------------------------------------------------------------
r1454 | debo | 2018-10-10 18:41:57 -0700 (Wed, 10 Oct 2018) | 1 line

Modified the multiphysics preconditioner so that it should work for overlapping implicit operators
------------------------------------------------------------------------
r1453 | mdorr | 2018-10-09 12:49:33 -0700 (Tue, 09 Oct 2018) | 3 lines

Fixing a bad cast.


------------------------------------------------------------------------
r1452 | ilonster | 2018-10-08 16:10:46 -0700 (Mon, 08 Oct 2018) | 1 line

Fixed bug: FixedBckgr now uses ionization_norm when chx turned off
------------------------------------------------------------------------
r1449 | ilonster | 2018-10-08 15:53:33 -0700 (Mon, 08 Oct 2018) | 1 line

Added new PerpGyroPoisson and RadialGyroPoisson models; Allow user to specify model using input file
------------------------------------------------------------------------
r1448 | ilonster | 2018-10-08 15:52:47 -0700 (Mon, 08 Oct 2018) | 1 line

Changed FixedBckgr so that it works for multiple species
------------------------------------------------------------------------
r1445 | mdorr | 2018-10-04 18:31:27 -0700 (Thu, 04 Oct 2018) | 3 lines

Updating the sample inputs to be consistent with r1444.


------------------------------------------------------------------------
r1444 | mdorr | 2018-10-04 18:30:22 -0700 (Thu, 04 Oct 2018) | 3 lines

Improving support for multiple variables in fluid species: inclusion in GKState (including restart), initial conditions, boundary conditions, plotting


------------------------------------------------------------------------
r1443 | mdorr | 2018-10-04 17:35:42 -0700 (Thu, 04 Oct 2018) | 3 lines

Replacing the OMFIT module documentation with a new one.


------------------------------------------------------------------------
r1442 | mdorr | 2018-10-03 13:44:27 -0700 (Wed, 03 Oct 2018) | 3 lines

Generalizing the number of processors calculation.


------------------------------------------------------------------------
r1441 | mdorf | 2018-10-02 18:31:57 -0700 (Tue, 02 Oct 2018) | 1 line

Added a linear option for Boltzmann electrons (with the corresponding subSpace solve method); cosmetic refactoring of EllipticOp::computeFluxDivergence() function
------------------------------------------------------------------------
r1440 | mdorr | 2018-09-28 17:42:45 -0700 (Fri, 28 Sep 2018) | 3 lines

Adding the OMFIT module sample files and documentation.


------------------------------------------------------------------------
r1439 | debo | 2018-09-28 11:26:39 -0700 (Fri, 28 Sep 2018) | 1 line

added a general configuration script for hypre (not machine-specific)
------------------------------------------------------------------------
r1438 | debo | 2018-09-28 11:20:33 -0700 (Fri, 28 Sep 2018) | 1 line

updated hypre's doinstall script to use all available cores
------------------------------------------------------------------------
r1437 | debo | 2018-09-26 11:32:23 -0700 (Wed, 26 Sep 2018) | 1 line

Major: added a block multiphysics preconditioner that allows multiple implicit terms to define their own preconditioners; Minor: changed solutionOp for fluids to include computational species such that the default copying works when solutionOp is identity, changed collisionOp and fluidOp interfaces such that specifying whether any of them are implicit happens in their own object rather than GKOps
------------------------------------------------------------------------
r1436 | mdorf | 2018-09-25 18:15:53 -0700 (Tue, 25 Sep 2018) | 1 line

Extended flux_surface_average operator to support 3D code
------------------------------------------------------------------------
r1435 | mdorf | 2018-09-24 17:07:22 -0700 (Mon, 24 Sep 2018) | 1 line

Decreased default tolerance in MBA calculation to allow for smaller values in input profiles
------------------------------------------------------------------------
r1434 | mdorf | 2018-09-23 19:01:48 -0700 (Sun, 23 Sep 2018) | 1 line

Updated explicit slab-diffusion input and added implicit signle-null diffusion input
------------------------------------------------------------------------
r1433 | mdorf | 2018-09-23 13:49:30 -0700 (Sun, 23 Sep 2018) | 1 line

Updated Diffusion and OneField models
------------------------------------------------------------------------
r1432 | mdorr | 2018-09-20 13:42:51 -0700 (Thu, 20 Sep 2018) | 3 lines

Renaming FieldSolver and PotentialBC to EllipticOp and EllipticOpBC, respectively, to better describe their now and future generalized usage for things other than computing potentials.  The *PotentialBC class have also been correspondingly renamed.


------------------------------------------------------------------------
r1431 | mdorr | 2018-09-19 18:29:39 -0700 (Wed, 19 Sep 2018) | 3 lines

Fixing J factors in the fluid diffusion operator.


------------------------------------------------------------------------
r1430 | mdorr | 2018-09-19 14:30:22 -0700 (Wed, 19 Sep 2018) | 3 lines

Fixing bug in diffusion solver mapped coefficients.


------------------------------------------------------------------------
r1429 | mdorr | 2018-09-15 14:23:38 -0700 (Sat, 15 Sep 2018) | 3 lines

Removing Fortran headers


------------------------------------------------------------------------
r1428 | mdorr | 2018-09-13 17:28:47 -0700 (Thu, 13 Sep 2018) | 3 lines

Adding the Diffusion operator files I forgot in the previous commit.


------------------------------------------------------------------------
r1427 | mdorr | 2018-09-13 17:14:39 -0700 (Thu, 13 Sep 2018) | 3 lines

Adding a diffusion solver for use as a preconditioner for OneFieldOp.


------------------------------------------------------------------------
r1426 | debo | 2018-09-10 18:18:45 -0700 (Mon, 10 Sep 2018) | 1 line

modified functions in GKOps to allow a unified way of calling terms from both explicitOp and im/explicitOpImEx
------------------------------------------------------------------------
r1425 | debo | 2018-09-10 14:26:38 -0700 (Mon, 10 Sep 2018) | 1 line

1) do not call GKOps::SolutionOp() or GKOps::SolutionPC() if GKOps::trivialSolutionOp() is true; 2) the default evalSolutionOp() in fluid interface seems to be incorrect, so added a MayDay::Error() for now till this is resolved.
------------------------------------------------------------------------
r1424 | mdorr | 2018-09-04 16:45:17 -0700 (Tue, 04 Sep 2018) | 7 lines

Adding the IMEX collision test to the sample inputs

-This line, and those below, will be ignored--

A    sample_inputs/imex_collisions
A    sample_inputs/imex_collisions/imex_collisions.in

------------------------------------------------------------------------
r1423 | mdorr | 2018-09-04 16:17:01 -0700 (Tue, 04 Sep 2018) | 3 lines

Updating the IMEX vorticity sample inputs to be consistent with Debo's recent changes.


------------------------------------------------------------------------
r1422 | debo | 2018-08-31 16:29:25 -0700 (Fri, 31 Aug 2018) | 1 line

Reworking of the preconditioning interface - this sets the stage for implementing a multiphysics preconditioner when multiple terms are being treated implicitly and need to be preconditioned separately.
------------------------------------------------------------------------
r1421 | debo | 2018-08-30 17:07:42 -0700 (Thu, 30 Aug 2018) | 1 line

Cleanup of the time integrators: 1) Removed DIRKs because of too much code repetition; will add them back in a more elegant way if necessary, 2) removed redundant functions in GKOps, 3) PETSc interface will not work anymore (not that anyone was using it), may have it working again later after we figure out the multi-physics preconditioner implementation
------------------------------------------------------------------------
r1420 | mdorr | 2018-08-16 16:28:45 -0700 (Thu, 16 Aug 2018) | 3 lines

Updating makefile for r1417 changes


------------------------------------------------------------------------
r1419 | mdorr | 2018-08-16 15:48:50 -0700 (Thu, 16 Aug 2018) | 3 lines

Adding fluid diffusion input file.


------------------------------------------------------------------------
r1418 | mdorr | 2018-08-16 15:39:29 -0700 (Thu, 16 Aug 2018) | 3 lines

Updating the sample inputs to be consistent with the just committed refactored code.   The problems originally named DIII-D_vorticity and DIII-D_vorticity_rerun were renamed DIII-D_old_vorticity and DIII-D_old_vorticity_rerun, respectively.  These still use the old vorticity option.  New directories DIII-D_vorticity and DIII-D_vorticity_rerun have been added; these use the new IMEX-based method.


------------------------------------------------------------------------
r1417 | mdorr | 2018-08-16 15:36:54 -0700 (Thu, 16 Aug 2018) | 26 lines

Significant refactoring to incorporate previous ad hoc time integration options (self-consistent BC, ampere, electron vorticity) into the IMEX framework
.  Major highlights, in no particular order:

- Added a scalarOp directory to contain time integration operators for scalar data.  We needed this for the self-consistent BC option, which involves the integration of two scalars representing the radial electric field component averaged over the inner and outer core boundaries.  Also added species/scalar directory to contain a scalar (vector) data type.

- Consolidated configuration space data (in the species/fluid directory), removing the distinction between "fluid" and "field" data.  Initial and boundary data for configuration space state variables are now set from GridFunctions rather than FluidFunctions (which have now been removed).  All configuration space data is now derived from a new CFGVar base class.  This includes the FluidSpecies class (implementing a fluid model of a plasma species as before) as well as the electric field (various flavors, see next).

- Added geometry-specific BC classes (LogRectConfigurationBC, SingleNullConfigurationBC, SNCoreConfigurationBC) for setting boundary conditions on fluid variables.

- Added fluidOp/VorticityOp encapsulating in the IMEX framework the electron vorticity operations and data, which have now been removed from GKOps.  There are still some performance improvements to be made, so I have left the old vorticity option in the code, although now called from GKOps::postTimeStep() rather than the last RK stage.  To enable it, include \223gksystem.old_vorticity_model = true\224 in the input.

- Removed the fieldOp directory.

- The electric field is now a class that attempts to encapsulate everything related to its construction and use.  There are currently three classes: EField, the generic base class, EFieldSelfConsistentBC, the electric field for the self-consistentBC option, and EFieldAmpere, the electric field for the a\
mpere option.  This enabled nearly all of the field-related data (e.g., the potential and field perturbations for the ampere option) to be removed from GKOps.  The field solver (formerly pointed to by m_poisson in GKOps) is now contained the EField object(s).

- GKVlasov was slightly refactored to better isolate (and hide if not needed) the stuff related to the self-consistent BC and ampere options.  GKVlasov is now a base class, from which GKVlasovAmpere is derived implementing the ampere (and self-consistentBC) options.  Each class still contains the "old" and "new" velocity options, but due to the EField refactoring, the argument lists are now much cleaner.

- The banded preconditioner used for the implicit collision ARK option is now distinct from the block preconditioner used, e.g., for the implicit vorticity option.  We still need to integrate these.  For now, the banded solver results from including \223ark_pc.type = "gauss_seidel" (or jacobi, etc.) in the input.  Otherwise the block preconditioner is assumed.  Unfortunately, this means that we cannot, say, use implicit collisions with the vorticity option.

- The GKPoisson interface was slightly modified to enable boundary values to be set without recomputing the operator coefficients.





------------------------------------------------------------------------
r1416 | dmartin | 2018-08-07 12:20:17 -0700 (Tue, 07 Aug 2018) | 3 lines

adding inputs file with a reduced velocity space resolution for debugging


------------------------------------------------------------------------
r1415 | mdorr | 2018-07-28 12:23:13 -0700 (Sat, 28 Jul 2018) | 5 lines

Adding an option to set the environment variable COGENT_TEST_DIM specifying the dimension to be used for the COGENT build.  If this variable is not set, the value specifed as MAXDIM in the COGENT GNUmakefile will be used.

Also getting rid of the dotkit stuff used by the now departed LC Cab machine in favor of the LMOD analog now being used at LC.


------------------------------------------------------------------------
r1414 | mdorr | 2018-07-24 11:23:15 -0700 (Tue, 24 Jul 2018) | 4 lines

Adding null pointer checks to skip over interior boxes, since they never contribute
unstructured matrix couplings.


------------------------------------------------------------------------
r1413 | mdorf | 2018-07-19 17:29:14 -0700 (Thu, 19 Jul 2018) | 1 line

Added a new grid function, which provides interpolation from 1D scattered data
------------------------------------------------------------------------
r1409 | mdorf | 2018-06-20 14:15:29 -0700 (Wed, 20 Jun 2018) | 1 line

1. Extended subgid method for calculation of geometry data to 3D. 2.Miscellaneous clean ups. 
------------------------------------------------------------------------
r1405 | mdorf | 2018-05-31 15:07:00 -0700 (Thu, 31 May 2018) | 1 line

Updated 5D test cases
------------------------------------------------------------------------
r1403 | mdorf | 2018-05-31 09:53:23 -0700 (Thu, 31 May 2018) | 1 line

Reverted averaging at block boundaires for the case of extraBlockExchange = true back to r1398.
------------------------------------------------------------------------
r1401 | ilonster | 2018-05-30 19:43:09 -0700 (Wed, 30 May 2018) | 1 line

moved new adiabatic electron option to SimpleBoltzmann function; added simple_boltzmann and simple_linear input options
------------------------------------------------------------------------
r1400 | ilonster | 2018-05-30 13:55:16 -0700 (Wed, 30 May 2018) | 1 line

Added adiabatic electron model and fixed neutral background distribution function
------------------------------------------------------------------------
r1399 | mdorf | 2018-05-30 10:03:52 -0700 (Wed, 30 May 2018) | 1 line

Fixed a few bugs in the code that supports shearedMBgeom including, pitch-shear calculations, adding a code to support exchange in corner ghosts, and removing physical boundaries from the toroidal direction
------------------------------------------------------------------------
r1398 | mdorf | 2018-05-17 21:40:17 -0700 (Thu, 17 May 2018) | 1 line

Temporarily removed division by J in fluid species to be consistent with the current fluid formulation; this should soon be all changed in the upcoming revision, which will combine field and fluid quantities
------------------------------------------------------------------------
r1397 | mdorf | 2018-05-16 18:22:53 -0700 (Wed, 16 May 2018) | 1 line

Made plotFaceData and plotEfied functions compatible with 3D
------------------------------------------------------------------------
r1396 | debo | 2018-05-16 11:34:56 -0700 (Wed, 16 May 2018) | 1 line

Fixed uninitialized m_isLinear in Newton solver; removed the setting of isLinear to true for M(ydot) = r by default in time integration methods
------------------------------------------------------------------------
r1395 | mdorf | 2018-05-15 16:58:54 -0700 (Tue, 15 May 2018) | 1 line

Added the fixed_ghosts BC option and updated the DIII-D vorticty inputs
------------------------------------------------------------------------
r1394 | mdorf | 2018-05-15 14:48:13 -0700 (Tue, 15 May 2018) | 1 line

Restored native fillInternatlGhosts in the FieldSolver class
------------------------------------------------------------------------
r1393 | mdorf | 2018-05-14 12:05:37 -0700 (Mon, 14 May 2018) | 1 line

Added code to support sheared geometry simulations. Currently implemented only for a sheared-slab geometry
------------------------------------------------------------------------
r1392 | mdorf | 2018-05-12 12:27:34 -0700 (Sat, 12 May 2018) | 1 line

reverted r1390 revisions in exec and sample inputs folders
------------------------------------------------------------------------
r1391 | mdorf | 2018-05-12 12:25:13 -0700 (Sat, 12 May 2018) | 1 line

reverted r1390 changes
------------------------------------------------------------------------
r1390 | yaz148 | 2018-05-10 11:34:26 -0700 (Thu, 10 May 2018) | 1 line

https://anag-repo.lbl.gov/svn/COGENT/branches/unlike_species_collisions/
------------------------------------------------------------------------
r1389 | mdorf | 2018-05-10 11:24:16 -0700 (Thu, 10 May 2018) | 1 line

Improved one-field fluid model and added support of non-periodic BCs for fluid species
------------------------------------------------------------------------
r1387 | angus1 | 2018-04-25 16:31:23 -0700 (Wed, 25 Apr 2018) | 1 line

added number of ghost cells to output structure
------------------------------------------------------------------------
r1386 | angus1 | 2018-04-25 11:01:32 -0700 (Wed, 25 Apr 2018) | 1 line

updated 2D matlab readers for multi-component, non-species data
------------------------------------------------------------------------
r1385 | angus1 | 2018-04-23 15:11:29 -0700 (Mon, 23 Apr 2018) | 1 line

added matlab hdf5 postprocessing
------------------------------------------------------------------------
r1384 | mdorf | 2018-04-13 14:19:15 -0700 (Fri, 13 Apr 2018) | 1 line

Added Justin's fix for spatially-depended fluid transport coefficients
------------------------------------------------------------------------
r1383 | debo | 2018-04-12 15:43:45 -0700 (Thu, 12 Apr 2018) | 1 line

Implemented the time integrators for the ODE d[M(u)]/dt = F(u), where M(u) may be a nonlinear function; for M(u) = u, they fall back to the old implementation
------------------------------------------------------------------------
r1382 | umansky | 2018-03-28 18:31:40 -0700 (Wed, 28 Mar 2018) | 3 lines

Adding initial IDL post-processing tools.


------------------------------------------------------------------------
r1381 | mdorf | 2018-03-26 23:08:34 -0700 (Mon, 26 Mar 2018) | 1 line

Added a simple OneField fluid model
------------------------------------------------------------------------
r1380 | mdorf | 2018-03-23 11:49:22 -0700 (Fri, 23 Mar 2018) | 1 line

Updated baseline inputs to be consistent with r1379
------------------------------------------------------------------------
r1379 | mdorf | 2018-03-23 11:45:22 -0700 (Fri, 23 Mar 2018) | 1 line

1. Extended LogRectCoordSys to support multiblock geometry structures; 2. Did some 3D/5D cleaning.
------------------------------------------------------------------------
r1378 | mdorf | 2018-03-15 15:01:09 -0700 (Thu, 15 Mar 2018) | 1 line

Added an input file for a 5D test case
------------------------------------------------------------------------
r1377 | mdorf | 2018-03-15 14:58:01 -0700 (Thu, 15 Mar 2018) | 1 line

1. Cleaned-up coding for 2D/3D GKSystem::getConfigurationSpaceDisjointBoxLayout. 2. Added a MayDay::Error statement for time step diagnostic calculations
------------------------------------------------------------------------
r1376 | mdorf | 2018-03-09 11:48:50 -0800 (Fri, 09 Mar 2018) | 1 line

cleaned up DIII-D_vorticity input
------------------------------------------------------------------------
r1375 | mdorf | 2018-03-08 16:50:55 -0800 (Thu, 08 Mar 2018) | 1 line

cleaned-up unnecessary print statments
------------------------------------------------------------------------
r1374 | mdorr | 2018-02-20 08:56:18 -0800 (Tue, 20 Feb 2018) | 3 lines

Adding the accumulation over species of the radial flux divergence average in the Ampere option.


------------------------------------------------------------------------
r1373 | mdorr | 2018-02-08 20:48:43 -0800 (Thu, 08 Feb 2018) | 3 lines

Adding omitted copy of m_divfree_velocity to species-specific constructor.


------------------------------------------------------------------------
r1372 | mdorr | 2018-02-08 17:11:22 -0800 (Thu, 08 Feb 2018) | 3 lines

Restoring the somehow accidentally deleted subdirectories of the old flux-aligned grid generator, which constructs mappings from an analytic model geometry.  This was used to generate the mapping files in our GKVlasov paper, but will probably be removed in the future.


------------------------------------------------------------------------
r1371 | mdorf | 2018-02-08 15:00:22 -0800 (Thu, 08 Feb 2018) | 1 line

Improved instructions in the grid generator README file
------------------------------------------------------------------------
r1370 | mdorr | 2018-02-08 09:42:11 -0800 (Thu, 08 Feb 2018) | 5 lines

Fixing call to GKSystem::postTimeStep from Simulation to pass the current time instead of the time step.

Moving the stage-dependent stuff from the GKOps operator evaluations to postTimeStep().


------------------------------------------------------------------------
r1369 | mdorr | 2018-02-07 10:02:03 -0800 (Wed, 07 Feb 2018) | 3 lines

Fixing tolerance printing in batch test script


------------------------------------------------------------------------
r1368 | mdorf | 2018-01-30 13:01:49 -0800 (Tue, 30 Jan 2018) | 1 line

(1) Added zero-Neumann BC. (2) Included vorticity calculation into explicitOpImEx
------------------------------------------------------------------------
r1367 | schwartz | 2018-01-29 17:04:09 -0800 (Mon, 29 Jan 2018) | 2 lines

Modified the code to read in the first two (whole number) entries of noisyDataIn separately and interpret them as the dimensions of data.

------------------------------------------------------------------------
r1366 | debo | 2018-01-29 13:42:55 -0800 (Mon, 29 Jan 2018) | 1 line

Changed the defaults so that ARK runs with sensible solver tolerances and preconditioner
------------------------------------------------------------------------
r1365 | mdorr | 2018-01-28 08:25:51 -0800 (Sun, 28 Jan 2018) | 3 lines

Merging the 5D branch


------------------------------------------------------------------------
r1363 | mdorr | 2018-01-26 18:16:48 -0800 (Fri, 26 Jan 2018) | 5 lines

Syncing with the trunk in preparation for reintegration with it.

Slab geometry input changed (By and Bz swapped).


------------------------------------------------------------------------
r1362 | mdorr | 2018-01-24 09:46:12 -0800 (Wed, 24 Jan 2018) | 3 lines

Removing the deletion of chk* files since they're needed for restart tests (same issue as the run_tests modification made yesterday)


------------------------------------------------------------------------
r1361 | mdorr | 2018-01-23 15:16:34 -0800 (Tue, 23 Jan 2018) | 5 lines

Adding sample input problems to the smoke tests.

Removing the deletion of chk* files prior to tests since it breaks restart tests.


------------------------------------------------------------------------
r1360 | schwartz | 2018-01-18 16:17:27 -0800 (Thu, 18 Jan 2018) | 2 lines

C++ code which reproduces figure 2 (in a simpler case) of smoothndemo.m 

------------------------------------------------------------------------
r1359 | mdorr | 2018-01-17 10:53:22 -0800 (Wed, 17 Jan 2018) | 3 lines

Fixing 3D mapped coefficient calculation.


------------------------------------------------------------------------
r1358 | mdorf | 2018-01-12 16:43:40 -0800 (Fri, 12 Jan 2018) | 1 line

Upgraded some geometry functions to be 5D compatible
------------------------------------------------------------------------
r1357 | mdorr | 2018-01-10 12:31:04 -0800 (Wed, 10 Jan 2018) | 3 lines

Fixing momentum plotting switch (was mistakenly m_hdf_density; now m_hdf_momentum).


------------------------------------------------------------------------
r1356 | mdorr | 2018-01-10 11:09:21 -0800 (Wed, 10 Jan 2018) | 3 lines

Fixing a few 2D references with the 3D option.


------------------------------------------------------------------------
r1355 | debo | 2018-01-09 17:45:23 -0800 (Tue, 09 Jan 2018) | 1 line

Updating the Fokker-Planck related code to be compatible with 5D
------------------------------------------------------------------------
r1354 | mdorf | 2018-01-08 16:13:48 -0800 (Mon, 08 Jan 2018) | 1 line

Made TransportF.ChF and NeutralsF.ChF compatible with 5D
------------------------------------------------------------------------
r1353 | mdorf | 2018-01-08 12:33:09 -0800 (Mon, 08 Jan 2018) | 1 line

Added momentum diagnostics
------------------------------------------------------------------------
r1351 | mdorr | 2018-01-02 10:39:11 -0800 (Tue, 02 Jan 2018) | 3 lines

Adding -rpath to the HDF5 flags


------------------------------------------------------------------------
r1350 | mdorf | 2017-12-28 09:52:36 -0800 (Thu, 28 Dec 2017) | 1 line

1. Added a second-order Dirichlet BC (value enforced at a boundary). 2. Suppressed an obsolete warning message
------------------------------------------------------------------------
r1349 | mdorf | 2017-12-27 11:36:34 -0800 (Wed, 27 Dec 2017) | 1 line

Added a model-friction option for the charge-exchange operator. Fixed calculation of dt at the first step
------------------------------------------------------------------------
r1348 | mdorf | 2017-12-22 15:44:29 -0800 (Fri, 22 Dec 2017) | 1 line

Added a fixed background model for neutrals
------------------------------------------------------------------------
r1347 | mdorr | 2017-12-21 18:55:07 -0800 (Thu, 21 Dec 2017) | 5 lines

Updating the test scripts to use environment variables.

Adding a new script to create a baseline directory from a collection of problems in another directory (e.g. COGENT/sample_inputs).


------------------------------------------------------------------------
r1346 | mdorr | 2017-12-20 10:05:57 -0800 (Wed, 20 Dec 2017) | 3 lines

Removing (the otherwise duplicated) template definitions that Terry has now added to Chombo in r23229


------------------------------------------------------------------------
r1345 | mdorr | 2017-12-19 17:59:51 -0800 (Tue, 19 Dec 2017) | 5 lines

Modifications to enable the removal of the STENCIL_UE switch in MBSolver.  

Fixing seg fault in MagGeom with the extrablock_ghosts option.


------------------------------------------------------------------------
r1344 | mdorf | 2017-12-19 16:39:14 -0800 (Tue, 19 Dec 2017) | 1 line

Added a suit of test problems
------------------------------------------------------------------------
r1343 | mdorf | 2017-12-18 15:32:35 -0800 (Mon, 18 Dec 2017) | 1 line

Added input files for DIII-D transport simulations
------------------------------------------------------------------------
r1342 | mdorf | 2017-12-18 15:16:22 -0800 (Mon, 18 Dec 2017) | 1 line

Added spatial dependence to the electron temperature in the vorticity model; Cleaned up a cooment in updateVelocityNormals
------------------------------------------------------------------------
r1341 | mdorr | 2017-12-14 18:18:29 -0800 (Thu, 14 Dec 2017) | 3 lines

Fixing some typos.


------------------------------------------------------------------------
r1340 | mdorr | 2017-12-14 17:54:03 -0800 (Thu, 14 Dec 2017) | 3 lines

Updating the test scripts and adding a README file describing their use


------------------------------------------------------------------------
r1339 | mdorf | 2017-12-13 17:10:57 -0800 (Wed, 13 Dec 2017) | 1 line

Updated README and did some cleaning inside the grid_generator folder
------------------------------------------------------------------------
r1338 | umansky | 2017-12-13 16:08:46 -0800 (Wed, 13 Dec 2017) | 3 lines

Adding scripts for running UEDGE.


------------------------------------------------------------------------
r1337 | mdorr | 2017-12-13 14:38:49 -0800 (Wed, 13 Dec 2017) | 3 lines

Adding modifications to support eight-block geometries


------------------------------------------------------------------------
r1336 | angus1 | 2017-12-13 14:37:14 -0800 (Wed, 13 Dec 2017) | 1 line

fixed ghostVect issue that prevented running with DEBUG
------------------------------------------------------------------------
r1335 | umansky | 2017-12-13 14:35:28 -0800 (Wed, 13 Dec 2017) | 3 lines

Misc. edits.


------------------------------------------------------------------------
r1334 | mdorf | 2017-12-13 14:16:55 -0800 (Wed, 13 Dec 2017) | 1 line

Restored compatibility with the old version for the case of a flux-aligned grid.
------------------------------------------------------------------------
r1333 | umansky | 2017-12-11 16:58:04 -0800 (Mon, 11 Dec 2017) | 4 lines

Adding utilities (mostly in IDL) for exporting COGENT grid data as a
UEDGE gridue file.


------------------------------------------------------------------------
r1332 | angus1 | 2017-12-11 14:29:14 -0800 (Mon, 11 Dec 2017) | 1 line

updating ConsDragDiff collision model
------------------------------------------------------------------------
r1331 | angus1 | 2017-12-11 14:27:44 -0800 (Mon, 11 Dec 2017) | 1 line

updating transport model
------------------------------------------------------------------------
r1330 | mdorf | 2017-12-11 12:00:00 -0800 (Mon, 11 Dec 2017) | 1 line

1. Added separate output needed for gridUE generation. 2. Miscellaneous cleanups
------------------------------------------------------------------------
r1329 | mdorf | 2017-12-10 17:32:48 -0800 (Sun, 10 Dec 2017) | 1 line

Restored compatibility with grid generator in r1322; added some plotting improvements
------------------------------------------------------------------------
r1328 | mdorr | 2017-12-10 10:03:00 -0800 (Sun, 10 Dec 2017) | 3 lines

Prepending ./ to the executable names in case the current working directory is not in the PATH


------------------------------------------------------------------------
r1327 | mdorr | 2017-12-07 16:00:04 -0800 (Thu, 07 Dec 2017) | 3 lines

Restoring the MatLab scripts.


------------------------------------------------------------------------
r1326 | mdorr | 2017-12-07 15:57:10 -0800 (Thu, 07 Dec 2017) | 3 lines

Adding a grid generation scripts directory.  Updating the runPy.py script.  Adding an interactive version for plotting to the screen.  Adding a directory containing the old flux aligned grid generator that is currently set up to use the analytic flux for the example in our recent paper.


------------------------------------------------------------------------
r1325 | mdorr | 2017-12-06 14:40:12 -0800 (Wed, 06 Dec 2017) | 3 lines

Adding a (Matlab-free) utility to extrapolate smooth ghost cells


------------------------------------------------------------------------
r1324 | mdorr | 2017-12-06 14:39:01 -0800 (Wed, 06 Dec 2017) | 9 lines

Reorganizing the grid generation directories as follows:

New directory: "grid_generation"  -  Contains everything related to grid generation

Previous "grid_generator" directory containing Peter's Brackbill-Saltzman grid generator is now in grid_generation/bs_grid_generator

Previous "grid_generator_flux_aligned" directory containing Mikhail's grid generator (which now generates either flux aligned or dealigned grids) is now in grid_generation/grid_generator


------------------------------------------------------------------------
r1323 | debo | 2017-12-04 16:06:49 -0800 (Mon, 04 Dec 2017) | 1 line

GKPoisson: added checking for m_gkp_verbose for some output statements
------------------------------------------------------------------------
r1322 | mdorf | 2017-12-01 17:40:10 -0800 (Fri, 01 Dec 2017) | 1 line

Added RBr and RBz data to COGENT_mapping (will be used to create gridUE file)
------------------------------------------------------------------------
r1321 | mdorf | 2017-12-01 16:06:56 -0800 (Fri, 01 Dec 2017) | 1 line

Added a python driver to the grid generator. The driver runs the C++ code and generates plots.
------------------------------------------------------------------------
r1320 | mdorf | 2017-11-16 10:56:05 -0800 (Thu, 16 Nov 2017) | 1 line

Cleaned up some comments for the use of a field-aligned SN geometry
------------------------------------------------------------------------
r1319 | mdorf | 2017-11-16 10:18:27 -0800 (Thu, 16 Nov 2017) | 1 line

Added species-dependent velocity coordinate systems
------------------------------------------------------------------------
r1318 | mdorr | 2017-11-15 22:10:26 -0800 (Wed, 15 Nov 2017) | 4 lines

Adding a 1/R factor to the metric factors corresponding to transverse directions in the axisymmetric case.  The 1/R factor is already in the normal components to enable free-stream preservation with axisymmetry.  The metrics in the transverse directions are not needed for mapped grid divergence calculations, but it seems safer to include the 1/R factor in those components too for consistency. 



------------------------------------------------------------------------
r1317 | mdorf | 2017-11-10 18:25:03 -0800 (Fri, 10 Nov 2017) | 1 line

Added additional call to exchangeExtraBlockGhosts (inside PhaseGeom::fillInternalGhosts) to fill corner ghost cells
------------------------------------------------------------------------
r1316 | mdorf | 2017-11-10 14:26:11 -0800 (Fri, 10 Nov 2017) | 1 line

Separated fieldAligned option from the check on applyAxisymmetricCorrection()
------------------------------------------------------------------------
r1315 | mdorf | 2017-11-02 19:44:05 -0700 (Thu, 02 Nov 2017) | 1 line

Extended BC classes to include the bc_type option. Presently, bc_type can be set to InflowOutflow (default), Dirichlet, or extrapolate.
------------------------------------------------------------------------
r1314 | mdorr | 2017-11-01 12:35:39 -0700 (Wed, 01 Nov 2017) | 3 lines

Fixing new Miller geometry specification for LBL nightly tests.


------------------------------------------------------------------------
r1313 | mdorr | 2017-10-31 12:28:13 -0700 (Tue, 31 Oct 2017) | 3 lines

Adding a gmake realclean.


------------------------------------------------------------------------
r1312 | mdorf | 2017-10-30 16:37:36 -0700 (Mon, 30 Oct 2017) | 1 line

Updated sampe inputs to be consistent with r1311
------------------------------------------------------------------------
r1311 | mdorf | 2017-10-30 14:37:27 -0700 (Mon, 30 Oct 2017) | 1 line

Refactored single-block (logically rectangular) geometry classes and related infrastructure. Added the cylindrical geometry option. NB: should now use lower-case miller and slab geometry specifications in input files. Also, m_radial_midpoint in the Tanch class now specifies a midpoint as a fraction (e.g., m_radial_midpoint = 0.5 corresponds to the middle of the radial domain). See Tanch.H for details.
------------------------------------------------------------------------
r1310 | mdorf | 2017-10-16 13:18:02 -0700 (Mon, 16 Oct 2017) | 1 line

Fixed a restart bug (for the case where self-consistent bcs are included). Forced zero parallel momentum in the calculation of an FS-averaged Maxwellian
------------------------------------------------------------------------
r1309 | debo | 2017-10-13 15:41:18 -0700 (Fri, 13 Oct 2017) | 1 line

Overhauled the preconditioning interface: 1) added the option of allowing part of the preconditioner to be defined as an action, 2) Implemented a two-level solver for the preconditioner (Rob Falgout's idea), 3) The old approach of using just a lower order discretization represented as a banded matrix is still available...
------------------------------------------------------------------------
r1308 | debo | 2017-10-13 13:57:20 -0700 (Fri, 13 Oct 2017) | 1 line

Fokker-Planck: turned energy conservation fix off by default
------------------------------------------------------------------------
r1307 | debo | 2017-10-04 16:56:16 -0700 (Wed, 04 Oct 2017) | 1 line

Added general configuration files for compiling hypre - assumes that the correct compilers are loaded and available through the mpicc/mpicxx command
------------------------------------------------------------------------
r1306 | mdorr | 2017-08-29 16:40:06 -0700 (Tue, 29 Aug 2017) | 3 lines

Adding a missing exchange to the fourth-order cell-centered field calculation.


------------------------------------------------------------------------
r1305 | mdorr | 2017-08-14 15:39:35 -0700 (Mon, 14 Aug 2017) | 3 lines

Changing the abs() to fabs() just to be safe.


------------------------------------------------------------------------
r1304 | mdorf | 2017-08-09 14:05:16 -0700 (Wed, 09 Aug 2017) | 1 line

Added an option for constructing a curved block boundary (currently only works for field-aligned grids). Some code refactoring was introduced.
------------------------------------------------------------------------
r1303 | debo | 2017-07-20 10:58:02 -0700 (Thu, 20 Jul 2017) | 1 line

Bugfix in collisions interface: No collisions -> return DBL_MAX as stable dt
------------------------------------------------------------------------
r1302 | debo | 2017-07-18 13:27:10 -0700 (Tue, 18 Jul 2017) | 9 lines

Major change: re-implemented the Fokker-Planck collision operator

Other changes:
+ implemented computing the Jacobians of right-hand-side operators through brute force finite differences
+ added CFL estimation for the Fokker-Planck collision term
+ added some useful screen output
+ added CornerBox and Facebox classes


------------------------------------------------------------------------
r1301 | mdorf | 2017-07-17 17:01:44 -0700 (Mon, 17 Jul 2017) | 1 line

Added a fix to the vorticity-model restart problem
------------------------------------------------------------------------
r1300 | mdorf | 2017-07-03 16:10:22 -0700 (Mon, 03 Jul 2017) | 1 line

Added the second-order switch for the constant and localized phase functions
------------------------------------------------------------------------
r1298 | mdorf | 2017-06-28 10:49:49 -0700 (Wed, 28 Jun 2017) | 1 line

Fixed subtract background option, included dt into the charge-exchange coefficient, and added the second function option to the Arbitrary function class
------------------------------------------------------------------------
r1297 | mdorf | 2017-06-26 10:11:59 -0700 (Mon, 26 Jun 2017) | 1 line

Fixed a bug for the X and O point initialization (when not directly specified in the DCT file)
------------------------------------------------------------------------
r1296 | schwartz | 2017-06-21 14:43:37 -0700 (Wed, 21 Jun 2017) | 2 lines

changed beginBlock and endBlock to beginBlockInit and endBlockInit to prevent conflict in the python code. 

------------------------------------------------------------------------
r1295 | schwartz | 2017-06-21 14:27:54 -0700 (Wed, 21 Jun 2017) | 2 lines

Added functions to field align const-xi block boundaries and check the flux values. Modified loops over blocks 0 to numBlocks to loops over beginBlock to endBlock, which speeds up debugging.

------------------------------------------------------------------------
r1294 | mdorf | 2017-06-15 11:21:28 -0700 (Thu, 15 Jun 2017) | 1 line

Added dealigned-grid option
------------------------------------------------------------------------
r1293 | mdorr | 2017-06-13 14:17:19 -0700 (Tue, 13 Jun 2017) | 3 lines

Removing some accidentally commited diagnostic plotting.


------------------------------------------------------------------------
r1292 | mdorf | 2017-06-12 17:13:46 -0700 (Mon, 12 Jun 2017) | 1 line

Added workaround for the extrablock exchange, which previously crashed if applied to objects with no ghost cells
------------------------------------------------------------------------
r1291 | mdorf | 2017-06-08 18:31:38 -0700 (Thu, 08 Jun 2017) | 1 line

Removed a debugging statement
------------------------------------------------------------------------
r1290 | mdorf | 2017-06-08 18:28:23 -0700 (Thu, 08 Jun 2017) | 1 line

Fixed fitted functions and add extrapolation capability
------------------------------------------------------------------------
r1289 | mdorr | 2017-06-08 17:10:41 -0700 (Thu, 08 Jun 2017) | 3 lines

Fixing bug with 8 block option introduced by my last commit.


------------------------------------------------------------------------
r1288 | mdorr | 2017-05-30 09:52:43 -0700 (Tue, 30 May 2017) | 3 lines

Fixing loop to only loop over 8 blocks and removing mapping file.


------------------------------------------------------------------------
r1287 | mdorr | 2017-05-25 19:49:46 -0700 (Thu, 25 May 2017) | 3 lines

Fixing the writing of the valid cell coordinates with the 10 block option.


------------------------------------------------------------------------
r1286 | mdorr | 2017-05-25 18:36:55 -0700 (Thu, 25 May 2017) | 3 lines

Adding 10 block option.


------------------------------------------------------------------------
r1285 | mdorf | 2017-05-19 16:09:55 -0700 (Fri, 19 May 2017) | 1 line

Moved box iterations in Kernels.cpp from C++ to Fortran; added second-order check for computing m_BStarParallel_cell_averaged
------------------------------------------------------------------------
r1284 | mdorf | 2017-05-19 12:39:06 -0700 (Fri, 19 May 2017) | 1 line

Fixed the broken dealignment_correction option
------------------------------------------------------------------------
r1283 | mdorf | 2017-05-19 09:21:27 -0700 (Fri, 19 May 2017) | 1 line

Removed an unused input parameter, updated examples
------------------------------------------------------------------------
r1282 | schwartz | 2017-05-16 21:46:19 -0700 (Tue, 16 May 2017) | 4 lines

Restored the capability to use a number of rows different than the number of columns. 

Also included the begining of the new ghost cell method. However, this section is not active yet.

------------------------------------------------------------------------
r1281 | schwartz | 2017-05-16 14:35:37 -0700 (Tue, 16 May 2017) | 2 lines

This input file works. For the moment anisotropy (used in mcore and mcsol) is broken.

------------------------------------------------------------------------
r1280 | mdorr | 2017-05-15 11:12:14 -0700 (Mon, 15 May 2017) | 3 lines

Turning off the STENCIL_UE macro.


------------------------------------------------------------------------
r1279 | mdorf | 2017-05-13 12:51:00 -0700 (Sat, 13 May 2017) | 1 line

Added implicit vorticity model and field-aligned option. Substantial code refactoring was involved.
------------------------------------------------------------------------
r1278 | schwartz | 2017-05-11 15:44:27 -0700 (Thu, 11 May 2017) | 2 lines

Changed to using _cf mapping file

------------------------------------------------------------------------
r1277 | schwartz | 2017-05-05 18:33:54 -0700 (Fri, 05 May 2017) | 2 lines

Preliminary implentation of new method for grid generation.

------------------------------------------------------------------------
r1275 | mdorr | 2017-04-07 14:10:41 -0700 (Fri, 07 Apr 2017) | 7 lines

Adding new accessor to return the field unit vector at a physical coordinate.

-This line, and those below, will be ignored--

M    FieldData.cpp
M    FieldData.H

------------------------------------------------------------------------
r1274 | schwartz | 2017-04-06 16:47:09 -0700 (Thu, 06 Apr 2017) | 2 lines

Fixing spacing in output

------------------------------------------------------------------------
r1273 | schwartz | 2017-04-06 16:34:47 -0700 (Thu, 06 Apr 2017) | 2 lines

Create a symbolic link to the debug version of the executable in Results/block[number] 

------------------------------------------------------------------------
r1272 | mdorf | 2017-03-28 17:27:18 -0700 (Tue, 28 Mar 2017) | 1 line

Added a mesh generator for flux-aligned grids
------------------------------------------------------------------------
r1271 | mdorr | 2017-03-13 17:26:32 -0700 (Mon, 13 Mar 2017) | 3 lines

Updating to the latest DCT file format.


------------------------------------------------------------------------
r1270 | schwartz | 2017-03-07 23:18:11 -0800 (Tue, 07 Mar 2017) | 7 lines

Added python script for running executables in
1) newBoundaryNodesIC
2) blocks
3) utilities

to produce a map with valid cells but no ghost cells in Results/outputMapping, which is called aligned.curr...txt

------------------------------------------------------------------------
r1269 | schwartz | 2017-03-07 12:56:15 -0800 (Tue, 07 Mar 2017) | 2 lines

removed unused parameters

------------------------------------------------------------------------
r1268 | schwartz | 2017-03-07 12:54:28 -0800 (Tue, 07 Mar 2017) | 2 lines

removed unused parameters

------------------------------------------------------------------------
r1267 | schwartz | 2017-03-07 12:51:31 -0800 (Tue, 07 Mar 2017) | 4 lines

Input file parsing more robust, because we read in entire file rather than specified lines. Thanks Terry.

 

------------------------------------------------------------------------
r1266 | schwartz | 2017-03-07 12:03:48 -0800 (Tue, 07 Mar 2017) | 11 lines

Adding six parameters for computeTargetSpacing, a method in newBoundaryNodesIC:
sigma_core       = 0.25
expo_core        = 2.0

sigma_scrape_off = 0.25
expo_scrape_off  = 2.0

sigma_private_flux = 0.25                 
expo_private_flux  = 2.0


------------------------------------------------------------------------
r1265 | schwartz | 2017-03-07 12:01:11 -0800 (Tue, 07 Mar 2017) | 2 lines

moved Chombo_Home one level higher, which is the same level as COGENT

------------------------------------------------------------------------
r1264 | schwartz | 2017-03-07 12:00:34 -0800 (Tue, 07 Mar 2017) | 3 lines

moved Chombo_Home one level higher, which is the same level as COGENT


------------------------------------------------------------------------
r1263 | schwartz | 2017-03-07 11:59:49 -0800 (Tue, 07 Mar 2017) | 2 lines

Moved Chombo_Home one level higher, which is the same level as COGENT

------------------------------------------------------------------------
r1262 | mdorr | 2017-02-21 16:46:30 -0800 (Tue, 21 Feb 2017) | 3 lines

Adding second-order cell-centered extrapolation option so that the minimum box size can be reduced from 5 to 4.


------------------------------------------------------------------------
r1261 | mdorr | 2017-02-17 15:28:00 -0800 (Fri, 17 Feb 2017) | 3 lines

Changing size() return type to conform to modified BaseFab.


------------------------------------------------------------------------
r1260 | schwartz | 2017-02-14 16:30:10 -0800 (Tue, 14 Feb 2017) | 10 lines

Added parameters for three Gaussians to deploy boundary points.

sigma_core
sigma_scrape_off
sigma_private_flux

expo_core
expo_scrape_off
expo_private_flux

------------------------------------------------------------------------
r1259 | schwartz | 2017-02-14 16:27:01 -0800 (Tue, 14 Feb 2017) | 2 lines

corrected location of Chombo

------------------------------------------------------------------------
r1257 | mdorr | 2017-02-11 17:43:45 -0800 (Sat, 11 Feb 2017) | 3 lines

New scripts for adding mapping ghost cells.


------------------------------------------------------------------------
r1256 | schwartz | 2017-01-18 16:46:40 -0800 (Wed, 18 Jan 2017) | 4 lines

Provisionally added code that blends (in mcore only!) the ghost cells arising from evenly spaced radial anchor points with the ghost cells arising from radial anchor points as come from Hypnotode. 

Going foward either we remove this blending or we make a system where associated to every block is a fab of blending weights.

------------------------------------------------------------------------
r1255 | debo | 2017-01-13 15:33:17 -0800 (Fri, 13 Jan 2017) | 1 line

Updated linking stuff for compilation with PETSc (for newer compilers on cab)
------------------------------------------------------------------------
r1254 | schwartz | 2017-01-12 15:08:22 -0800 (Thu, 12 Jan 2017) | 2 lines

Modify the method computeEvenSpacing to use even spacing on all sides and all blocks. Formerly we were making a few exceptions in mcore and mcsol. 

------------------------------------------------------------------------
r1253 | schwartz | 2017-01-11 14:33:38 -0800 (Wed, 11 Jan 2017) | 2 lines

switch to using _cf input mapping

------------------------------------------------------------------------
r1252 | schwartz | 2017-01-11 14:32:20 -0800 (Wed, 11 Jan 2017) | 2 lines

switch to using _cp input map

------------------------------------------------------------------------
r1251 | schwartz | 2017-01-11 14:31:16 -0800 (Wed, 11 Jan 2017) | 2 lines

switch to using _cf input map

------------------------------------------------------------------------
r1250 | mdorr | 2017-01-11 13:06:31 -0800 (Wed, 11 Jan 2017) | 3 lines

Adding a flux-corrected version of COGENT_mapping_3-22-16.


------------------------------------------------------------------------
r1249 | schwartz | 2017-01-09 17:14:11 -0800 (Mon, 09 Jan 2017) | 2 lines

Modified the field line following principle to be both field line following for poloidal lines and orthogonal for radial lines.

------------------------------------------------------------------------
r1248 | mdorr | 2017-01-07 17:08:11 -0800 (Sat, 07 Jan 2017) | 3 lines

Adding utility to clean the flux in Hypnotoad grids.


------------------------------------------------------------------------
r1247 | schwartz | 2017-01-06 16:04:26 -0800 (Fri, 06 Jan 2017) | 2 lines

added 0-padding to file names

------------------------------------------------------------------------
r1246 | schwartz | 2017-01-06 16:04:02 -0800 (Fri, 06 Jan 2017) | 2 lines

added 0-padding to file names

------------------------------------------------------------------------
r1245 | schwartz | 2017-01-06 16:03:36 -0800 (Fri, 06 Jan 2017) | 2 lines

added 0-padding to file names

------------------------------------------------------------------------
r1244 | schwartz | 2017-01-06 16:03:11 -0800 (Fri, 06 Jan 2017) | 2 lines

added 0-padding to file names

------------------------------------------------------------------------
r1243 | schwartz | 2017-01-06 16:02:27 -0800 (Fri, 06 Jan 2017) | 2 lines

Added 0-padding to file names

------------------------------------------------------------------------
r1242 | mdorr | 2017-01-04 13:45:54 -0800 (Wed, 04 Jan 2017) | 3 lines

Adding USE_LAPACK=TRUE


------------------------------------------------------------------------
r1241 | mdorr | 2016-12-22 18:21:27 -0800 (Thu, 22 Dec 2016) | 6 lines

Fixing potential initialization to pointwise from cell-averaged.

Adding calculation of nodal potential to fixed efield option.



------------------------------------------------------------------------
r1240 | mdorr | 2016-12-22 09:25:02 -0800 (Thu, 22 Dec 2016) | 3 lines

Changing the filling of corner ghost cells at interior block boundaries from extrapolation to extrablock ghost interpolation.


------------------------------------------------------------------------
r1239 | schwartz | 2016-12-19 18:09:40 -0800 (Mon, 19 Dec 2016) | 2 lines

Fixed a bug in moveMcoreMcsol parameter: previously the parameter only was set in compute evenSpacingCurr. Now it's also set in computeTargetSpacing 

------------------------------------------------------------------------
r1238 | schwartz | 2016-12-19 15:01:03 -0800 (Mon, 19 Dec 2016) | 2 lines

Changed system for repo file names: <map type>.repo.<baseRes>.<refRatio for mcore nand mcsol>.2d.hdf5

------------------------------------------------------------------------
r1237 | schwartz | 2016-12-15 15:48:23 -0800 (Thu, 15 Dec 2016) | 2 lines

Adde carriage return at EOF

------------------------------------------------------------------------
r1236 | schwartz | 2016-12-15 15:47:53 -0800 (Thu, 15 Dec 2016) | 2 lines

added carriage return at EOF

------------------------------------------------------------------------
r1235 | schwartz | 2016-12-15 15:47:18 -0800 (Thu, 15 Dec 2016) | 2 lines

added carriage return at EOF

------------------------------------------------------------------------
r1234 | schwartz | 2016-12-15 15:46:47 -0800 (Thu, 15 Dec 2016) | 2 lines

added carriage return at EOF

------------------------------------------------------------------------
r1233 | schwartz | 2016-12-15 15:46:15 -0800 (Thu, 15 Dec 2016) | 2 lines

added  carriage return at EOF

------------------------------------------------------------------------
r1232 | schwartz | 2016-12-15 10:07:29 -0800 (Thu, 15 Dec 2016) | 2 lines

adding ne feature

------------------------------------------------------------------------
r1231 | schwartz | 2016-12-14 15:11:21 -0800 (Wed, 14 Dec 2016) | 9 lines

Added a parameter, moveMcoreMcsol.

 moveMcoreMcsol = true  => evenly space boundary nodes on the long edges of mcore and mcsol.
 moveMcoreMcsol = false => leave boundary nodes on the long edges of mcore and mcsol as they are in the input map.





------------------------------------------------------------------------
r1230 | schwartz | 2016-12-14 14:39:09 -0800 (Wed, 14 Dec 2016) | 2 lines

Deleted the eight block code, because it drifted too far out of date

------------------------------------------------------------------------
r1229 | schwartz | 2016-12-14 14:37:52 -0800 (Wed, 14 Dec 2016) | 2 lines

Now runs to completion with additional resolution for radial cells in mcore and mcsol

------------------------------------------------------------------------
r1228 | schwartz | 2016-12-14 14:37:33 -0800 (Wed, 14 Dec 2016) | 2 lines

Now runs to completion with additional resolution for radial cells in mcore and mcsol

------------------------------------------------------------------------
r1227 | schwartz | 2016-12-14 14:36:54 -0800 (Wed, 14 Dec 2016) | 3 lines

w runs to completion with additional resolution for radial cells in mcore and mcsol


------------------------------------------------------------------------
r1226 | schwartz | 2016-12-14 14:36:05 -0800 (Wed, 14 Dec 2016) | 2 lines

Now runs to completion with differnt resolution for radial cells in mcore and mcsol

------------------------------------------------------------------------
r1225 | schwartz | 2016-12-13 18:13:21 -0800 (Tue, 13 Dec 2016) | 2 lines

Corrected a confusion between numRows and numCol. Code now has potential for different values for numRow for different blocks. Similarly for numCol, hiCorner, box, dx, etc. However, in spite of this potential, for now, the values are constant across blocks.

------------------------------------------------------------------------
r1224 | schwartz | 2016-12-13 18:13:06 -0800 (Tue, 13 Dec 2016) | 2 lines

Corrected a confusion between numRows and numCol. Code now has potential for different values for numRow for different blocks. Similarly for numCol, hiCorner, box, dx, etc. However, in spite of this potential, for now, the values are constant across blocks.

------------------------------------------------------------------------
r1223 | schwartz | 2016-12-13 18:12:40 -0800 (Tue, 13 Dec 2016) | 3 lines

Corrected a confusion between numRows and numCol. Code now has potential for different values for numRow for different blocks. Similarly for numCol, hiCorner, box, dx, etc. However, in spite of this potential, for now, the values are constant across blocks.


------------------------------------------------------------------------
r1222 | schwartz | 2016-12-13 18:11:44 -0800 (Tue, 13 Dec 2016) | 2 lines

Corrected a confusion between numRows and numCol. Code now has potential for different values for numRow for different blocks. Similarly for numCol, hiCorner, box, dx, etc. However, in spite of this potential, for now the values are constant across blocks.

------------------------------------------------------------------------
r1221 | schwartz | 2016-12-08 23:07:45 -0800 (Thu, 08 Dec 2016) | 2 lines

added refRatioXi and refRatioEta

------------------------------------------------------------------------
r1220 | schwartz | 2016-12-08 23:07:02 -0800 (Thu, 08 Dec 2016) | 2 lines

added refRatioXi and refRatioEta to this directory

------------------------------------------------------------------------
r1219 | schwartz | 2016-12-08 18:23:42 -0800 (Thu, 08 Dec 2016) | 2 lines

clean up

------------------------------------------------------------------------
r1218 | schwartz | 2016-12-08 18:18:13 -0800 (Thu, 08 Dec 2016) | 2 lines

changed comment

------------------------------------------------------------------------
r1217 | schwartz | 2016-12-08 17:00:44 -0800 (Thu, 08 Dec 2016) | 2 lines

Modifications to allow a different box, d_xi,d_eta, and so forth for each block.

------------------------------------------------------------------------
r1216 | schwartz | 2016-12-06 18:05:13 -0800 (Tue, 06 Dec 2016) | 2 lines

More progress towards dx != dy. Code runs to completion

------------------------------------------------------------------------
r1215 | schwartz | 2016-12-06 17:01:52 -0800 (Tue, 06 Dec 2016) | 2 lines

progress towards dx != dy for ghost cells

------------------------------------------------------------------------
r1214 | schwartz | 2016-12-06 16:58:25 -0800 (Tue, 06 Dec 2016) | 2 lines

Fixed condition for warning.

------------------------------------------------------------------------
r1213 | schwartz | 2016-12-06 16:50:06 -0800 (Tue, 06 Dec 2016) | 2 lines

this files runs even with dx != dy. Fixed bugs related indexing into edge fabs.

------------------------------------------------------------------------
r1211 | schwartz | 2016-12-05 16:09:00 -0800 (Mon, 05 Dec 2016) | 2 lines

Still working this mayday warning

------------------------------------------------------------------------
r1209 | schwartz | 2016-12-05 15:56:01 -0800 (Mon, 05 Dec 2016) | 1 line


------------------------------------------------------------------------
r1208 | schwartz | 2016-12-05 15:54:48 -0800 (Mon, 05 Dec 2016) | 2 lines

fixed typo in mayday warning call

------------------------------------------------------------------------
r1207 | schwartz | 2016-12-05 15:26:15 -0800 (Mon, 05 Dec 2016) | 2 lines

set refRatioXi = 1

------------------------------------------------------------------------
r1206 | schwartz | 2016-12-05 15:20:50 -0800 (Mon, 05 Dec 2016) | 2 lines

improved mayday warning

------------------------------------------------------------------------
r1205 | schwartz | 2016-12-05 15:17:54 -0800 (Mon, 05 Dec 2016) | 2 lines

added refRatioXi and refRatioEta

------------------------------------------------------------------------
r1204 | schwartz | 2016-12-05 15:14:51 -0800 (Mon, 05 Dec 2016) | 2 lines

changed to name to xiEtaRatio

------------------------------------------------------------------------
r1203 | schwartz | 2016-12-05 15:14:07 -0800 (Mon, 05 Dec 2016) | 2 lines

forgot to commit this

------------------------------------------------------------------------
r1202 | mdorr | 2016-12-02 15:48:33 -0800 (Fri, 02 Dec 2016) | 6 lines

Fixing the upper limit of the DCT expansion.

-This line, and those below, will be ignored--

M    configuration/SingleNullBlockCoordSysF.ChF

------------------------------------------------------------------------
r1201 | schwartz | 2016-11-30 17:41:56 -0800 (Wed, 30 Nov 2016) | 2 lines

still working on dx != dy

------------------------------------------------------------------------
r1200 | schwartz | 2016-11-30 16:42:48 -0800 (Wed, 30 Nov 2016) | 2 lines

added aspectRatio

------------------------------------------------------------------------
r1199 | schwartz | 2016-11-30 16:41:50 -0800 (Wed, 30 Nov 2016) | 2 lines

dx != dy bug

------------------------------------------------------------------------
r1198 | schwartz | 2016-11-29 17:23:27 -0800 (Tue, 29 Nov 2016) | 2 lines

Allows for dx  = aspectRatio*dy via a parameter in the input file : aspect ratio

------------------------------------------------------------------------
r1197 | debo | 2016-11-23 17:02:03 -0800 (Wed, 23 Nov 2016) | 11 lines

IMEX time integration: added options to control the terms that are integrated explicitly and that are integrated implicitly. The following options (in the input file) can be specified:

gksystem.imex_vlasov_implicit = true/false (default: false)
gksystem.imex_collisions_implicit = true/false (default: true)
gksystem.imex_transport_implicit = true/false (default: true)
gksystem.imex_neutrals_implicit = true/false (default: false)

These are relevant only if the following is specified:
gksystem.ti_class = "ark"


------------------------------------------------------------------------
r1196 | schwartz | 2016-11-22 18:04:55 -0800 (Tue, 22 Nov 2016) | 12 lines

Added output

evenBeforeInterpolation
evenAfterInterpolation
alignedBeforeInterpolation
alignedAfterInterpolation


Also, corrected an oversight in the code. Previously, the even map wasn't being interpolated in xi-eta space. Hence the initial guess wasn't as good as it could be. 



------------------------------------------------------------------------
r1195 | schwartz | 2016-11-22 16:31:37 -0800 (Tue, 22 Nov 2016) | 4 lines

Added a new file to the output:

evenAndAligned.final.2d.hdf5

------------------------------------------------------------------------
r1194 | schwartz | 2016-11-21 17:04:59 -0800 (Mon, 21 Nov 2016) | 2 lines

Stop overwriting evenExtended.final with out-of-date plot.

------------------------------------------------------------------------
r1193 | schwartz | 2016-11-17 17:34:58 -0800 (Thu, 17 Nov 2016) | 2 lines

Removing unneeded funcitons.

------------------------------------------------------------------------
r1191 | debo | 2016-11-15 13:03:40 -0800 (Tue, 15 Nov 2016) | 20 lines

Implemented TiDIRK (diagonally-implicit Runge-Kutta methods) and added a few DIRK methods. However, they are pretty inefficient till we implement effective preconditioning. To use them, the input file needs the following options:-

 ---------
gksystem.ti_class = "dirk"
gksystem.ti_method = "2cn" # Crank-Nicholson

dirk_newton.rtol = 1e-6   # Newton solver relative tolerance
dirk_newton.atol = 1e-10  # Newton solver absolute tolerance
dirk_newton.stol = 1e-16  # Newton solver step size tolerance

dirk_gmres.rtol = 1e-4    # GMRES solver relative tolerance
dirk_gmres.atol = 1e-11   # GMRES solver absolute tolerance

dirk_jacobian.with_pc = false # Use preconditioning?
dirk_pc.type = "gauss_seidel" # Solver for solving the preconditioning system
 ---------

Minor change: wall time reported after every time step


------------------------------------------------------------------------
r1190 | schwartz | 2016-11-10 18:19:37 -0800 (Thu, 10 Nov 2016) | 2 lines

python script for generating picture of all ten blocks in visit. In progress...

------------------------------------------------------------------------
r1189 | schwartz | 2016-11-10 15:07:11 -0800 (Thu, 10 Nov 2016) | 7 lines

Write out two additional sets of FArrayBoxes to diagnostic file

For each block name,
1) <res>.evenExtended          .final.<blockName>.2d.hdf5"
2) <res>.evenAndAlignedBeforeBS.final.<blockName>.2d.hdf5"


------------------------------------------------------------------------
r1188 | schwartz | 2016-11-08 23:44:48 -0800 (Tue, 08 Nov 2016) | 2 lines

write out even spaced map before extending.

------------------------------------------------------------------------
r1187 | schwartz | 2016-11-08 22:26:29 -0800 (Tue, 08 Nov 2016) | 2 lines

Added utilities for running magGeom

------------------------------------------------------------------------
r1186 | schwartz | 2016-11-07 17:36:08 -0800 (Mon, 07 Nov 2016) | 2 lines

minor

------------------------------------------------------------------------
r1185 | schwartz | 2016-11-07 17:24:50 -0800 (Mon, 07 Nov 2016) | 4 lines

Remove unused code and make a few lines easier to understand.

Added a parameter numInitSmooth, which determines a initial number of brackbill-salzman iterations that use only the smooth operator.

------------------------------------------------------------------------
r1184 | schwartz | 2016-11-07 16:34:27 -0800 (Mon, 07 Nov 2016) | 2 lines

corrected print statement

------------------------------------------------------------------------
r1183 | schwartz | 2016-11-07 14:43:48 -0800 (Mon, 07 Nov 2016) | 8 lines

Removed some diagnostic/ output and renamed remaining output. Now we have:

1) <res>.inputMap.<blockName>.2d.hdf5 (fabs written from input map                 )
2) <res>.even    .<blockName>.2d.hdf5 (based on even spaced bd nodes               )
3) <res>.aligned .<blockName>.2d.hdf5 (based on both flux matching and even spacing)
4) <res>.evenFlux.<blockName>.2d.hdf5 (data holder for checking alignment          )


------------------------------------------------------------------------
r1182 | schwartz | 2016-11-03 15:28:09 -0700 (Thu, 03 Nov 2016) | 2 lines

added boolean for reading from checkpoint file to begin brackbill-salzman

------------------------------------------------------------------------
r1181 | schwartz | 2016-11-03 15:27:23 -0700 (Thu, 03 Nov 2016) | 2 lines

Restored code to read from checkpoint file

------------------------------------------------------------------------
r1180 | schwartz | 2016-11-02 16:56:55 -0700 (Wed, 02 Nov 2016) | 2 lines

corrected print statement

------------------------------------------------------------------------
r1179 | schwartz | 2016-11-02 16:54:49 -0700 (Wed, 02 Nov 2016) | 2 lines

comment about checking the progress of a run

------------------------------------------------------------------------
r1178 | schwartz | 2016-11-02 16:32:40 -0700 (Wed, 02 Nov 2016) | 2 lines

removed USE_EB=TRUE from compile lines

------------------------------------------------------------------------
r1177 | schwartz | 2016-11-02 16:29:53 -0700 (Wed, 02 Nov 2016) | 2 lines

removed need for USE_EB=TRUE

------------------------------------------------------------------------
r1176 | schwartz | 2016-11-02 16:27:31 -0700 (Wed, 02 Nov 2016) | 2 lines

removed need for USE_EB = TRUE

------------------------------------------------------------------------
r1175 | schwartz | 2016-11-02 16:25:48 -0700 (Wed, 02 Nov 2016) | 2 lines

removed need for USE_EB=TRUE

------------------------------------------------------------------------
r1174 | schwartz | 2016-11-02 16:24:26 -0700 (Wed, 02 Nov 2016) | 2 lines

remove need for USE_EB = TRUE

------------------------------------------------------------------------
r1173 | schwartz | 2016-11-02 15:17:25 -0700 (Wed, 02 Nov 2016) | 8 lines

Added ghost cell code to make a block-by-block choice whether to use 

extrapolation of evenly spaced points
extrapolation of field aligned points
a weighted combination of the above



------------------------------------------------------------------------
r1172 | schwartz | 2016-11-01 15:17:31 -0700 (Tue, 01 Nov 2016) | 2 lines

Output fabs ("<res>.originalMap.<blockname>.2d.hdf5") generated by input mapping.

------------------------------------------------------------------------
r1171 | schwartz | 2016-10-31 16:08:33 -0700 (Mon, 31 Oct 2016) | 3 lines

Clean up by removing use of brackbill-salzman from this directory. NewBdInit.cpp just moves the boundary nodes. The main() file under blocks does all the Brackbill-Salzman.


------------------------------------------------------------------------
r1170 | schwartz | 2016-10-31 16:06:38 -0700 (Mon, 31 Oct 2016) | 2 lines

Changed line numbers corresponding to change in input.totalRun

------------------------------------------------------------------------
r1169 | schwartz | 2016-10-31 16:05:49 -0700 (Mon, 31 Oct 2016) | 2 lines

Removed iteration number for newBdInit

------------------------------------------------------------------------
r1168 | schwartz | 2016-10-31 15:14:43 -0700 (Mon, 31 Oct 2016) | 9 lines

Primary Modification:

In blocks 8 and 9 (mcore and mcsol) only move boundary points on edges that are anchor-points of field lines.

Minor changes:
1) Use (0,numBlocks) instead of (beginBlock,endBlock)
2) Remove checkpoint code, because it's not important here.


------------------------------------------------------------------------
r1167 | mdorr | 2016-10-28 16:34:04 -0700 (Fri, 28 Oct 2016) | 14 lines

Fixing the conversion of initial conditions from cell-centered to
cell-averaged to eliminate one-sided differencing.

-----------------------------------------------------------------
This line, and those below, will be ignored--

M    src/ibc/phase/ConstantKineticFunction.cpp
M    src/ibc/phase/TensorProductSineKineticFunction.cpp
M    src/ibc/phase/ArbitraryKineticFunction.cpp
M    src/ibc/phase/MaxwellianKineticFunction.cpp
M    src/ibc/phase/KineticFunctionUtils.H
M    src/ibc/phase/LocalizedKineticFunction.cpp
M    src/ibc/configuration/MillerFluidBC.cpp

------------------------------------------------------------------------
r1166 | schwartz | 2016-10-27 16:33:10 -0700 (Thu, 27 Oct 2016) | 2 lines

Moved deleting the done file to above the call to the executable.

------------------------------------------------------------------------
r1165 | mdorr | 2016-10-27 16:27:40 -0700 (Thu, 27 Oct 2016) | 4 lines

Moving the src directory back up to the root and making a relative path
to it in the magGeom makefile


------------------------------------------------------------------------
r1164 | mdorr | 2016-10-27 16:03:46 -0700 (Thu, 27 Oct 2016) | 3 lines

Removing the multidim makefile


------------------------------------------------------------------------
r1163 | mdorr | 2016-10-27 15:14:02 -0700 (Thu, 27 Oct 2016) | 3 lines

Moving the src directory and GNUmakefile.multidim in magGeom


------------------------------------------------------------------------
r1162 | schwartz | 2016-10-27 14:20:58 -0700 (Thu, 27 Oct 2016) | 3 lines

added comment about: computeTargetSpacing in input.totalRun


------------------------------------------------------------------------
r1161 | schwartz | 2016-10-27 14:15:47 -0700 (Thu, 27 Oct 2016) | 2 lines

Added USE_EB = TRUE to make file

------------------------------------------------------------------------
r1160 | schwartz | 2016-10-27 14:15:26 -0700 (Thu, 27 Oct 2016) | 2 lines

Added USE_EB = TRUE to make file

------------------------------------------------------------------------
r1159 | schwartz | 2016-10-27 14:14:29 -0700 (Thu, 27 Oct 2016) | 2 lines

Added USE_EB = TRUE to make file

------------------------------------------------------------------------
r1158 | schwartz | 2016-10-27 14:13:44 -0700 (Thu, 27 Oct 2016) | 2 lines

Added USE_EB=TRUE to make file

------------------------------------------------------------------------
r1157 | schwartz | 2016-10-27 14:12:58 -0700 (Thu, 27 Oct 2016) | 2 lines

Added USE_EB = TRUE to make file

------------------------------------------------------------------------
r1156 | mdorr | 2016-10-20 17:33:03 -0700 (Thu, 20 Oct 2016) | 3 lines

Fixing accidental commits 


------------------------------------------------------------------------
r1155 | mdorr | 2016-10-20 16:54:42 -0700 (Thu, 20 Oct 2016) | 3 lines

Adding test scripts.


------------------------------------------------------------------------
r1154 | mdorr | 2016-10-20 16:40:12 -0700 (Thu, 20 Oct 2016) | 3 lines

Adding option to compute moments in ghost cells.


------------------------------------------------------------------------
r1153 | mdorr | 2016-10-13 18:17:39 -0700 (Thu, 13 Oct 2016) | 3 lines

Fixing the division by BStarParallel to work correctly with or without ghost cells.


------------------------------------------------------------------------
r1152 | schwartz | 2016-10-13 15:58:16 -0700 (Thu, 13 Oct 2016) | 2 lines

Added USE_EB=TRUE

------------------------------------------------------------------------
r1151 | schwartz | 2016-10-13 15:54:55 -0700 (Thu, 13 Oct 2016) | 2 lines

Added USE_EB=TRUE to compile line and updated print statements

------------------------------------------------------------------------
r1150 | ligocki | 2016-10-13 14:40:14 -0700 (Thu, 13 Oct 2016) | 9 lines

In "setupPrecondMatrix", the argument "a_N" was declared "const int".  In the
call to "MPI_Allreduce" it is passed as "&a_N" (as the first argument).
Unfortunately, this is then a "const void*" and the function expects a
"void*".  Some C++ compilers object to that.

So, I changed "a_N" to an "int".  There still will be a local copy because it
is passed by value AND "MPI_Allreduce" shouldn't modify it's first argument as
far as I can tell...

------------------------------------------------------------------------
r1149 | debo | 2016-10-12 14:01:05 -0700 (Wed, 12 Oct 2016) | 5 lines

Minor stuff:
1) PETSc time integration: added wall time and function counts reporting
2) Increased default maximum number of GMRES iterations to 1000.


------------------------------------------------------------------------
r1148 | schwartz | 2016-10-11 15:16:30 -0700 (Tue, 11 Oct 2016) | 2 lines

A high resolution even map for making ghost cells.

------------------------------------------------------------------------
r1147 | schwartz | 2016-10-11 14:03:15 -0700 (Tue, 11 Oct 2016) | 2 lines

Specified MPI=FALSE and OPT=TRUE on compile lines, instead of relying on default behavior.

------------------------------------------------------------------------
r1146 | schwartz | 2016-10-11 13:27:36 -0700 (Tue, 11 Oct 2016) | 2 lines

Smaller problem, fewer iterations until we sort out compilation issues

------------------------------------------------------------------------
r1145 | schwartz | 2016-10-07 17:36:25 -0700 (Fri, 07 Oct 2016) | 2 lines

The saved maps have "repo" in the name, which avoids an overwriting problem

------------------------------------------------------------------------
r1144 | schwartz | 2016-10-07 17:33:15 -0700 (Fri, 07 Oct 2016) | 2 lines

A higher resolution map for possible use in the hybrid ghost cell method

------------------------------------------------------------------------
r1143 | schwartz | 2016-10-06 18:12:59 -0700 (Thu, 06 Oct 2016) | 2 lines

Added error messages based on return value of subprocess.call 

------------------------------------------------------------------------
r1142 | schwartz | 2016-10-06 16:33:08 -0700 (Thu, 06 Oct 2016) | 2 lines

Adding usage hint 

------------------------------------------------------------------------
r1141 | schwartz | 2016-10-06 15:57:25 -0700 (Thu, 06 Oct 2016) | 2 lines

Enable a flag "evenSpacingCase". Now totalRun.py can be used to create and store maps based on evenly spaced boundary nodes. These maps are necessary auxillaries to the hybrid method of adding ghost cells. 

------------------------------------------------------------------------
r1140 | schwartz | 2016-10-06 14:14:00 -0700 (Thu, 06 Oct 2016) | 2 lines

renaming file to prevent overwriting

------------------------------------------------------------------------
r1139 | schwartz | 2016-10-05 17:02:23 -0700 (Wed, 05 Oct 2016) | 2 lines

Working towards the flexibility to use totalRun.py to create the map with evenly spaced boundary nodes.

------------------------------------------------------------------------
r1138 | schwartz | 2016-10-05 17:00:03 -0700 (Wed, 05 Oct 2016) | 2 lines

changed name to be more consisitent with other directories

------------------------------------------------------------------------
r1137 | schwartz | 2016-10-05 15:32:01 -0700 (Wed, 05 Oct 2016) | 2 lines

updated directory name

------------------------------------------------------------------------
r1136 | schwartz | 2016-10-05 15:24:34 -0700 (Wed, 05 Oct 2016) | 2 lines

updated directory name

------------------------------------------------------------------------
r1135 | schwartz | 2016-10-05 15:21:06 -0700 (Wed, 05 Oct 2016) | 2 lines

corrected path name

------------------------------------------------------------------------
r1134 | schwartz | 2016-10-05 15:14:58 -0700 (Wed, 05 Oct 2016) | 2 lines

Changed the file name to be consistent with other directories

------------------------------------------------------------------------
r1133 | schwartz | 2016-10-05 15:05:59 -0700 (Wed, 05 Oct 2016) | 2 lines

Corrected path to geometryFiles

------------------------------------------------------------------------
r1132 | schwartz | 2016-10-05 14:58:31 -0700 (Wed, 05 Oct 2016) | 2 lines

Removed command line arguments from totalRun.py. All inputs set in input.totalRun

------------------------------------------------------------------------
r1131 | schwartz | 2016-10-04 14:33:46 -0700 (Tue, 04 Oct 2016) | 2 lines

Adding documentation for totalRun.py

------------------------------------------------------------------------
r1130 | schwartz | 2016-10-03 18:25:49 -0700 (Mon, 03 Oct 2016) | 2 lines

remove extraneous input files

------------------------------------------------------------------------
r1129 | schwartz | 2016-10-03 18:25:03 -0700 (Mon, 03 Oct 2016) | 2 lines

Make input.totalRun the only input file for totalRun.py

------------------------------------------------------------------------
r1128 | schwartz | 2016-10-03 17:59:09 -0700 (Mon, 03 Oct 2016) | 2 lines

One more suffix

------------------------------------------------------------------------
r1127 | schwartz | 2016-10-03 16:51:37 -0700 (Mon, 03 Oct 2016) | 2 lines

More suffixes

------------------------------------------------------------------------
r1126 | schwartz | 2016-10-03 16:51:23 -0700 (Mon, 03 Oct 2016) | 2 lines

More suffixes

------------------------------------------------------------------------
r1125 | schwartz | 2016-10-03 16:51:11 -0700 (Mon, 03 Oct 2016) | 2 lines

More suffixes

------------------------------------------------------------------------
r1124 | schwartz | 2016-10-03 16:19:34 -0700 (Mon, 03 Oct 2016) | 2 lines

Correcting suffix

------------------------------------------------------------------------
r1123 | schwartz | 2016-10-03 16:15:16 -0700 (Mon, 03 Oct 2016) | 2 lines

More suffixes

------------------------------------------------------------------------
r1122 | schwartz | 2016-10-03 16:05:33 -0700 (Mon, 03 Oct 2016) | 2 lines

More suffixes

------------------------------------------------------------------------
r1121 | schwartz | 2016-10-03 16:04:36 -0700 (Mon, 03 Oct 2016) | 2 lines

Adding suffixes to variables names in order to avoid conflict in a centralized input file

------------------------------------------------------------------------
r1120 | schwartz | 2016-10-03 15:33:51 -0700 (Mon, 03 Oct 2016) | 2 lines

More centralizing...

------------------------------------------------------------------------
r1119 | schwartz | 2016-10-03 15:31:14 -0700 (Mon, 03 Oct 2016) | 2 lines

Further work towards centralized inputs

------------------------------------------------------------------------
r1118 | schwartz | 2016-10-03 15:28:34 -0700 (Mon, 03 Oct 2016) | 2 lines

Working towards centralizing the inputs for input.totalRun

------------------------------------------------------------------------
r1117 | schwartz | 2016-09-30 17:43:32 -0700 (Fri, 30 Sep 2016) | 2 lines

Modify script to use command line argument in Results/blockj/input 

------------------------------------------------------------------------
r1116 | schwartz | 2016-09-30 16:54:06 -0700 (Fri, 30 Sep 2016) | 3 lines

Beginning docementation for the python script


------------------------------------------------------------------------
r1115 | schwartz | 2016-09-30 16:48:45 -0700 (Fri, 30 Sep 2016) | 2 lines

Beginning to write documentation...not finished yet.

------------------------------------------------------------------------
r1114 | schwartz | 2016-09-29 17:49:01 -0700 (Thu, 29 Sep 2016) | 2 lines

Changed file name extensions

------------------------------------------------------------------------
r1113 | schwartz | 2016-09-29 17:24:22 -0700 (Thu, 29 Sep 2016) | 2 lines

code moved from higher directory that's used for making pictures.

------------------------------------------------------------------------
r1112 | schwartz | 2016-09-29 17:22:22 -0700 (Thu, 29 Sep 2016) | 2 lines

Code for combining maps calculated separately on each block. Also, a pre-calcualte auxillary map used in ghost cell extrapolation. 

------------------------------------------------------------------------
r1111 | schwartz | 2016-09-29 17:20:20 -0700 (Thu, 29 Sep 2016) | 2 lines

These are the geometry files that the code uses.

------------------------------------------------------------------------
r1110 | schwartz | 2016-09-29 17:18:34 -0700 (Thu, 29 Sep 2016) | 2 lines

Code to move the boundary nodes in a mapping

------------------------------------------------------------------------
r1109 | schwartz | 2016-09-29 17:17:01 -0700 (Thu, 29 Sep 2016) | 2 lines

input file for totalRun.py

------------------------------------------------------------------------
r1108 | schwartz | 2016-09-29 17:16:09 -0700 (Thu, 29 Sep 2016) | 2 lines

Code for adding ghost cells

------------------------------------------------------------------------
r1107 | schwartz | 2016-09-29 17:14:49 -0700 (Thu, 29 Sep 2016) | 2 lines

Directory for storing checkpoint files

------------------------------------------------------------------------
r1106 | schwartz | 2016-09-29 17:13:56 -0700 (Thu, 29 Sep 2016) | 2 lines

Basic Brackbill-Salzman algorithm and directories for output and diagnosics

------------------------------------------------------------------------
r1105 | schwartz | 2016-09-29 17:11:19 -0700 (Thu, 29 Sep 2016) | 2 lines

python script that runs grid generation code on all blocks and adds ghost cells

------------------------------------------------------------------------
r1104 | schwartz | 2016-09-29 17:09:36 -0700 (Thu, 29 Sep 2016) | 2 lines

Modified an assert to reflect the fact that BField now has extra components corresponding to the flux value. 

------------------------------------------------------------------------
r1103 | schwartz | 2016-09-29 17:05:55 -0700 (Thu, 29 Sep 2016) | 2 lines

Getting ready to add files and directories for Brackbill-Salzman grid generation

------------------------------------------------------------------------
r1102 | mdorr | 2016-09-23 15:06:00 -0700 (Fri, 23 Sep 2016) | 3 lines

Adding a fluid BC for Miller and implementing a magnetic flux accessor (annulus case only).


------------------------------------------------------------------------
r1101 | mdorr | 2016-09-21 14:10:32 -0700 (Wed, 21 Sep 2016) | 3 lines

Adding stuff needed for SNCore 2D tests.


------------------------------------------------------------------------
r1100 | mdorr | 2016-09-15 17:33:43 -0700 (Thu, 15 Sep 2016) | 3 lines

Adding another test problem.


------------------------------------------------------------------------
r1099 | mdorr | 2016-09-15 13:17:14 -0700 (Thu, 15 Sep 2016) | 3 lines

Adding flux normal averaging at block boundaries in the divergence-free velocity option.


------------------------------------------------------------------------
r1098 | mdorr | 2016-09-13 17:38:57 -0700 (Tue, 13 Sep 2016) | 3 lines

Fixing velocity in BC fill.


------------------------------------------------------------------------
r1097 | mdorr | 2016-09-13 17:04:24 -0700 (Tue, 13 Sep 2016) | 3 lines

Removing some unnecessary functions.


------------------------------------------------------------------------
r1096 | mdorr | 2016-09-13 16:47:47 -0700 (Tue, 13 Sep 2016) | 3 lines

Updating the single null test exec directory.


------------------------------------------------------------------------
r1095 | mdorr | 2016-09-13 16:45:34 -0700 (Tue, 13 Sep 2016) | 3 lines

Fixing the 2D single null test code.


------------------------------------------------------------------------
r1094 | mdorr | 2016-09-13 16:42:50 -0700 (Tue, 13 Sep 2016) | 3 lines

Adding more fluid species support.


------------------------------------------------------------------------
r1093 | jhittinger | 2016-09-07 12:54:40 -0700 (Wed, 07 Sep 2016) | 1 line

REvision of 2D SingleNull test case
------------------------------------------------------------------------
r1092 | jhittinger | 2016-09-07 12:54:19 -0700 (Wed, 07 Sep 2016) | 1 line

REvision of 2D SingleNull test case
------------------------------------------------------------------------
r1090 | mdorr | 2016-08-25 10:36:10 -0700 (Thu, 25 Aug 2016) | 3 lines

Adding extrapolation of the mapped Poisson coefficients to transverse ghosts as is done for the GKPoisson operator.


------------------------------------------------------------------------
r1089 | mdorf | 2016-08-18 15:11:01 -0700 (Thu, 18 Aug 2016) | 1 line

Added getNodalFieldData function for the case of a field-aligned model geoemtry
------------------------------------------------------------------------
r1088 | mdorr | 2016-08-16 14:29:38 -0700 (Tue, 16 Aug 2016) | 10 lines

Adding the divergence-free velocity option, invoked from input as

   phase_space_mapping.divfree_velocity = true

and defaulted false.

Adding an input option to set the maximum order of the magnetic flux discrete cosine transform.



------------------------------------------------------------------------
r1085 | wonjae | 2016-08-12 13:50:35 -0700 (Fri, 12 Aug 2016) | 4 lines

Fixed truncation error of double to string conversion in the ParsingCore.
Added random noise generating function. e.g. "sin(x)+rand(0.02)-0.01"
Fixed a problem of not recognizing numbers in scientific format with lowercase 'e'.

------------------------------------------------------------------------
r1084 | debo | 2016-08-11 15:53:02 -0700 (Thu, 11 Aug 2016) | 10 lines

Major change: Implemented GKVector; everything related to time integration and related solvers work with serialized vectors instead of GKState or GKRHSData

Other changes:
1) Added wall time measurement and reporting
2) Bugfix in the banded matrix machinery: must initialize the banded matrix to a diagonal matrix with zero as the values so that if no part of the code assembles a preconditioner, it will still run without throwing nans
3) Fixed a few compilation warnings
4) RK: added 5th order Dormand-Prince methods (why?)
5) Cosmetic change to GMRES solver screen output


------------------------------------------------------------------------
r1082 | debo | 2016-08-01 17:17:01 -0700 (Mon, 01 Aug 2016) | 5 lines

1) Fixed the implementation of matrix-free Jacobian computation for nonlinear systems:  nonlinear coefficients have to be recalculated at each GMRES iterations as well (i.e., for Fokker-Planck, Rosenbluth potentials need to be recomputed at GMRES iterations). With this correction, Newton solver converges quickly (and stage predictors work really well!).

2) Fokker-Planck: added a screen output informing Rosenbluth potentials for F0 are recomputed due to the Maxwellian F0 being recomputed. 


------------------------------------------------------------------------
r1081 | mdorf | 2016-08-01 11:28:12 -0700 (Mon, 01 Aug 2016) | 1 line

Added an implicit version of the vorticity model
------------------------------------------------------------------------
r1079 | debo | 2016-07-20 14:00:29 -0700 (Wed, 20 Jul 2016) | 4 lines

1) Removed the linearization hard-coding in IMEX methods. They will solve a nonlinear problem if the terms are nonlinear.
2) In Fokker-Planck, if "CLS.{species_name}.rosenbluth_skip_stage" is set to true, problem will become linear since Rosenbluth potential will be assumed constant during a time step.


------------------------------------------------------------------------
r1071 | mdorf | 2016-07-07 17:38:11 -0700 (Thu, 07 Jul 2016) | 1 line

Fixed an indexing bug in logical sheath BC
------------------------------------------------------------------------
r1070 | mdorf | 2016-07-07 14:57:30 -0700 (Thu, 07 Jul 2016) | 1 line

Added logical sheath BC
------------------------------------------------------------------------
r1068 | debo | 2016-07-01 13:23:11 -0700 (Fri, 01 Jul 2016) | 3 lines

Fixed a "declarations in dependent base are not found by unqualified lookup" compilation error.


------------------------------------------------------------------------
r1067 | debo | 2016-06-28 15:26:55 -0700 (Tue, 28 Jun 2016) | 9 lines

Implemented preconditioners natively in COGENT (Jacobi, Gauss-Seidel, and their ASM variants). Some useful options:

ark_jacobian.with_pc = true   # Use a preconditioner, set to false to turn off preconditioning
ark_pc.type = "gauss_seidel"  # Type of preconditioner ("jacobi", "asm_jacobi", "gauss_seidel", "asm_gauss_seidel"), default: "gauss_seidel"
ark_pc_<name>.its = 10 # Number of iterations (<name> = ark_pc.type, e.g., ark_pc_jacobi.its)

By-product of above: implemented a [] operator for GKState and GKRHSData, which returns a reference to the desired entry (local index, not global index) in the corresponding "serialized" vector.


------------------------------------------------------------------------
r1066 | mdorr | 2016-06-27 17:43:41 -0700 (Mon, 27 Jun 2016) | 7 lines

Moving the 4d headers in front of the 2d headers.

//This line, and those below, will be ignored--

M    src/transport/Anomalous.cpp
M    src/transport/GKFluid.cpp

------------------------------------------------------------------------
r1063 | debo | 2016-06-21 14:17:50 -0700 (Tue, 21 Jun 2016) | 1 line

Restored parallel heat flux diagnostics
------------------------------------------------------------------------
r1062 | debo | 2016-06-20 13:06:38 -0700 (Mon, 20 Jun 2016) | 1 line

TiARK: solving [(1/dt*a_ii)Y_i - F(Y_i) = R] instead of [Y_i - dt*a_ii*F(Y_i) = R]
------------------------------------------------------------------------
r1061 | debo | 2016-06-17 17:25:37 -0700 (Fri, 17 Jun 2016) | 3 lines

Bugfix for the seg fault caused by last commit: the global DOF object must be set before time integrators are initialized


------------------------------------------------------------------------
r1060 | debo | 2016-06-17 16:34:09 -0700 (Fri, 17 Jun 2016) | 11 lines

Major:
Implemented the global DOF calculation and Jacobian assembling for a general case with multiple kinetic species, fluids, and fields.

Minor:
1) Cleaned up function count reporting and handling of external time integrators
2) Using std::vector instead of Real* in Fokker-Planck preconditioning matrix assembling.
3) Implemented skipping of post-stage activities after first stage for PETSc time integration as well.
4) Added fluid and field operators to explicit part of IMEX ops for now.
5) Removed an extra ";" in src/ibc/phase/KineticFunctionUtils.H to avoid compilation warnings.


------------------------------------------------------------------------
r1059 | jhittinger | 2016-06-15 09:10:57 -0700 (Wed, 15 Jun 2016) | 1 line

Added one ghost cell to the reference distribution function to be consistent with previous usage of ICs
------------------------------------------------------------------------
r1058 | jhittinger | 2016-06-14 14:21:03 -0700 (Tue, 14 Jun 2016) | 1 line

Rationalized the initialization process in GKSystem and did some minor refactoring of KineticFunctions.  We now directly initialize the computational state with ghost cells
------------------------------------------------------------------------
r1057 | mdorf | 2016-06-14 11:31:35 -0700 (Tue, 14 Jun 2016) | 1 line

Generalized calculation of moments to include ghosts (now seems to be working). Alos, increased tolerance from 1.e-16 to 1.e-12 in MBA calculations
------------------------------------------------------------------------
r1056 | mdorr | 2016-06-14 09:57:53 -0700 (Tue, 14 Jun 2016) | 3 lines

Add sample inputs directory.  The previous inputs directory should be removed, but we can't do it yet without breaking the nightly tests.


------------------------------------------------------------------------
r1055 | mdorf | 2016-06-13 16:42:04 -0700 (Mon, 13 Jun 2016) | 1 line

Revert 1050 changes in MomentOp.cpp that broke Rosenbluth potential solver
------------------------------------------------------------------------
r1054 | jhittinger | 2016-06-13 13:41:28 -0700 (Mon, 13 Jun 2016) | 1 line

Fixed restart problem
------------------------------------------------------------------------
r1053 | debo | 2016-06-13 13:11:15 -0700 (Mon, 13 Jun 2016) | 6 lines

1) Added a Maxwellian kernel
2) FokkerPlanck: implemented subtracting background of the Maxwellian (computed at the beginning of every step)
3) FokkerPlanck: added an option "CLS.<species_name>.compute_maxwellian" (true/false) specifying whether to use specified reference function or compute the Maxwellian (default: false)
4) PhaseGeom: fixed filename issue with plotting in the vpar-theta plane


------------------------------------------------------------------------
r1052 | debo | 2016-06-13 12:38:15 -0700 (Mon, 13 Jun 2016) | 1 line

Removed a bunch of compiler warnings (when compiled with DEBUG=TRUE
------------------------------------------------------------------------
r1051 | mdorf | 2016-06-13 10:20:47 -0700 (Mon, 13 Jun 2016) | 1 line

Added a missing file. Should hopefully fix the build failure
------------------------------------------------------------------------
r1050 | mdorf | 2016-06-10 16:56:34 -0700 (Fri, 10 Jun 2016) | 1 line

Fixed some bugs in the implementation of the vorticity model (more debugging is still needed)
------------------------------------------------------------------------
r1049 | mdorf | 2016-06-03 16:04:37 -0700 (Fri, 03 Jun 2016) | 1 line

Initial implementation of the vorticity fluid model (debuggin is needed)
------------------------------------------------------------------------
r1048 | debo | 2016-06-03 14:06:00 -0700 (Fri, 03 Jun 2016) | 1 line

TiARK: fixing a tiny bug that, fortuituously, did not cause incorrect computations.
------------------------------------------------------------------------
r1047 | debo | 2016-06-03 14:03:49 -0700 (Fri, 03 Jun 2016) | 1 line

Skipping E-field computation and Rosenbluth potential computation after the first stage since YStage(1) = y_n; but only explicit-first-stage ARK methods can be used so added a CH_assert to ensure that.
------------------------------------------------------------------------
r1046 | mdorf | 2016-06-02 10:31:09 -0700 (Thu, 02 Jun 2016) | 1 line

Updated diagnostic calculations (involved some code refactoring)
------------------------------------------------------------------------
r1044 | mdorf | 2016-05-26 16:31:44 -0700 (Thu, 26 May 2016) | 1 line

Updated the directory structure to be consistent with the previous commit
------------------------------------------------------------------------
r1043 | mdorf | 2016-05-26 16:29:02 -0700 (Thu, 26 May 2016) | 1 line

Added a skeleton code for fluid models
------------------------------------------------------------------------
r1042 | mdorr | 2016-05-26 11:02:45 -0700 (Thu, 26 May 2016) | 3 lines

Moving from FieldSolver to MagGeom the utilities for converting gradients to/from mapped/physical coordinates and for injecting/projecting poloidal vectors to/from full 3D vectors.


------------------------------------------------------------------------
r1041 | mdorf | 2016-05-24 17:27:11 -0700 (Tue, 24 May 2016) | 1 line

Revert changes in Moment.cpp back to r1039
------------------------------------------------------------------------
r1040 | mdorf | 2016-05-24 16:34:15 -0700 (Tue, 24 May 2016) | 1 line

Generalized moment calculations to include ghost cellsn
------------------------------------------------------------------------
r1035 | mdorr | 2016-05-16 17:00:19 -0700 (Mon, 16 May 2016) | 3 lines

Adding MultiBlock solver mods for 3D.


------------------------------------------------------------------------
r1034 | jhittinger | 2016-05-12 16:37:50 -0700 (Thu, 12 May 2016) | 1 line

Adding new files
------------------------------------------------------------------------
r1033 | jhittinger | 2016-05-11 17:55:57 -0700 (Wed, 11 May 2016) | 1 line

Fleshed out the BC and IC handling for FluidSpecies and Fields; still details must be added for specific types and models
------------------------------------------------------------------------
r1031 | mdorr | 2016-05-09 17:11:31 -0700 (Mon, 09 May 2016) | 3 lines

Restoring the passing of the physical state vector to GKOps::initializeElectricField().


------------------------------------------------------------------------
r1029 | jhittinger | 2016-05-06 13:16:11 -0700 (Fri, 06 May 2016) | 1 line

This should fix the bug
------------------------------------------------------------------------
r1028 | jhittinger | 2016-05-06 10:48:38 -0700 (Fri, 06 May 2016) | 1 line

Hopefully this fixes the abort bug introduced by recent changes
------------------------------------------------------------------------
r1027 | mdorr | 2016-05-03 18:25:35 -0700 (Tue, 03 May 2016) | 3 lines

Turning the preconditioner back on in the Rosenbluth PCG solves.


------------------------------------------------------------------------
r1026 | ligocki | 2016-05-03 13:50:55 -0700 (Tue, 03 May 2016) | 3 lines

Made "type" a "MPI_Op", added guards around MPI calls, and provided a serial
version of the reduce operations...

------------------------------------------------------------------------
r1023 | mdorr | 2016-04-30 11:00:30 -0700 (Sat, 30 Apr 2016) | 3 lines

Turning preconditioner back off, since it seems to be leaking memory.


------------------------------------------------------------------------
r1022 | mdorr | 2016-04-30 10:34:26 -0700 (Sat, 30 Apr 2016) | 3 lines

Updating the header that should have been included with the last commit.


------------------------------------------------------------------------
r1021 | mdorr | 2016-04-29 19:19:46 -0700 (Fri, 29 Apr 2016) | 3 lines

Fixing PCG.


------------------------------------------------------------------------
r1020 | jhittinger | 2016-04-29 10:51:43 -0700 (Fri, 29 Apr 2016) | 1 line

Added missing files
------------------------------------------------------------------------
r1019 | jhittinger | 2016-04-29 10:48:32 -0700 (Fri, 29 Apr 2016) | 1 line

Fixed issue with Field.H
------------------------------------------------------------------------
r1018 | jhittinger | 2016-04-28 18:02:52 -0700 (Thu, 28 Apr 2016) | 1 line

Generalization of GKState to enable fluid species and field data
------------------------------------------------------------------------
r1017 | mdorf | 2016-04-28 13:40:35 -0700 (Thu, 28 Apr 2016) | 1 line

Added parallel heat flux diagnostics
------------------------------------------------------------------------
r1016 | debo | 2016-04-28 13:32:32 -0700 (Thu, 28 Apr 2016) | 2 lines

FokkerPlanck: added an option to skip Rosenbluth potentials after each time integration stage (it will be computed only at the beginning of a step) - set CLS.species_name.rosenbluth_skip_stage = true (default: false).

------------------------------------------------------------------------
r1015 | debo | 2016-04-28 11:30:07 -0700 (Thu, 28 Apr 2016) | 1 line

Minor fixes to take care of some compiler warnings
------------------------------------------------------------------------
r1012 | debo | 2016-04-26 13:52:17 -0700 (Tue, 26 Apr 2016) | 1 line

Bugfix: moving divideJ (conversion from computational to physical solution) to postTimeStep()
------------------------------------------------------------------------
r1009 | debo | 2016-04-20 17:42:18 -0700 (Wed, 20 Apr 2016) | 1 line

FokkerPlanck: implemented the preconditioning matrix based on central differences, and this seems to work well for the 4th order FP operator.
------------------------------------------------------------------------
r1007 | mdorr | 2016-04-20 11:23:18 -0700 (Wed, 20 Apr 2016) | 3 lines

Removing unused header.


------------------------------------------------------------------------
r1006 | mdorr | 2016-04-20 10:58:02 -0700 (Wed, 20 Apr 2016) | 3 lines

Fixing master hypre doconfig script.


------------------------------------------------------------------------
r1004 | debo | 2016-04-18 17:31:02 -0700 (Mon, 18 Apr 2016) | 1 line

FokkerPlanck: Added Rosenbluth potential computation to post-time-stage function
------------------------------------------------------------------------
r1003 | mdorf | 2016-04-18 11:32:51 -0700 (Mon, 18 Apr 2016) | 1 line

1. Added the calculation of the normalized flux functions and other relative quantities into the Single null and SNCore block geometries. 2. Generalized the arbitrary grid function class to take mapped (default), physical, or flux coordinates as an input.
------------------------------------------------------------------------
r1002 | mdorr | 2016-04-15 17:37:11 -0700 (Fri, 15 Apr 2016) | 3 lines

Adding some script templates to help the test build.


------------------------------------------------------------------------
r1001 | mdorr | 2016-04-13 17:38:20 -0700 (Wed, 13 Apr 2016) | 3 lines

Fixing number of components in divideJOnValid.


------------------------------------------------------------------------
r1000 | debo | 2016-04-13 14:15:18 -0700 (Wed, 13 Apr 2016) | 3 lines

FokkerPlanck: Separated out Rosenbluth potential calculation from EvalCLSRHS, and put it in a preTimeStep function


------------------------------------------------------------------------
r999 | mdorr | 2016-04-12 18:05:26 -0700 (Tue, 12 Apr 2016) | 3 lines

Removing volume from MBSolver constructor.


------------------------------------------------------------------------
r998 | debo | 2016-04-12 17:43:35 -0700 (Tue, 12 Apr 2016) | 1 line

FokkerPlanck: the original high-order RHS calculation still needs to compute D_v, D_mu, etc separately for the preconditioner
------------------------------------------------------------------------
r997 | mdorr | 2016-04-12 16:24:49 -0700 (Tue, 12 Apr 2016) | 3 lines

Setting USE_PETSC back to FALSE


------------------------------------------------------------------------
r996 | mdorr | 2016-04-12 16:11:06 -0700 (Tue, 12 Apr 2016) | 3 lines

Removing "blob error test".


------------------------------------------------------------------------
r995 | mdorr | 2016-04-12 15:36:42 -0700 (Tue, 12 Apr 2016) | 3 lines

Removing no longer used fortran files.


------------------------------------------------------------------------
r993 | debo | 2016-04-12 14:42:28 -0700 (Tue, 12 Apr 2016) | 8 lines

1) Added a mapping object that contains the global DOF number for each cell in each box.
2) Linearized the stage solve for ARK time integrators (i.e. any nonlinear coefficients in the collision terms will be constant during an implicit stage solve).
3) Added a lower-order Fokker-Planck RHS evaluation that uses 1st order finite-differences (invoked by setting CLS.species_name.debug = true)
4) PhaseGeom: modified divideJonValid so that it can handle input FArrayBoxes with more components
5) FokkerPlanck: possible bugfix - for subtract_background = false, compute Rosenbluth potentials in the first step
6) Implemented a preconditioning matrix for Fokker-Planck... needs more work


------------------------------------------------------------------------
r992 | mdorr | 2016-04-12 13:08:15 -0700 (Tue, 12 Apr 2016) | 3 lines

Adding magnetic geometry members to provide the magnetic flux.


------------------------------------------------------------------------
r991 | wonjae | 2016-04-12 11:59:49 -0700 (Tue, 12 Apr 2016) | 2 lines

Deleting obsolete geometry files.

------------------------------------------------------------------------
r990 | jhittinger | 2016-04-11 12:35:06 -0700 (Mon, 11 Apr 2016) | 1 line

Name change
------------------------------------------------------------------------
r989 | mdorr | 2016-04-08 12:59:53 -0700 (Fri, 08 Apr 2016) | 3 lines

Fixing GKPoissonBoltzmann verbosity switch (was conflicting with FieldSolver's).


------------------------------------------------------------------------
r988 | jhittinger | 2016-04-07 16:17:29 -0700 (Thu, 07 Apr 2016) | 1 line

Initial Variable class
------------------------------------------------------------------------
r987 | mdorr | 2016-03-30 11:00:50 -0700 (Wed, 30 Mar 2016) | 3 lines

Adding member to compute magnetic flux at a single point.


------------------------------------------------------------------------
r986 | mdorr | 2016-03-29 14:09:51 -0700 (Tue, 29 Mar 2016) | 3 lines

Adding magnetic flux accessor, file writer and MatLab script.


------------------------------------------------------------------------
r985 | mdorr | 2016-03-23 10:00:01 -0700 (Wed, 23 Mar 2016) | 7 lines

Fixing the comment before the call to FieldData::getFieldUnitVectorFromDCT().

Making the DCT option the default (by defining USE_DCT_FIELD).

Adding block names to the mapping files.


------------------------------------------------------------------------
r984 | mdorr | 2016-03-08 11:21:18 -0800 (Tue, 08 Mar 2016) | 33 lines

Major field solve cleanup, including:

- Solver boundary conditions are now effected solely through the MBSolver boundary condition mechanisms (i.e., by composing the interior scheme with ghost cell extrapolation using bcs), rather than being explicitly handled in the matrix construction, which had become too complicated to maintain and extend to 3D.  This was the initial goal and motivation for this refactor.  Some minor changes were made in MBSolver to better support this.

- Adding PETSc version of the mapped multiblock solver.

- Completed implementation of the second_order option (i.e., applying the switch everywhere)

- The FieldSolver member functions are more clearly named to indicate whether they compute a poloidal field (two components) or the total field (three components).

- The FieldSolver members that calculate the field using boundary conditions are now explicitly so named, e.g., computePoloidalFieldWithBCs().  Otherwise, the field is computed from potentials extrapolated from the interior.

- References to field centering (e.g., computeFaceCenteredField) have been removed, since we don't generally do that for other variables/functions.

- Utility functions have been added to reduce redundant code, e.g., to compute gradients in physical coordinates to gradients in mapped coordinates by multiplying byt NJinverse, inject a poloidal field into a full field (with zero toroidal component), etc.

- The number of ghost cells in all electrostatic field variables is now one (reduced from two in GKOps)

- The tridiagonal solver formerly in GKPoissonBoltzmann has been moved to a new class MBTridiagonalSolver.

- The FieldSolver class now inherits from the Chombo LinOp class in order to use the Chombo BiCGStab and GMRES solvers for all field solvers, rather than just in GKPoissonBoltzmann as previously.  This means that FieldSolver now includes the corresponding virtuals.  The PCG and GMRES solvers previously included as FieldSolver members have been removed to reduce the number of solvers we're maintaining.

- Default tolerances are provided for all linear and nonlinear solvers

- The ParmParse parameters for all linear solvers have been standardized (string method, double tol, int max_iters, bool verbose).

- Some ParmParse prefixes for specifying the linear solver parameters have been changed to make it clearer what solver is being affected in cases where there are multiple solvers.  For example, the prefix for the Poisson solver used in the magnetic field divergence cleaing is now "field_correction" (as opposed to just "poisson_solver" as previously).

Turned off reporting of Newton solve failures in SingleNullBlockCoordSys.cpp and SNCoreBlockCoordSys.cpp.  These can be re-enabled by defining REPORT_NEWTON_FAILURE at the top of each file.

Added option in AnnulusPotentialBC to extrapolate the distribution function at radial boundaries, which had previously been necessary for the neoclassical tests, but no longer is if self-consistent boundary conditions are used.  This option should therefore no longer be used, but is being retained just in case.


------------------------------------------------------------------------
r983 | debo | 2016-03-03 17:14:48 -0800 (Thu, 03 Mar 2016) | 5 lines

1) Added stage predictors based on dense output in TiARK: use by setting "ark.stage_predictor = true" in the input file.
2) Added the option to specify the Jacobian-free epsilon value: set by specifying "ark.jfnk_epsilon = 1e-6" in the input file
3) Added function counters that report the number of times Vlasov, collision, transport, and neutral operators were called; and the total number of time steps, Newton and GMRES iterations.


------------------------------------------------------------------------
r982 | debo | 2016-03-02 18:36:13 -0800 (Wed, 02 Mar 2016) | 6 lines

1) For nonlinear collision operators (eg. Fokker-Planck), do not update the nonlinear coefficients (eg. Rosenbluth potentials) during GMRES iterations.
2) Added linear/nonlinear reporting function to Fokker-Planck and added doc comments to Krook and Linearized
3) TiARK: initial guess for nonlinear solve is previous stage solution.
4) Started building stuff to implement preconditioning


------------------------------------------------------------------------
r981 | debo | 2016-03-02 14:28:49 -0800 (Wed, 02 Mar 2016) | 1 line

Removed defunct Krook-specific IMEX solve functions
------------------------------------------------------------------------
r980 | mdorf | 2016-02-28 18:49:36 -0800 (Sun, 28 Feb 2016) | 1 line

fixed the long standing out-of-bound index issue for collision operators
------------------------------------------------------------------------
r978 | mdorr | 2016-02-23 17:12:53 -0800 (Tue, 23 Feb 2016) | 3 lines

Better yet, controling the field plots with the existing Ampere switch...


------------------------------------------------------------------------
r977 | mdorr | 2016-02-23 17:08:11 -0800 (Tue, 23 Feb 2016) | 3 lines

Switching off the Ampere option field plot.


------------------------------------------------------------------------
r976 | debo | 2016-02-23 14:01:46 -0800 (Tue, 23 Feb 2016) | 1 line

Linearized collision operator: added isLinear() that returns true
------------------------------------------------------------------------
r975 | debo | 2016-02-23 13:58:58 -0800 (Tue, 23 Feb 2016) | 1 line

Rearranged initializations in GMRES to avoid warnings
------------------------------------------------------------------------
r973 | mdorr | 2016-02-22 15:33:29 -0800 (Mon, 22 Feb 2016) | 3 lines

Updating second-order switch in field solver.


------------------------------------------------------------------------
r972 | mdorr | 2016-02-19 12:54:55 -0800 (Fri, 19 Feb 2016) | 3 lines

Adding member to plot phase space divergences.


------------------------------------------------------------------------
r969 | mdorr | 2016-02-18 15:47:38 -0800 (Thu, 18 Feb 2016) | 3 lines

Adding an input switch to extrapolate the distribution function at radial boundaries for the neoclassical tests.


------------------------------------------------------------------------
r968 | debo | 2016-02-17 14:58:34 -0800 (Wed, 17 Feb 2016) | 1 line

PETSc interface: fixed a stupid bug that was causing the post-time-stage function to crash
------------------------------------------------------------------------
r967 | debo | 2016-02-17 14:27:43 -0800 (Wed, 17 Feb 2016) | 1 line

Added some more ARK methods of 1st, 2nd, and 3rd orders; small fix in Newton solver so that it doesn't print ugly nans if the norm of the initial residual is exactly zero
------------------------------------------------------------------------
r966 | mdorr | 2016-02-16 12:35:02 -0800 (Tue, 16 Feb 2016) | 3 lines

Changing default hypre build to optimized.


------------------------------------------------------------------------
r965 | mdorr | 2016-02-16 12:26:30 -0800 (Tue, 16 Feb 2016) | 3 lines

Change the default build to optimized.


------------------------------------------------------------------------
r964 | mdorr | 2016-02-16 12:22:48 -0800 (Tue, 16 Feb 2016) | 3 lines

Adding another hypre build script.


------------------------------------------------------------------------
r963 | mdorf | 2016-02-13 14:25:55 -0800 (Sat, 13 Feb 2016) | 1 line

added accessor to the preconditioner matrix coefficients for the anomalous transport operator
------------------------------------------------------------------------
r962 | creyn | 2016-02-12 13:35:06 -0800 (Fri, 12 Feb 2016) | 1 line

COG-1: Changed config/Make.defs.local.cab to match removed exec/Make.defs.local. do_build succeeds now.
------------------------------------------------------------------------
r961 | mdorr | 2016-02-11 19:12:01 -0800 (Thu, 11 Feb 2016) | 3 lines

Tweaking the divergence cleaning code and adding a field divergence plot.


------------------------------------------------------------------------
r960 | wonjae | 2016-02-10 22:59:52 -0800 (Wed, 10 Feb 2016) | 2 lines

Stop adding subiterations to main step counts.

------------------------------------------------------------------------
r956 | creyn | 2016-02-09 19:59:34 -0800 (Tue, 09 Feb 2016) | 1 line

COG-1: Adjusted do_build.py to match new location of make.defs.local
------------------------------------------------------------------------
r955 | mdorr | 2016-02-09 13:26:55 -0800 (Tue, 09 Feb 2016) | 3 lines

Fixing bug in the allocation of processors to configuration space boxes caused by incorrect rounding of integer quotients.


------------------------------------------------------------------------
r954 | mdorr | 2016-02-09 12:07:35 -0800 (Tue, 09 Feb 2016) | 3 lines

Fixing magnetic field correction option.


------------------------------------------------------------------------
r953 | mdorr | 2016-02-09 11:39:54 -0800 (Tue, 09 Feb 2016) | 3 lines

Removing distribution function and flux physical boundary extrapolation added in r943 and adding exchanges at the end of all of the flux functions.


------------------------------------------------------------------------
r952 | debo | 2016-02-08 11:01:36 -0800 (Mon, 08 Feb 2016) | 1 line

Bugfix in computing the stable dt
------------------------------------------------------------------------
r951 | debo | 2016-02-05 18:00:41 -0800 (Fri, 05 Feb 2016) | 1 line

Overhaul and streamlining of pre- and post- time step functions; consistent computation of E-field in pre-time-step and post-stage functions (Note: PETSc time integration is not going to work for now :( )
------------------------------------------------------------------------
r950 | debo | 2016-02-04 18:19:16 -0800 (Thu, 04 Feb 2016) | 5 lines

PETSc interface
1) calling stableDt at pre-timestep so that time scales are computed
2) in implicitOp, compute E-field if its not defined. This is because PETSc calls IFunction before RHSFunction


------------------------------------------------------------------------
r949 | debo | 2016-02-04 14:40:41 -0800 (Thu, 04 Feb 2016) | 1 line

NewtonSolver: iteration count starts from 0 instead of 1
------------------------------------------------------------------------
r948 | debo | 2016-02-04 14:33:19 -0800 (Thu, 04 Feb 2016) | 1 line

Overhauled the calculation and reporting of time scales and CFL
------------------------------------------------------------------------
r947 | debo | 2016-02-04 12:58:15 -0800 (Thu, 04 Feb 2016) | 1 line

ARK: moving transport operator to the implicit part
------------------------------------------------------------------------
r946 | debo | 2016-02-04 12:54:16 -0800 (Thu, 04 Feb 2016) | 1 line

ARK methods: electric field computed only by explicit part, implicit part reuses that field
------------------------------------------------------------------------
r945 | debo | 2016-02-03 13:19:40 -0800 (Wed, 03 Feb 2016) | 1 line

Computation of stable dt takes into account which time integrator is being used; for ARK, only the Vlasov time scale is considered
------------------------------------------------------------------------
r944 | debo | 2016-02-03 11:17:46 -0800 (Wed, 03 Feb 2016) | 1 line

Bugfix: fixed a double free in the deallocations related to ARK time integration. In general, the Newton and GMRES solvers are not responsible for deallocating the function and Jacobian objects since they don't create them.
------------------------------------------------------------------------
r943 | mdorr | 2016-02-02 20:11:20 -0800 (Tue, 02 Feb 2016) | 3 lines

Restoring extrapolation of distribution functions and flux at physical boundaries.


------------------------------------------------------------------------
r942 | debo | 2016-02-02 14:59:53 -0800 (Tue, 02 Feb 2016) | 1 line

Removing the Make.defs.local in cogent/exec; the appropriate files for cab and cori are in cogent/config
------------------------------------------------------------------------
r941 | debo | 2016-02-02 14:00:29 -0800 (Tue, 02 Feb 2016) | 1 line

Added hypre and chombo files to the config directory
------------------------------------------------------------------------
r940 | mdorf | 2016-01-30 12:29:32 -0800 (Sat, 30 Jan 2016) | 1 line

Removed some diagnostics left from debugging
------------------------------------------------------------------------
r939 | mdorf | 2016-01-29 18:42:19 -0800 (Fri, 29 Jan 2016) | 1 line

Extended anomalous transport model for dealigned grids. Also fixed recently introduced minor bugs in FiledSolver::fillInternalGhost and SingleNullBlockCoordSys::realCoordPointwise.
------------------------------------------------------------------------
r938 | debo | 2016-01-29 17:41:29 -0800 (Fri, 29 Jan 2016) | 8 lines

Cleaned up PETSc time integration interface
1) Changed "use_petsc" keyword to "use_petsc_ts", since other parts of code may use PETSc
2) PETSc options now should be specified through .petscrc file
3) Added an example of .petscrc in inputs/
4) Bugfix in deallocation of Jacobian object
5) If implicit term is linear, use SNES type KSPONLY


------------------------------------------------------------------------
r937 | mdorr | 2016-01-29 10:54:07 -0800 (Fri, 29 Jan 2016) | 3 lines

Adding ghost cells to the projection of phase to configuration space to restore Ampere restart option.


------------------------------------------------------------------------
r936 | debo | 2016-01-28 17:23:56 -0800 (Thu, 28 Jan 2016) | 1 line

Removed the homogenous flag from GMRES and Linear function definitions
------------------------------------------------------------------------
r935 | debo | 2016-01-28 15:11:14 -0800 (Thu, 28 Jan 2016) | 5 lines

Improvements in solving for implicit stages
1) removed unused computeNorms functions
2) Collision model reports whether its linear or not, and this is used by the ARK implicit stage to compute Jacobian


------------------------------------------------------------------------
r934 | debo | 2016-01-28 15:10:00 -0800 (Thu, 28 Jan 2016) | 1 line

Deleted files that were moved to another directory
------------------------------------------------------------------------
r933 | debo | 2016-01-28 14:06:09 -0800 (Thu, 28 Jan 2016) | 4 lines

1) Reorg: time integration files are in src/time, solver files are in src/solver
2) ARK time integrator uses a Newton-GMRES solver for solving for implicit stages


------------------------------------------------------------------------
r932 | mdorf | 2016-01-26 18:47:26 -0800 (Tue, 26 Jan 2016) | 1 line

1. Added diagnostics plots for the Ampere-Er increment; 2. Fixed the input parm_parse argument passed to initialize the SNcore geometry in the NewGKPoissonBoltzmann class.
------------------------------------------------------------------------
r931 | debo | 2016-01-25 16:18:59 -0800 (Mon, 25 Jan 2016) | 8 lines

Implemented an interface to use PETSc time integration with COGENT. See INSTALL for instructions on how to compile with the PETSc interface, and README.PETSc on how to run using PETSc time integrators.

The default behavior has not changed:
1) COGENT will compile as before (without PETSc) if nothing is changed.
2) All input files should work as usual and the native time integrators
   will be used.


------------------------------------------------------------------------
r930 | mdorf | 2016-01-23 14:25:37 -0800 (Sat, 23 Jan 2016) | 1 line

1. Set the MODEL_GEOM pre-compiler option back to #undef. 2. Fixed E-field initialization for the ampere law option. 3. Changed the output of plotEfield to the unmapped E-field.
------------------------------------------------------------------------
r929 | mdorf | 2016-01-22 18:39:49 -0800 (Fri, 22 Jan 2016) | 1 line

cleaned up the field-aligned-geometry code, also changed the poloidal coordinate measure from the arc lenght to polar angle
------------------------------------------------------------------------
r927 | wonjae | 2016-01-21 11:37:45 -0800 (Thu, 21 Jan 2016) | 2 lines

Removing RetangularTorus geometry class

------------------------------------------------------------------------
r926 | rcohen | 2016-01-21 00:17:47 -0800 (Thu, 21 Jan 2016) | 3 lines

Generalized the mapping normalization so it is not hardwired that computational coordinates
all run from 0 to 2 pi.  (But the currently implemented choice is still 0 to 2 pi.)  

------------------------------------------------------------------------
r925 | mdorf | 2016-01-19 18:53:04 -0800 (Tue, 19 Jan 2016) | 1 line

added field-aligned geometry and the second order code to handle it
------------------------------------------------------------------------
r922 | wonjae | 2016-01-11 20:08:05 -0800 (Mon, 11 Jan 2016) | 4 lines

Adding RectangularTorus coordinate (this will work same as slab in 4D).
Fixing Slab geometry for radially varying toroidal magnetic field.
Making radial_lower/upper boundaries in slab geometry compartible with radial_inner/outer.

------------------------------------------------------------------------
r921 | mdorr | 2016-01-11 13:24:06 -0800 (Mon, 11 Jan 2016) | 3 lines

Fixing assertions that only apply when ampere_cold_electrons is false.


------------------------------------------------------------------------
r920 | mdorr | 2016-01-08 16:11:30 -0800 (Fri, 08 Jan 2016) | 7 lines

Removing extrapolations at block interfaces in the calculation of the electric field, velocity and flux.

Updating to the latest version of the MBSolver interface.

Miscellaneous edits to remove compiler warnings.


------------------------------------------------------------------------
r919 | creyn | 2016-01-08 10:39:05 -0800 (Fri, 08 Jan 2016) | 1 line

COG-1: Added hypre changes that belong with build scripting
------------------------------------------------------------------------
r918 | mdorf | 2016-01-07 18:57:08 -0800 (Thu, 07 Jan 2016) | 1 line

Adding functionality to deal with the dealignment between the grid surfaces and magnetic flux surfaces
------------------------------------------------------------------------
r917 | creyn | 2016-01-07 14:43:17 -0800 (Thu, 07 Jan 2016) | 1 line

COG-1: Added build scripting for regression testing and IDE files for PyCharm and CodeBlocks
------------------------------------------------------------------------
r916 | creyn | 2016-01-07 14:38:36 -0800 (Thu, 07 Jan 2016) | 1 line

COG-1: Added build scripting for regression testing and IDE files for PyCharm and CodeBlocks
------------------------------------------------------------------------
r913 | mdorr | 2015-12-22 14:42:11 -0800 (Tue, 22 Dec 2015) | 3 lines

Adding time to plot files.


------------------------------------------------------------------------
r912 | debo | 2015-12-22 13:28:23 -0800 (Tue, 22 Dec 2015) | 1 line

Deleting doconfig-bash-mpicxx-gfortran-opt because it is not needed (I had added it)
------------------------------------------------------------------------
r911 | debo | 2015-12-22 13:27:28 -0800 (Tue, 22 Dec 2015) | 1 line

Restoring doconfig-cab-mpiicpc-ifort-dbg to the hypre folder - this file was there before all this rearrangement
------------------------------------------------------------------------
r910 | debo | 2015-12-22 13:23:10 -0800 (Tue, 22 Dec 2015) | 1 line

Created a config folder, and keeping the configuration files for Chombo and Hypre in it
------------------------------------------------------------------------
r909 | wonjae | 2015-12-22 10:59:14 -0800 (Tue, 22 Dec 2015) | 2 lines

Fixing a bug of skipping m_system->advance() when m_fixed_dt_subiteration=true and m_fixed_dt<dt_stable are satisfied.

------------------------------------------------------------------------
r908 | debo | 2015-12-19 23:56:07 -0800 (Sat, 19 Dec 2015) | 1 line

Deleting src/core/GKARK4.* - they were assimilated into GKTimeIntegration
------------------------------------------------------------------------
r907 | mdorr | 2015-12-19 14:17:29 -0800 (Sat, 19 Dec 2015) | 3 lines

Commenting out duplicate member definitions.


------------------------------------------------------------------------
r906 | debo | 2015-12-18 16:10:42 -0800 (Fri, 18 Dec 2015) | 9 lines

Implemented more general time integrators:
1) RK - "1fe", "2a", "3", "4"
2) ARK - "1bee", "4" (will add more)
Time integration method can be specified as:
gksystem.ti_class = "ark" (class of integrator)
gksystem.ti_method = "4"  (specific method of that class)
These are optional inputs; if not present, RK4 will be used.


------------------------------------------------------------------------
r905 | mdorr | 2015-12-12 12:49:58 -0800 (Sat, 12 Dec 2015) | 3 lines

Fixing parallel streaming switch.


------------------------------------------------------------------------
r903 | wonjae | 2015-12-02 17:57:36 -0800 (Wed, 02 Dec 2015) | 3 lines

Adding subiteration scheme for fixed_dt>stable_dt cases.
Turn on this feature by simulation.fixed_dt_subiteration=true.

------------------------------------------------------------------------
r902 | mdorr | 2015-12-02 13:55:08 -0800 (Wed, 02 Dec 2015) | 6 lines

Moving ParsingCore.[cpp,H] from src/ibc/phase to src/ibc/multidim.

Adding src/ibc/multidim to mdsrc_dirs in GNUMakefile.multidim and uncommenting it.



------------------------------------------------------------------------
r901 | mdorr | 2015-12-02 13:23:42 -0800 (Wed, 02 Dec 2015) | 3 lines

Changing BoundaryBoxLayout.H include to BoundaryBoxLayout.H.multidim


------------------------------------------------------------------------
r900 | mdorr | 2015-12-02 11:20:51 -0800 (Wed, 02 Dec 2015) | 3 lines

Removing m_limit_face_values member.


------------------------------------------------------------------------
r899 | mdorr | 2015-12-02 09:51:31 -0800 (Wed, 02 Dec 2015) | 3 lines

Adding GridFunction::assign() member analogous to the KineticFunction::assign() member that takes a BoundaryBoxLayout.


------------------------------------------------------------------------
r896 | wonjae | 2015-10-30 17:42:57 -0700 (Fri, 30 Oct 2015) | 3 lines

Modifed the name formats of the species plots. They can be loaded easily in visit. 
e.g.) plt.temperature0000.1.hydrogen.2d.hdf5 --> plt.1.hydrogen.temperature0000.2d.hdf5

------------------------------------------------------------------------
r894 | wonjae | 2015-10-21 12:32:11 -0700 (Wed, 21 Oct 2015) | 17 lines

Adding equation parser for arbitrary initializing kinetic and grid function.
x is radial grid which spans from 0 to (radial_outer_boundary-raidal_inner_boundary) for miller geometry.
y is poloidal grid which spans from 0 to 2*PI.
vpar is parallel velocity which spans from -v_parallel_max to v_parrallel_max.
mu is perpendicular velocity which spans from 0 to mu_max.

usage example:
IC.hydrogen.function = "arbitrary_phase_func" 
kinetic_function_library.list = "arbitrary_phase_func"
kinetic_function_library.arbitrary_phase_func.type = "arbitrary"
kinetic_function_library.arbitrary_phase_func.function = "0.001+0.05*exp(-((x-0.017)^2/0.0001+(y-PI)^2/PI))*exp(-vpar^2/8)*exp(-mu^2/0.3))"
IC.potential.function = "arbitrary_grid_func"
grid_function_library.list = "arbitrary_grid_func" 
grid_function_library.arbitrary_grid_func.type = "arbitrary"
grid_function_library.arbitrary_grid_func.function  = "1.0+exp(-(x-0.017)^2/0.0001)*exp(-(y-pi)^2/PI)"


------------------------------------------------------------------------
r891 | dmartin | 2015-10-05 12:17:30 -0700 (Mon, 05 Oct 2015) | 5 lines

semi-reverted Milo's updated HDF5 interface fixes. Now, COGENT should be able to build against either HDF5 1.6 and 1.8 APIs (handled via "#ifdef H516" conditionals areound the relevant code.

This should hopefully fix the ANAG regression tests.


------------------------------------------------------------------------
r885 | mdorr | 2015-09-23 14:38:01 -0700 (Wed, 23 Sep 2015) | 3 lines

Adding potential boundary condition class for slab geometry.


------------------------------------------------------------------------
r883 | mdorr | 2015-09-09 16:03:20 -0700 (Wed, 09 Sep 2015) | 4 lines

Updating the HDF5 calls to the post-1.6 API.  The H5_USE_16_API flag should no longer be used.



------------------------------------------------------------------------
r882 | schwartz | 2015-08-31 16:13:27 -0700 (Mon, 31 Aug 2015) | 2 lines

commented out some debugging output

------------------------------------------------------------------------
r881 | schwartz | 2015-08-31 16:12:04 -0700 (Mon, 31 Aug 2015) | 2 lines

When the iteration fails to converge in mappedCoordNewton, we now return the initial guess instead of exiting.

------------------------------------------------------------------------
r880 | schwartz | 2015-08-31 14:14:17 -0700 (Mon, 31 Aug 2015) | 2 lines

Added (currently commented-out) debugging code, that I will probably want again after the next check-in

------------------------------------------------------------------------
r879 | schwartz | 2015-08-31 13:38:12 -0700 (Mon, 31 Aug 2015) | 2 lines

undefine USE_DCT_FIELD by default

------------------------------------------------------------------------
r878 | mdorr | 2015-08-31 10:14:37 -0700 (Mon, 31 Aug 2015) | 3 lines

Modification to compute the Newton initial guesses in the union of valid and ghost regions.


------------------------------------------------------------------------
r876 | mdorr | 2015-08-21 16:36:22 -0700 (Fri, 21 Aug 2015) | 3 lines

Adding original DIIID mapping file.


------------------------------------------------------------------------
r874 | mdorr | 2015-08-10 16:04:47 -0700 (Mon, 10 Aug 2015) | 5 lines

Fixing field calculculation to avoid one-sided differences at block interfaces.

Removing the calculation of the potential poloidal variation and associated field when using the ampere option with cold electrons.


------------------------------------------------------------------------
r872 | mdorr | 2015-08-04 15:02:49 -0700 (Tue, 04 Aug 2015) | 4 lines

Modifications to use separate files for the physical coordinate mapping and magnetic field.



------------------------------------------------------------------------
r870 | mdorf | 2015-07-31 18:50:28 -0700 (Fri, 31 Jul 2015) | 1 line

Generalizing MaxwellianKinetcFunction to include a non-uniform parallel velocity profile(if no profile is specified, vparallel is set to zero)
------------------------------------------------------------------------
r867 | schwartz | 2015-07-28 13:17:09 -0700 (Tue, 28 Jul 2015) | 2 lines

Added MPI guards 

------------------------------------------------------------------------
r866 | mdorr | 2015-07-28 11:45:49 -0700 (Tue, 28 Jul 2015) | 3 lines

Adding option to perform interpolation only on block interiors.


------------------------------------------------------------------------
r864 | mdorr | 2015-06-19 17:01:58 -0700 (Fri, 19 Jun 2015) | 3 lines

Removing the no longer needed trigonometric field interpolation option.


------------------------------------------------------------------------
r863 | mdorr | 2015-06-19 16:37:53 -0700 (Fri, 19 Jun 2015) | 3 lines

Fixing misspelled variable name in reading of restart file.


------------------------------------------------------------------------
r862 | mdorr | 2015-06-11 11:08:32 -0700 (Thu, 11 Jun 2015) | 3 lines

Adding option to define the magnetic field using a discrete cosine expansion.


------------------------------------------------------------------------
r857 | mdorr | 2015-05-18 18:26:13 -0700 (Mon, 18 May 2015) | 5 lines

Updating the algorithm that computes the X point neighborhood in the block finding algorithm.

Removing tabs from SlabBlockCoordSys.cpp


------------------------------------------------------------------------
r856 | rcohen | 2015-05-17 11:18:53 -0700 (Sun, 17 May 2015) | 3 lines

Correction of normalization of mapping.  May still be a problem, though.


------------------------------------------------------------------------
r854 | jhittinger | 2015-05-12 13:00:16 -0700 (Tue, 12 May 2015) | 1 line

Finalized new boundary filling routines and removed old and duplicated code.
------------------------------------------------------------------------
r852 | mdorr | 2015-05-12 11:27:12 -0700 (Tue, 12 May 2015) | 3 lines

Moving coord_sys reference outside of DataIterator loop.


------------------------------------------------------------------------
r848 | jhittinger | 2015-05-11 12:57:54 -0700 (Mon, 11 May 2015) | 1 line

Fixed bug in inflow setting routines.
------------------------------------------------------------------------
r847 | rcohen | 2015-05-05 09:20:05 -0700 (Tue, 05 May 2015) | 7 lines

Corrected slab model files (corrected mapping so computational variables run
from 0 to 2 pi, easiest way to make cosine model sensible)
Removed offending "!= Null" from one statement each in the two SingleNull files to 
enable compilation on Mac with clang compilers -- (change OK'ed by Milo).
Also added a tiny test of the slab model to input directory.


------------------------------------------------------------------------
r846 | mdorr | 2015-04-24 17:08:52 -0700 (Fri, 24 Apr 2015) | 3 lines

Adding option to construct magnetic field from Hypnotoad discrete cosine coefficients.


------------------------------------------------------------------------
r845 | mdorr | 2015-04-24 17:06:59 -0700 (Fri, 24 Apr 2015) | 3 lines

Adding block labels to regression test mapping file.


------------------------------------------------------------------------
r844 | mdorr | 2015-04-23 15:54:50 -0700 (Thu, 23 Apr 2015) | 6 lines

Adding 10-block single null geometry option.  Previous 8-block input files should still work, but all geometry mapping files must now include block labels.

Adding option to obtain data on extra-block transverse ghost faces by copying from neighboring blocks when block boundary is conforming.



------------------------------------------------------------------------
r843 | mdorr | 2015-04-21 16:25:38 -0700 (Tue, 21 Apr 2015) | 3 lines

Fixing missing "else" in test on geometries in GKOps::setCoreBC().


------------------------------------------------------------------------
r842 | mdorr | 2015-04-21 16:06:06 -0700 (Tue, 21 Apr 2015) | 3 lines

Adding poloidal variations to the Ampere law field solver option and making it selectable from input.  Replacing the CONSITENT_POTENTIAL_BCS macro with an input switch. 


------------------------------------------------------------------------
r840 | rcohen | 2015-04-20 23:00:17 -0700 (Mon, 20 Apr 2015) | 2 lines

Adding missing Slab files in phase directory

------------------------------------------------------------------------
r839 | ligocki | 2015-04-13 18:37:09 -0700 (Mon, 13 Apr 2015) | 3 lines

Changed tabs to spaces - this was causing the regression test to fail to build
for COGENT...

------------------------------------------------------------------------
r838 | rcohen | 2015-04-09 23:44:03 -0700 (Thu, 09 Apr 2015) | 8 lines

Added slab geometry model, and updated other files to accommodate the additional geometry option.
Also corrected some MayDay error message printouts in PhaseGeom.cpp to reflect the variable which
is actually relevant to the error.
Note the slab model has not yet been tested for accuracy, only that it runs (in 4D COGENT).
The Slab model files were coded so that they should compile in 2 or 3 spatial
dimensions but only the 2D compile has been attempted.


------------------------------------------------------------------------
r834 | rcohen | 2015-03-25 12:21:10 -0700 (Wed, 25 Mar 2015) | 4 lines

Mods per discussions with Mikhail and Milo that allow build with Mikhail's 
changes for multilevel bspline interpolation (involves C11) on both Macs and LC machines


------------------------------------------------------------------------
r833 | mdorr | 2015-03-11 17:46:51 -0700 (Wed, 11 Mar 2015) | 3 lines

Adding code to incorporate poloidal potential variation in the flux-surface averaged field option.


------------------------------------------------------------------------
r831 | mdorf | 2015-03-03 16:37:04 -0800 (Tue, 03 Mar 2015) | 1 line

Added restart capability for the anomalous transport model
------------------------------------------------------------------------
r827 | mdorf | 2015-02-03 21:51:53 -0800 (Tue, 03 Feb 2015) | 1 line

Added restart capibility for the average Er field option (a.k.a. the XGC0 option)
------------------------------------------------------------------------
r826 | mdorr | 2015-02-03 18:11:54 -0800 (Tue, 03 Feb 2015) | 3 lines

Updating the subspace iteration solver.


------------------------------------------------------------------------
r825 | mdorr | 2015-02-03 17:58:29 -0800 (Tue, 03 Feb 2015) | 3 lines

Adding std=c++0x to fix regression test failure.


------------------------------------------------------------------------
r824 | mdorf | 2015-01-30 17:05:42 -0800 (Fri, 30 Jan 2015) | 1 line

Fixing the preprocessor directives syntax for th recent commit of the RADIAL_FIELD_ONLY option
------------------------------------------------------------------------
r823 | mdorf | 2015-01-27 15:27:09 -0800 (Tue, 27 Jan 2015) | 1 line

Adding another option for scattered data interpolation. Now have the Radial Basis Function (RBF) and the Multilevel B-Spline Approximation (MBA) options.
------------------------------------------------------------------------
r822 | mdorf | 2015-01-26 18:56:33 -0800 (Mon, 26 Jan 2015) | 1 line

Added a new grid function that interpolates from scattered data
------------------------------------------------------------------------
r821 | mdorf | 2015-01-26 18:55:35 -0800 (Mon, 26 Jan 2015) | 1 line

Added a new grid function that interpolates from scattered data
------------------------------------------------------------------------
r819 | mdorr | 2015-01-23 09:22:05 -0800 (Fri, 23 Jan 2015) | 3 lines

Removing old version of hypre.


------------------------------------------------------------------------
r817 | rcohen | 2015-01-14 16:42:14 -0800 (Wed, 14 Jan 2015) | 5 lines

Beginning changes to update code to 5D.  All changes except one removing
a Mayday error/message if not in 2D are behind compiler directives or 
ChF dimension macros, and so do not affect execution in 4D.


------------------------------------------------------------------------
r816 | mdorf | 2015-01-09 14:19:25 -0800 (Fri, 09 Jan 2015) | 1 line

Added the XGC0 option for the radial electric field
------------------------------------------------------------------------
r815 | mdorf | 2015-01-06 22:27:16 -0800 (Tue, 06 Jan 2015) | 1 line

Added the neutrals directory
------------------------------------------------------------------------
r814 | mdorf | 2015-01-06 21:38:25 -0800 (Tue, 06 Jan 2015) | 1 line

Added a skeleton code for neutrals, with a Krook-like neutrals model (copied from collisions/Krook) as a temporary example
------------------------------------------------------------------------
r813 | mdorr | 2015-01-06 17:28:39 -0800 (Tue, 06 Jan 2015) | 3 lines

Adding a second order swith to PhaseGeom and getting rid of a bunch of unused member functions involving jacobian multiplications and divisions.


------------------------------------------------------------------------
r812 | mdorr | 2015-01-06 14:21:21 -0800 (Tue, 06 Jan 2015) | 3 lines

Removing preprocessed header


------------------------------------------------------------------------
r811 | mdorf | 2015-01-06 09:43:33 -0800 (Tue, 06 Jan 2015) | 1 line

Added new options for the SingleNullDistr grid function.
------------------------------------------------------------------------
r810 | mdorf | 2015-01-05 16:31:04 -0800 (Mon, 05 Jan 2015) | 1 line

Generalized the anomalous transport model to the case of a multiblock geometry (e.g., single-null). Added option for a non-uniform diffusion coefficient (currently only for the particle diffusivity).
------------------------------------------------------------------------
r809 | jhittinger | 2014-12-18 18:00:57 -0800 (Thu, 18 Dec 2014) | 1 line

Added another face averaging option.
------------------------------------------------------------------------
r808 | jhittinger | 2014-12-15 09:18:30 -0800 (Mon, 15 Dec 2014) | 1 line

Revisions to the limited face averages and time step limits
------------------------------------------------------------------------
r807 | jhittinger | 2014-12-15 09:18:25 -0800 (Mon, 15 Dec 2014) | 1 line

Revisions to the limited face averages and time step limits
------------------------------------------------------------------------
r806 | mdorf | 2014-12-13 11:06:14 -0800 (Sat, 13 Dec 2014) | 1 line

updated the anomalous transport model to be consistent with the current version of COGENT (still need to generalize it to a single-null geometry)
------------------------------------------------------------------------
r805 | mdorr | 2014-12-12 14:13:10 -0800 (Fri, 12 Dec 2014) | 6 lines

Updating experimental solver option.

:--This line, and those below, will be ignored--

M    GKPoissonBoltzmann.cpp

------------------------------------------------------------------------
r804 | mdorr | 2014-11-24 12:08:53 -0800 (Mon, 24 Nov 2014) | 4 lines

Modifications to accommodate new 10 block single null geometry and an example mapping file.



------------------------------------------------------------------------
r803 | mdorr | 2014-11-14 16:15:54 -0800 (Fri, 14 Nov 2014) | 3 lines

Adding an experimental solver option.


------------------------------------------------------------------------
r802 | mdorf | 2014-11-07 17:26:31 -0800 (Fri, 07 Nov 2014) | 1 line

Added option to compute a flux-surface average. The default option still computes a shell-average. Modified the particle flux and heat flux diagnostics accordingly.
------------------------------------------------------------------------
r801 | mdorr | 2014-10-29 16:51:26 -0700 (Wed, 29 Oct 2014) | 3 lines

Adding accessor to fill single null core efield.


------------------------------------------------------------------------
r800 | mdorr | 2014-10-29 11:33:12 -0700 (Wed, 29 Oct 2014) | 4 lines

Fixing restarts using the consistent BC option and the setting of the inner radial boundary value for the core solver in the full SN geometry. 



------------------------------------------------------------------------
r799 | mdorr | 2014-10-27 14:56:40 -0700 (Mon, 27 Oct 2014) | 3 lines

Fixing setting of outer core boundary values using the consistent boundary condition option in the full single null.


------------------------------------------------------------------------
r798 | mdorr | 2014-10-23 18:31:44 -0700 (Thu, 23 Oct 2014) | 3 lines

Initial fix of restart for non-fixed field option and self-consistent boundary condition option.


------------------------------------------------------------------------
r797 | mdorr | 2014-10-22 17:28:55 -0700 (Wed, 22 Oct 2014) | 3 lines

Adding self-consistent boundary condition option to SingleNull core solver.


------------------------------------------------------------------------
r796 | schwartz | 2014-10-22 16:28:41 -0700 (Wed, 22 Oct 2014) | 2 lines

More formatting

------------------------------------------------------------------------
r795 | schwartz | 2014-10-22 16:28:18 -0700 (Wed, 22 Oct 2014) | 2 lines

Formatting arguments in a more familiar way.

------------------------------------------------------------------------
r794 | schwartz | 2014-10-22 16:24:32 -0700 (Wed, 22 Oct 2014) | 2 lines

Moved assignment of the variable third to the constructor, in order to compile using the anag compilers. Also, eliminated const as an attribute of third.

------------------------------------------------------------------------
r793 | rcohen | 2014-10-22 10:40:24 -0700 (Wed, 22 Oct 2014) | 3 lines

local expansion of ideal snowflake grid, mapping to/from comp coords and unit vector


------------------------------------------------------------------------
r792 | mdorr | 2014-10-22 09:48:45 -0700 (Wed, 22 Oct 2014) | 5 lines

Finishing preceding commit (apparently done from the wrong directory).

Modified check for radial Neumann conditions in GKPoissonBoltzmann to also check for periodic.


------------------------------------------------------------------------
r791 | mdorr | 2014-10-21 18:14:06 -0700 (Tue, 21 Oct 2014) | 3 lines

Implementing radial_only field solve and new treatment of radial tridiagonal solve (correct flux averaging and addition of Lagrange multiplier).  


------------------------------------------------------------------------
r790 | mdorr | 2014-09-12 17:09:58 -0700 (Fri, 12 Sep 2014) | 3 lines

Reverting multJOnValid and divideJOnValid to the previous versions that are actually inverses of each other.


------------------------------------------------------------------------
r789 | mdorf | 2014-09-12 16:38:52 -0700 (Fri, 12 Sep 2014) | 1 line

Adding computePsiThetaProjections function to the MagBlockCoordSys class, and updating the E-field diagnostics to plot the psi and theta projections of the physical E-field
------------------------------------------------------------------------
r788 | mdorr | 2014-09-10 16:35:28 -0700 (Wed, 10 Sep 2014) | 4 lines

Fixing the distribution function plots.  The grids() accessor of MultiBlockLevelGeom was being called to get the DisjointBoxLayout instead of gridsFull().



------------------------------------------------------------------------
r787 | mdorr | 2014-09-05 10:06:26 -0700 (Fri, 05 Sep 2014) | 3 lines

Adding an option to extrapolate the electric field at physical boundaries.  The Neoclassical test problems seem to need this.


------------------------------------------------------------------------
r786 | mdorf | 2014-09-01 20:41:15 -0700 (Mon, 01 Sep 2014) | 1 line

Adding the tanh option to the SingleNullDistr  grid function
------------------------------------------------------------------------
r785 | mdorr | 2014-08-22 17:02:43 -0700 (Fri, 22 Aug 2014) | 3 lines

Updating over-ridden (to incorporate an axisymmetry option) cellVol() to use full real-space point as the flux (as in NewFourthOrderCoordSys), which apparently has better error cancelation.


------------------------------------------------------------------------
r784 | mdorr | 2014-08-22 16:40:43 -0700 (Fri, 22 Aug 2014) | 3 lines

Updating regression test to be consistent with latest commit.


------------------------------------------------------------------------
r783 | mdorr | 2014-08-22 16:40:17 -0700 (Fri, 22 Aug 2014) | 3 lines

Commiting latest changes to new single null Poisson Boltzmann solver.  This has required a change in how the mapping file is specified in the input file (to avoid "No geometry mapping file specified" error messages).  See input/sn_coarse.in for an example.


------------------------------------------------------------------------
r782 | mdorr | 2014-08-20 17:33:43 -0700 (Wed, 20 Aug 2014) | 3 lines

Reverting last week's changes to reduce interblock extrapolations.


------------------------------------------------------------------------
r781 | mdorr | 2014-08-19 14:02:48 -0700 (Tue, 19 Aug 2014) | 4 lines

Fixing calculation of tangential E field component at physical boundaries.



------------------------------------------------------------------------
r780 | mdorr | 2014-08-18 14:54:54 -0700 (Mon, 18 Aug 2014) | 3 lines

Fixing the second-order transverse extrapolation functions to ignore periodic block boundaries.


------------------------------------------------------------------------
r779 | mdorr | 2014-08-15 17:51:57 -0700 (Fri, 15 Aug 2014) | 4 lines

Adding missing files.



------------------------------------------------------------------------
r778 | mdorr | 2014-08-15 16:40:56 -0700 (Fri, 15 Aug 2014) | 3 lines

Initial implementation of a generalized GK Poisson Boltzmann solver.


------------------------------------------------------------------------
r777 | mdorr | 2014-08-12 14:04:35 -0700 (Tue, 12 Aug 2014) | 3 lines

Removing inadvertant creation of MBLevelExchange object for single block runs.


------------------------------------------------------------------------
r776 | mdorr | 2014-08-08 17:34:21 -0700 (Fri, 08 Aug 2014) | 3 lines

Restoring previous version of GKPoisson coefficient calculation.


------------------------------------------------------------------------
r775 | mdorr | 2014-08-08 17:22:08 -0700 (Fri, 08 Aug 2014) | 3 lines

Yet another rewrite of the multJonValid and divideJonValid members to remove one-sided differences at block interfaces.


------------------------------------------------------------------------
r774 | mdorr | 2014-08-07 18:01:55 -0700 (Thu, 07 Aug 2014) | 2 lines

Fixing a transverse ghost cell extrapolation bug introduced yesterday...

------------------------------------------------------------------------
r773 | mdorr | 2014-08-07 16:07:13 -0700 (Thu, 07 Aug 2014) | 3 lines

Removing redundant multiplication in PhaseGeom::multJonValid().


------------------------------------------------------------------------
r772 | mdorr | 2014-08-06 17:29:34 -0700 (Wed, 06 Aug 2014) | 6 lines

Finishing removal of MultiBlockLevelExchange workaround.

Replacing the extrapolation of tranverse edge values at multiblock interfaces with values computed using interGhosts() where possible.  This required other changes, for example, the computation of the electric field on two ghost cell faces at block interfaces.



------------------------------------------------------------------------
r771 | mdorr | 2014-08-06 16:23:09 -0700 (Wed, 06 Aug 2014) | 3 lines

Removing old MultiBlockLevelExchange::interpGhosts() workaround and diagnostics.


------------------------------------------------------------------------
r770 | mdorr | 2014-08-06 11:25:04 -0700 (Wed, 06 Aug 2014) | 3 lines

Adding option to specify a spectral representation of the magnetic field.  Removing the divergence-free basis function experimental option.


------------------------------------------------------------------------
r769 | jhittinger | 2014-08-04 13:12:50 -0700 (Mon, 04 Aug 2014) | 1 line

Put collisions beack in GKOps::explicitOp() provided USE_ARK4 is undefined
------------------------------------------------------------------------
r768 | mdorr | 2014-07-14 16:50:28 -0700 (Mon, 14 Jul 2014) | 3 lines

Filling extrablock ghost cells before field calculation.


------------------------------------------------------------------------
r767 | mdorr | 2014-07-08 18:00:38 -0700 (Tue, 08 Jul 2014) | 3 lines

Adding missing files.


------------------------------------------------------------------------
r766 | mdorr | 2014-07-08 17:53:08 -0700 (Tue, 08 Jul 2014) | 3 lines

Finishing implementation of SNCore boundary condition classes.


------------------------------------------------------------------------
r765 | mdorf | 2014-06-16 19:30:40 -0700 (Mon, 16 Jun 2014) | 1 line

Revising the sheath-BC code to be consistent with the current containers for the sheath-BC data
------------------------------------------------------------------------
r764 | mdorr | 2014-06-06 14:41:02 -0700 (Fri, 06 Jun 2014) | 3 lines

Adding skeleton code for setting Mikhail's divertor boundary conditions.


------------------------------------------------------------------------
r763 | mdorr | 2014-06-04 19:32:25 -0700 (Wed, 04 Jun 2014) | 5 lines

Adding missing DataArray.[cpp,H] files.

Making another adjustment of the field calculation for inhomogeneous BCs.


------------------------------------------------------------------------
r762 | mdorr | 2014-06-04 16:47:35 -0700 (Wed, 04 Jun 2014) | 3 lines

Removing a diagnostic print out I didn't mean to check in.


------------------------------------------------------------------------
r761 | mdorr | 2014-06-04 16:30:22 -0700 (Wed, 04 Jun 2014) | 9 lines

Refactoring the potential boundary conditions so that only GKOps owns them and passes them into the field solver when coefficients are updated.

Adding a new GridFunction consisting of an FArrayBox.

Fixing the electric field calculation for nonhomogeneous boundary conditions.

Fixing the self-consistent boundary condition option for the neoclassical transport problems.


------------------------------------------------------------------------
r760 | mdorr | 2014-05-21 18:02:05 -0700 (Wed, 21 May 2014) | 3 lines

Deleting RK4Integrator.H


------------------------------------------------------------------------
r759 | mdorr | 2014-05-21 18:01:31 -0700 (Wed, 21 May 2014) | 3 lines

Removing commented out code.


------------------------------------------------------------------------
r758 | jhittinger | 2014-05-21 17:29:35 -0700 (Wed, 21 May 2014) | 1 line

Replaced RK4 integrator with RK4DenseOutput
------------------------------------------------------------------------
r757 | mdorr | 2014-05-19 17:53:54 -0700 (Mon, 19 May 2014) | 3 lines

Adding a GMRES option to the field solver to handle cases where a non-orthogonal mapping makes the operator non-symmetric with the current implementation of Neumann boundary conditions.


------------------------------------------------------------------------
r756 | mdorr | 2014-05-19 14:13:20 -0700 (Mon, 19 May 2014) | 3 lines

Adding new potential boundary condition specification.


------------------------------------------------------------------------
r755 | mdorr | 2014-05-16 19:37:06 -0700 (Fri, 16 May 2014) | 3 lines

Fixing bug in Wednesday commit that was messing up the GAM test.


------------------------------------------------------------------------
r754 | jhittinger | 2014-05-16 16:10:22 -0700 (Fri, 16 May 2014) | 1 line

More flux functions, some BC clean-up, and initial implicit ARK4 integration of simple Krook operator
------------------------------------------------------------------------
r753 | mdorr | 2014-05-15 11:47:38 -0700 (Thu, 15 May 2014) | 3 lines

Modifying the SingleNullPoissonBCs to use GridFunctions to specify boundary values.


------------------------------------------------------------------------
r752 | mdorr | 2014-05-01 13:33:35 -0700 (Thu, 01 May 2014) | 5 lines

Fixing distribution function plot (which previously included a BStarParallel factor).

Adding BStarParallel plotting.


------------------------------------------------------------------------
r751 | mdorf | 2014-04-04 17:26:08 -0700 (Fri, 04 Apr 2014) | 1 line

Removing some minor redundant coding
------------------------------------------------------------------------
r750 | mdorf | 2014-04-04 17:20:39 -0700 (Fri, 04 Apr 2014) | 1 line

Minor developments: 1. Adding numberDensity diagnostics and simplifying certain related calculations. 2. Addinig minor revisions to the calculation of the Coulomb logarithm. 3. Generalizing the calculations of particle and heat fluxes and poloidal flow velocity for the case of a single-null geoemtry
------------------------------------------------------------------------
r749 | mdorf | 2014-04-04 15:34:58 -0700 (Fri, 04 Apr 2014) | 1 line

Adding Boltzmann electrons (first stab for a divertor geometry)
------------------------------------------------------------------------
r748 | mdorr | 2014-03-25 09:08:44 -0700 (Tue, 25 Mar 2014) | 5 lines

Modifications to use the same (newer) mapping file format that COGENT uses.  Removing the calculation of the second derivatives of the field components. 

Adding new mapping file and deleting the old one.


------------------------------------------------------------------------
r747 | mdorr | 2014-03-21 16:18:42 -0700 (Fri, 21 Mar 2014) | 4 lines

Adding option to fix radial boundary flux to the initial time value.



------------------------------------------------------------------------
r746 | mdorr | 2014-03-21 10:34:21 -0700 (Fri, 21 Mar 2014) | 5 lines

Adding accessor for BStarParallel.

Adding experimental member function to zero physical boundary fluxes.


------------------------------------------------------------------------
r745 | mdorr | 2014-03-06 11:12:01 -0800 (Thu, 06 Mar 2014) | 3 lines

Restoring the recalculation of the non-differentiated field quantities after divergence cleaning.


------------------------------------------------------------------------
r744 | mdorr | 2014-03-06 10:12:09 -0800 (Thu, 06 Mar 2014) | 7 lines

Removed m_potential_model in GKSystem.cpp, since it is no longer consistent with how the initial potential is specified now.

Changed the logic controlling the plotting of the potential and/or field.  The plots must now be explicitly requested (or not) in the input file.  If the fixed_efield option is true, only the initial time plots are generated.

Removed some DOS format carriage returns.


------------------------------------------------------------------------
r743 | mdorr | 2014-03-05 16:11:52 -0800 (Wed, 05 Mar 2014) | 3 lines

Adding diagnostic to plot field alignment.


------------------------------------------------------------------------
r742 | mdorf | 2014-03-03 00:02:38 -0800 (Mon, 03 Mar 2014) | 1 line

Extended the pressure diagnostics to include a parallel velocity shift; updated Justin's collision operator to be consistent with this new diagnostics; added deltaF diagnostics that computes deviation from Maxwellian with the same density, parallel velocity, and temperature
------------------------------------------------------------------------
r741 | mdorr | 2014-02-28 16:25:42 -0800 (Fri, 28 Feb 2014) | 3 lines

Adding Boltzmann electron densities to total charge plots.


------------------------------------------------------------------------
r740 | mdorr | 2014-02-21 16:13:40 -0800 (Fri, 21 Feb 2014) | 3 lines

Fixing the fixed_efield option on restarts.


------------------------------------------------------------------------
r739 | mdorr | 2014-02-20 12:54:59 -0800 (Thu, 20 Feb 2014) | 7 lines

Removing J factors from the filling of physical boundary ghost cells.

Replaced transverse fluxes at block boundaries with extrapolation from the interior.

Other minor mods and clean up.


------------------------------------------------------------------------
r738 | mdorr | 2014-02-13 14:16:55 -0800 (Thu, 13 Feb 2014) | 3 lines

Fixing the curl(b) calculation when using the non-axisymmetric field option.


------------------------------------------------------------------------
r737 | mdorr | 2014-02-12 17:44:52 -0800 (Wed, 12 Feb 2014) | 3 lines

Fixed a bug that was causing the "found_entry" assertion failure in MBHypreSolver for certain domain decompositions.


------------------------------------------------------------------------
r736 | mdorr | 2014-01-24 09:32:33 -0800 (Fri, 24 Jan 2014) | 3 lines

Updating path to mapping file.


------------------------------------------------------------------------
r735 | mdorr | 2014-01-22 13:03:38 -0800 (Wed, 22 Jan 2014) | 3 lines

Updating single null regression test input files.


------------------------------------------------------------------------
r734 | petermc | 2014-01-21 12:33:51 -0800 (Tue, 21 Jan 2014) | 2 lines

Removed semicolon after #ifdef CH_MPI

------------------------------------------------------------------------
r733 | mdorf | 2014-01-21 11:22:05 -0800 (Tue, 21 Jan 2014) | 1 line

Making collision operators conformal to the restart capabilities
------------------------------------------------------------------------
r732 | mdorr | 2014-01-17 12:40:39 -0800 (Fri, 17 Jan 2014) | 4 lines

Changes to read the mapping files in a new format containing the full poloidal field component rather than just its magnitude.



------------------------------------------------------------------------
r731 | mdorf | 2013-12-16 17:52:45 -0800 (Mon, 16 Dec 2013) | 1 line

Adding capibility to use solutions from the previouse time step as an initial guess for the Rosenbluth potentials; also capibility to evaluate the Rosenbluth potentials only every certain number of time steps
------------------------------------------------------------------------
r730 | mdorr | 2013-12-16 17:38:41 -0800 (Mon, 16 Dec 2013) | 4 lines

Changing physical coordinate derivatives to mapped coordinate derivates and adding second derivatives.



------------------------------------------------------------------------
r729 | mdorf | 2013-12-13 16:38:43 -0800 (Fri, 13 Dec 2013) | 1 line

Adding capibility to compute collision frequency consistent with plasma physical parameters
------------------------------------------------------------------------
r728 | mdorr | 2013-12-09 18:59:50 -0800 (Mon, 09 Dec 2013) | 3 lines

Reverting to previous inflow data filling strategy.


------------------------------------------------------------------------
r727 | mdorr | 2013-12-09 17:13:45 -0800 (Mon, 09 Dec 2013) | 3 lines

Fixing transverse ghost fill in velocity update.


------------------------------------------------------------------------
r726 | jhittinger | 2013-12-06 16:20:14 -0800 (Fri, 06 Dec 2013) | 1 line

Changes to fix codim>1 ghost cells
------------------------------------------------------------------------
r725 | jhittinger | 2013-12-06 15:25:45 -0800 (Fri, 06 Dec 2013) | 1 line

Better handling of inflow conditions
------------------------------------------------------------------------
r724 | jhittinger | 2013-12-06 15:25:15 -0800 (Fri, 06 Dec 2013) | 1 line

Generalized divideJ to be consistent with multJ
------------------------------------------------------------------------
r723 | mdorf | 2013-12-06 10:40:15 -0800 (Fri, 06 Dec 2013) | 1 line

Adding a member function to the FluxSurface class that performs a  flux-surface average in a single-null geometry
------------------------------------------------------------------------
r722 | mdorf | 2013-12-04 17:57:08 -0800 (Wed, 04 Dec 2013) | 1 line

adding a new grid function to describe density and temeprature profiles in a single-null geometry
------------------------------------------------------------------------
r721 | mdorr | 2013-12-03 11:36:59 -0800 (Tue, 03 Dec 2013) | 3 lines

Commiting experimental consistent field boundary condition option.


------------------------------------------------------------------------
r720 | mdorr | 2013-12-03 11:03:43 -0800 (Tue, 03 Dec 2013) | 3 lines

Adding divergence cleaning bc accessors.


------------------------------------------------------------------------
r719 | mdorr | 2013-12-03 10:52:27 -0800 (Tue, 03 Dec 2013) | 3 lines

Adding member to return divergence cleaning solver boundary conditions.


------------------------------------------------------------------------
r718 | mdorr | 2013-12-02 19:55:54 -0800 (Mon, 02 Dec 2013) | 3 lines

Updating input.


------------------------------------------------------------------------
r717 | mdorr | 2013-12-02 19:54:32 -0800 (Mon, 02 Dec 2013) | 3 lines

Adding a levelwise metricTermProductAverage().


------------------------------------------------------------------------
r716 | mdorr | 2013-12-02 19:52:49 -0800 (Mon, 02 Dec 2013) | 3 lines

Fixing velocities.


------------------------------------------------------------------------
r715 | jhittinger | 2013-12-02 10:33:52 -0800 (Mon, 02 Dec 2013) | 1 line


------------------------------------------------------------------------
r714 | jhittinger | 2013-12-02 09:28:51 -0800 (Mon, 02 Dec 2013) | 1 line

Moved BoltzmannElectron
------------------------------------------------------------------------
r713 | jhittinger | 2013-12-01 14:05:44 -0800 (Sun, 01 Dec 2013) | 1 line

Adding new files to 2D SingleNull test case
------------------------------------------------------------------------
r712 | jhittinger | 2013-11-27 15:46:39 -0800 (Wed, 27 Nov 2013) | 1 line

Changes to try to ressurect the 2D SingleNull test case
------------------------------------------------------------------------
r711 | jhittinger | 2013-11-21 17:33:33 -0800 (Thu, 21 Nov 2013) | 1 line

Fix interface change to ARK4
------------------------------------------------------------------------
r710 | mdorr | 2013-11-08 17:43:34 -0800 (Fri, 08 Nov 2013) | 3 lines

Switching m_phase_geom instance from pointer to reference when USE_ARK4 is undefined.


------------------------------------------------------------------------
r709 | jhittinger | 2013-11-07 16:18:38 -0800 (Thu, 07 Nov 2013) | 1 line

Refactored Poisson classes to move mass and charge density up into GKOps
------------------------------------------------------------------------
r708 | mdorr | 2013-10-25 11:38:54 -0700 (Fri, 25 Oct 2013) | 3 lines

Fixing blockRemapping.


------------------------------------------------------------------------
r707 | mdorr | 2013-10-24 13:05:11 -0700 (Thu, 24 Oct 2013) | 3 lines

Fixing reference/pointer switch in GKPoisson argument when not using ARK4.


------------------------------------------------------------------------
r706 | mdorr | 2013-10-23 15:17:42 -0700 (Wed, 23 Oct 2013) | 3 lines

Fixing BStarParallel division in distribution function diagnostics.


------------------------------------------------------------------------
r705 | mdorr | 2013-10-21 10:43:21 -0700 (Mon, 21 Oct 2013) | 3 lines

Caching magnetic field data to avoid their recalculation during the construction of the GKPoisson operator coefficients.


------------------------------------------------------------------------
r704 | mdorr | 2013-10-18 12:57:46 -0700 (Fri, 18 Oct 2013) | 3 lines

Fixing input limiter switch.


------------------------------------------------------------------------
r703 | mdorr | 2013-10-10 16:58:45 -0700 (Thu, 10 Oct 2013) | 3 lines

Removing unnecessary ghost cell from magnetic field correction.


------------------------------------------------------------------------
r702 | mdorr | 2013-10-10 11:01:35 -0700 (Thu, 10 Oct 2013) | 3 lines

Changing the number of interpolated extrablock density ghost cells to 2.


------------------------------------------------------------------------
r701 | mdorr | 2013-10-09 18:02:42 -0700 (Wed, 09 Oct 2013) | 3 lines

Updating input files to be consistent with solver changes.


------------------------------------------------------------------------
r700 | mdorr | 2013-10-09 18:01:56 -0700 (Wed, 09 Oct 2013) | 3 lines

More solver refactoring to facilitate Neoclassical transport tests.


------------------------------------------------------------------------
r699 | jhittinger | 2013-10-04 18:04:28 -0700 (Fri, 04 Oct 2013) | 1 line

Added ARK(3)6l[2]SA time integrator
------------------------------------------------------------------------
r698 | mdorr | 2013-09-26 13:13:05 -0700 (Thu, 26 Sep 2013) | 3 lines

Adding code to supply field data for the new grid generator.


------------------------------------------------------------------------
r697 | mdorf | 2013-08-29 17:20:11 -0700 (Thu, 29 Aug 2013) | 1 line

Updating FP collision operator (adding multopole BCs, etc)
------------------------------------------------------------------------
r696 | mdorr | 2013-08-28 15:24:21 -0700 (Wed, 28 Aug 2013) | 3 lines

Updating input file.


------------------------------------------------------------------------
r695 | mdorr | 2013-08-28 15:22:18 -0700 (Wed, 28 Aug 2013) | 3 lines

Updating input file (adding localized floor parameter and radial bc specification).


------------------------------------------------------------------------
r694 | mdorr | 2013-08-20 15:05:43 -0700 (Tue, 20 Aug 2013) | 3 lines

Updating this regression test input file.


------------------------------------------------------------------------
r693 | mdorr | 2013-08-19 10:53:25 -0700 (Mon, 19 Aug 2013) | 4 lines

Fixing the gam regression test input file.



------------------------------------------------------------------------
r692 | mdorr | 2013-08-17 18:55:53 -0700 (Sat, 17 Aug 2013) | 3 lines

Adding Mikhail's test input files.


------------------------------------------------------------------------
r691 | mdorr | 2013-08-17 14:34:05 -0700 (Sat, 17 Aug 2013) | 5 lines

Fixing test for simultaneous specification of kinetic and Boltzmann electrons.
Fixing plotting.
Adding refactored field solve.


------------------------------------------------------------------------
r690 | jhittinger | 2013-08-09 18:33:18 -0700 (Fri, 09 Aug 2013) | 1 line

Hopefully fixing the repo by checking in the missing GKOps class files
------------------------------------------------------------------------
r689 | jhittinger | 2013-07-31 14:47:31 -0700 (Wed, 31 Jul 2013) | 1 line

First step in splitting out GK Operator class for ARK integrator
------------------------------------------------------------------------
r688 | jhittinger | 2013-06-28 10:42:23 -0700 (Fri, 28 Jun 2013) | 1 line

hypre doinstall now makes soft link
------------------------------------------------------------------------
r687 | jhittinger | 2013-06-28 10:41:46 -0700 (Fri, 28 Jun 2013) | 1 line

Release notes
------------------------------------------------------------------------
r685 | mdorf | 2013-04-29 15:21:45 -0700 (Mon, 29 Apr 2013) | 1 line

Initial working version of the Fokker Plank collision operator (more debugging, testing, and  optimization is still needed)
------------------------------------------------------------------------
r684 | mdorr | 2013-04-15 15:55:58 -0700 (Mon, 15 Apr 2013) | 3 lines

Adding multigrid preconditioned PCG solve to parallel collision module. 


------------------------------------------------------------------------
r683 | mdorr | 2013-04-12 16:56:01 -0700 (Fri, 12 Apr 2013) | 2 lines

Adding support for parallel solves needed by collision operators.

------------------------------------------------------------------------
r682 | mdorr | 2013-03-06 11:30:18 -0800 (Wed, 06 Mar 2013) | 3 lines

Fixing unit normals at face centers.


------------------------------------------------------------------------
r681 | mdorr | 2013-03-03 11:59:55 -0800 (Sun, 03 Mar 2013) | 3 lines

Fixing ncomp in phase_block_project.


------------------------------------------------------------------------
r680 | mdorr | 2013-03-01 15:04:30 -0800 (Fri, 01 Mar 2013) | 3 lines

Fixing number of components in the mag_block_project subroutine.


------------------------------------------------------------------------
r679 | mdorf | 2013-02-27 14:35:39 -0800 (Wed, 27 Feb 2013) | 1 line

Adding poloidal momentum diagnostics
------------------------------------------------------------------------
r678 | ligocki | 2013-02-23 11:24:15 -0800 (Sat, 23 Feb 2013) | 2 lines

Changed tabs to spaces...

------------------------------------------------------------------------
r677 | mdorr | 2013-02-22 18:59:08 -0800 (Fri, 22 Feb 2013) | 3 lines

Fixing unit vector calculations and adding gradF factor.


------------------------------------------------------------------------
r676 | mdorr | 2013-02-22 16:40:29 -0800 (Fri, 22 Feb 2013) | 3 lines

changing mapping file


------------------------------------------------------------------------
r675 | mdorr | 2013-02-22 16:16:47 -0800 (Fri, 22 Feb 2013) | 3 lines

Adding new single null geometry mapping.


------------------------------------------------------------------------
r674 | mdorr | 2013-02-22 16:00:59 -0800 (Fri, 22 Feb 2013) | 3 lines

Adding projection routines for Mikhail's diagnostics.


------------------------------------------------------------------------
r673 | jhittinger | 2013-02-22 12:49:01 -0800 (Fri, 22 Feb 2013) | 1 line

Fixed the Banks limited face averages
------------------------------------------------------------------------
r672 | jhittinger | 2013-02-22 08:06:28 -0800 (Fri, 22 Feb 2013) | 1 line

Fixed radial BC inflow function bug
------------------------------------------------------------------------
r671 | ligocki | 2013-02-18 16:27:32 -0800 (Mon, 18 Feb 2013) | 2 lines

Fixed Hypre build scripts to work with this version of Hypre...

------------------------------------------------------------------------
r670 | mdorr | 2013-02-16 14:20:18 -0800 (Sat, 16 Feb 2013) | 3 lines

New input files.


------------------------------------------------------------------------
r669 | mdorr | 2013-02-16 13:37:58 -0800 (Sat, 16 Feb 2013) | 3 lines

Commiting hypre-2.9.0b.


------------------------------------------------------------------------
r668 | mdorr | 2013-02-16 13:20:24 -0800 (Sat, 16 Feb 2013) | 3 lines

Changing hypre path to hypre-2.9.0b.


------------------------------------------------------------------------
r667 | mdorr | 2013-02-16 13:11:32 -0800 (Sat, 16 Feb 2013) | 9 lines

Added solver to correct field divergence (requires newest version of hypre).
Fixed flux matching at block boundaries.
Removed "rotate-only" option from getPointwiseN().
Added option to rotate vectors to the mapped configuration space frame.
Added boundary condition classes for the SNCore geometry.
Added option to use the B field as the velocity for testing purposes.
Removed more tabs.


------------------------------------------------------------------------
r666 | mdorf | 2013-02-06 17:05:17 -0800 (Wed, 06 Feb 2013) | 1 line

Revised Collision classes so that they conform to new BC and IC treatment
------------------------------------------------------------------------
r665 | jhittinger | 2013-01-23 17:27:39 -0800 (Wed, 23 Jan 2013) | 1 line

Possibly working Krook operator
------------------------------------------------------------------------
r664 | jhittinger | 2013-01-22 14:20:31 -0800 (Tue, 22 Jan 2013) | 1 line

Adding krook collision operator test
------------------------------------------------------------------------
r663 | jhittinger | 2013-01-22 14:19:40 -0800 (Tue, 22 Jan 2013) | 1 line

fixed some bugs in the Boltzmann initialization that crept in with the new ICs
------------------------------------------------------------------------
r662 | jhittinger | 2013-01-18 17:01:04 -0800 (Fri, 18 Jan 2013) | 1 line

Revised Collision classes so that they conform to new BC and IC treatment
------------------------------------------------------------------------
r661 | ligocki | 2012-12-18 11:11:00 -0800 (Tue, 18 Dec 2012) | 4 lines

Changed tabs to spaces - "gfortran" gets unhappy with ".f" made from ".ChF"
files with tabs.  Fixed a few "char*" to "const char*" to get rid of compiler
warnings...

------------------------------------------------------------------------
r660 | mdorr | 2012-12-18 09:04:33 -0800 (Tue, 18 Dec 2012) | 2 lines

Adding missing files.

------------------------------------------------------------------------
r659 | mdorr | 2012-12-17 13:09:24 -0800 (Mon, 17 Dec 2012) | 3 lines

Adding MagGeom class (derived from MultiBlockLevelGeom) as the base class for all magnetic geometries.


------------------------------------------------------------------------
r658 | ligocki | 2012-12-04 12:09:53 -0800 (Tue, 04 Dec 2012) | 3 lines

Removed tabs (and trailing spaces) from code.  In some cases, the tabs were
cause the Fortran compilation with 'gfortran' to fail...

------------------------------------------------------------------------
r657 | mdorr | 2012-12-03 15:17:03 -0800 (Mon, 03 Dec 2012) | 2 lines

Making axisymmetry explicit.

------------------------------------------------------------------------
r656 | mdorr | 2012-12-03 15:16:31 -0800 (Mon, 03 Dec 2012) | 3 lines

Making radial boundary periodic.
Making axisymmetry explicit.

------------------------------------------------------------------------
r655 | mdorr | 2012-12-03 15:15:19 -0800 (Mon, 03 Dec 2012) | 19 lines

Corrections to preserve free streaming in axisymmetric geometry.

Axisymmetry corrections to the J factors used in initial and boundary condition setting.

Refactor GKPoisson to compute coefficients at cell face centers and then convert to face averages.

Added check to prevent constant minor radius option to be specified with non-periodic radial boundaries.

Removed interpolation order arguments from MultiBlockLevelGeom define()s.

Added free stream test velocity.

Removed option to include NTranspose in velocity calculation.

Added volume and J to plotting of configuration data.

Added member to PhaseGeom to compute mapped velocities.


------------------------------------------------------------------------
r654 | mdorr | 2012-11-02 12:21:20 -0700 (Fri, 02 Nov 2012) | 7 lines

Adding option to plot the Vlasov divergence operator applied to the initial condition.

Fixing the OMIT_NT flag in the call to compute velocities in GKVlasov::evalRHS().

Removing no longer needed MultiBlockLevelExchange stuff from GKVlasov.


------------------------------------------------------------------------
r653 | mdorr | 2012-10-30 16:33:50 -0700 (Tue, 30 Oct 2012) | 2 lines

Checking in new GAM input file.

------------------------------------------------------------------------
r652 | mdorr | 2012-10-30 16:30:52 -0700 (Tue, 30 Oct 2012) | 3 lines

Fixing regression test input files.


------------------------------------------------------------------------
r651 | mdorr | 2012-10-30 16:23:12 -0700 (Tue, 30 Oct 2012) | 9 lines

Finished SNCore geometry (completed the connection of the 2 blocks near the X point.

Fixed defaulted RK stage number in GKSystem::computeElectricField()

Added missing mass in MaxwellianKineticFunctionF.ChF

Centered the cosine function defined in Cosine.cpp at the middle flux surface


------------------------------------------------------------------------
r650 | mdorr | 2012-10-25 10:29:51 -0700 (Thu, 25 Oct 2012) | 3 lines

Commenting out deletes of reference counted pointers.


------------------------------------------------------------------------
r649 | mdorr | 2012-10-25 09:27:53 -0700 (Thu, 25 Oct 2012) | 3 lines

Replacing protected BlockBoundary::BOUNDARY with 0


------------------------------------------------------------------------
r648 | jhittinger | 2012-10-24 18:15:40 -0700 (Wed, 24 Oct 2012) | 1 line

Fixed issue with block boundary assignment
------------------------------------------------------------------------
r647 | jhittinger | 2012-10-23 17:33:56 -0700 (Tue, 23 Oct 2012) | 1 line

Merging jafh-ibc branch (r585) into the trunk.  This brings in the new IC/BC functionality but breaks the collisions, transport, and new SNCore coords.
------------------------------------------------------------------------
r634 | mdorr | 2012-10-12 17:22:19 -0700 (Fri, 12 Oct 2012) | 7 lines

Adding a new SNCore geometry consisting of just the core region of the single null.  This isn't quite working yet; awaiting a modification of MultiBlockLevelExchange.

Added a 2d test code for the SNCore geometry.

Fixed a bug in the field calculation on more than one block.


------------------------------------------------------------------------
r633 | mdorr | 2012-09-18 10:36:50 -0700 (Tue, 18 Sep 2012) | 3 lines

Restoring the option to compute the phase space mapped grid divergence the standard way, rather than assuming that the velocity factor in the flux has already been premultiplied by NTranspose.  The previous version, in which NTranspose is applied as part of the evaluation of the velocity at face centers, loses free-stream preservation.  The previous version is still the default, but needs to be changed.


------------------------------------------------------------------------
r632 | ligocki | 2012-09-13 14:22:03 -0700 (Thu, 13 Sep 2012) | 2 lines

Restoring this file used for regression testing (this may be temporary)...

------------------------------------------------------------------------
r631 | angus1 | 2012-09-11 19:43:33 -0700 (Tue, 11 Sep 2012) | 2 lines

Updating transport models

------------------------------------------------------------------------
r630 | angus1 | 2012-09-11 19:39:57 -0700 (Tue, 11 Sep 2012) | 2 lines

Added new kernel to compute perp pressure

------------------------------------------------------------------------
r629 | angus1 | 2012-09-11 19:37:37 -0700 (Tue, 11 Sep 2012) | 2 lines

Adding new collision operator

------------------------------------------------------------------------
r628 | mdorr | 2012-09-10 15:17:56 -0700 (Mon, 10 Sep 2012) | 2 lines

Fixing the injection of configuration space into phase space so that all ghost cells at block boundaries are also injected (using Dan's latest extension of SpreadingCopier).

------------------------------------------------------------------------
r627 | mdorr | 2012-09-10 15:15:46 -0700 (Mon, 10 Sep 2012) | 2 lines

Adding multiplicatin by BStarParallel to the initialization of the localized IBC in order to be consistent with the other IBC types.

------------------------------------------------------------------------
r626 | mdorr | 2012-09-10 15:14:34 -0700 (Mon, 10 Sep 2012) | 2 lines

Removing data file from repo.

------------------------------------------------------------------------
r625 | angus1 | 2012-09-07 16:00:16 -0700 (Fri, 07 Sep 2012) | 2 lines

Included ability to plot Temperature and the 4thMoment of the Distribution function

------------------------------------------------------------------------
r624 | angus1 | 2012-09-07 15:57:58 -0700 (Fri, 07 Sep 2012) | 2 lines

Added a new Kernel to compute the 4th velocity space moment of the distribution function. Also added a 4thMoment and a Temperature object to Kinetic Species.

------------------------------------------------------------------------
r623 | mdorr | 2012-09-06 15:37:54 -0700 (Thu, 06 Sep 2012) | 2 lines

Changing USE_MPI to CH_MPI

------------------------------------------------------------------------
r622 | mdorr | 2012-09-06 11:08:19 -0700 (Thu, 06 Sep 2012) | 2 lines

Fixing (at least partially) the serial option.

------------------------------------------------------------------------
r621 | ligocki | 2012-09-05 15:54:14 -0700 (Wed, 05 Sep 2012) | 2 lines

Mapping file for regression testing...

------------------------------------------------------------------------
r620 | ligocki | 2012-09-05 15:53:41 -0700 (Wed, 05 Sep 2012) | 2 lines

Added regression testing input files...

------------------------------------------------------------------------
r619 | mdorr | 2012-09-05 14:48:04 -0700 (Wed, 05 Sep 2012) | 2 lines

Removing unnecessary checks on the number of processors.

------------------------------------------------------------------------
r618 | ligocki | 2012-09-04 18:54:15 -0700 (Tue, 04 Sep 2012) | 4 lines

Added serial, optimized scripts and fixed the setting of "debug" on the
parallel, optimized configure - it was being set to "--enable-debug" and now
it's being set to "--enable-opt"...

------------------------------------------------------------------------
r617 | ligocki | 2012-09-04 18:16:41 -0700 (Tue, 04 Sep 2012) | 2 lines

Trying this out for regression testing...

------------------------------------------------------------------------
r616 | ligocki | 2012-09-04 15:49:16 -0700 (Tue, 04 Sep 2012) | 2 lines

Additional scripts to help with regression testing...

------------------------------------------------------------------------
r615 | ligocki | 2012-09-04 15:39:48 -0700 (Tue, 04 Sep 2012) | 2 lines

Made executable under SVN...

------------------------------------------------------------------------
r614 | petermc | 2012-08-30 16:39:19 -0700 (Thu, 30 Aug 2012) | 2 lines

incorporate change in MultiBlockLevelExchange interface

------------------------------------------------------------------------
r613 | angus1 | 2012-08-21 18:06:40 -0700 (Tue, 21 Aug 2012) | 1 line


------------------------------------------------------------------------
r612 | jhittinger | 2012-08-17 09:58:52 -0700 (Fri, 17 Aug 2012) | 1 line

Fix to input file
------------------------------------------------------------------------
r611 | jhittinger | 2012-08-14 15:23:09 -0700 (Tue, 14 Aug 2012) | 1 line

Renamed src/FEI_mv/fei-hypre/HYPRE_fei_mv.h to avoid svn collision on macs.
------------------------------------------------------------------------
r610 | mdorr | 2012-08-14 14:28:36 -0700 (Tue, 14 Aug 2012) | 2 lines

Getting rid of move script.  Fixing relative path to hypre_loc link.

------------------------------------------------------------------------
r609 | mdorr | 2012-08-10 13:44:11 -0700 (Fri, 10 Aug 2012) | 2 lines

Modification to pick up HO geometry libs.

------------------------------------------------------------------------
r608 | mdorf | 2012-08-09 17:37:31 -0700 (Thu, 09 Aug 2012) | 1 line

Initial dfn is multiplied by a J factor to match the recent changes in the IBC class
------------------------------------------------------------------------
r607 | mdorf | 2012-08-09 17:37:21 -0700 (Thu, 09 Aug 2012) | 1 line

Initial dfn is multiplied by a J factor to match the recent changes in the IBC class
------------------------------------------------------------------------
r606 | mdorf | 2012-08-09 17:37:12 -0700 (Thu, 09 Aug 2012) | 1 line

Initial dfn is multiplied by a J factor to match the recent changes in the IBC class
------------------------------------------------------------------------
r605 | angus1 | 2012-08-08 16:56:03 -0700 (Wed, 08 Aug 2012) | 4 lines

Anomalous.cpp and Anomalous.H somehow didn't get added the firs time...adding now and deleting files not needed.



------------------------------------------------------------------------
r604 | angus1 | 2012-08-08 16:29:42 -0700 (Wed, 08 Aug 2012) | 3 lines

Updated transport Models


------------------------------------------------------------------------
r603 | angus1 | 2012-08-08 16:28:47 -0700 (Wed, 08 Aug 2012) | 3 lines

Bringing back the original Localized ibc and ic (fB is gaussian in each dimension) and naming it gaussian to distinguish between new localized ibc and ic which does cos()^8.


------------------------------------------------------------------------
r602 | angus1 | 2012-08-08 16:26:01 -0700 (Wed, 08 Aug 2012) | 3 lines

Updated GKSystem.cpp to include new transport function header file and to compare stable time step from collisions and vlasov with stable time step from transport models and return the minimum.


------------------------------------------------------------------------
r601 | angus1 | 2012-08-08 16:24:18 -0700 (Wed, 08 Aug 2012) | 4 lines


Added new function to compute mapped cell averaged divergence by accepting fluxes that contain the same number of component on each cell face as the output divergence has in cell centers. Moreover, the output does not need to be divided by cell volume like the output from MappedGridDivergenceWithoutNT() does.


------------------------------------------------------------------------
r600 | mdorf | 2012-08-06 13:21:51 -0700 (Mon, 06 Aug 2012) | 1 line

Adding Vpar, PartFlux, and HeatFlux diagnostics plotting
------------------------------------------------------------------------
r599 | mdorf | 2012-08-06 13:21:44 -0700 (Mon, 06 Aug 2012) | 1 line

Adding Vpar, PartFlux, and HeatFlux diagnostics plotting
------------------------------------------------------------------------
r598 | mdorr | 2012-08-06 12:16:30 -0700 (Mon, 06 Aug 2012) | 2 lines

Turning coordinate system checks back on.

------------------------------------------------------------------------
r597 | mdorr | 2012-08-06 12:15:14 -0700 (Mon, 06 Aug 2012) | 2 lines

Changing number of precomputed Newton initial conditions.

------------------------------------------------------------------------
r596 | mdorr | 2012-08-03 12:29:45 -0700 (Fri, 03 Aug 2012) | 2 lines

Turning off coordinate system debugging checks.

------------------------------------------------------------------------
r595 | angus1 | 2012-07-17 18:02:05 -0700 (Tue, 17 Jul 2012) | 3 lines

I have added a new directory ./src/transport that contains the files for the transport models. I also included this path in the GNUmakefile.multidim file so that it will be found when compiling. GKSystem.cpp and GKSystem.H has been modified to call the transport operator for the RHS calculation when the transport model is turned on. The transport model is turned on by placing a "true" statement in the input file. If this statement is not in the input file, then the transport model is not even called during RHS calculation. The model is by no means ready to use. I just wanted to get the basic coding checked in so I do not have to repeat it in the future.


------------------------------------------------------------------------
r594 | dmartin | 2012-07-09 14:45:00 -0700 (Mon, 09 Jul 2012) | 3 lines

changes to make this compile in the new world order...


------------------------------------------------------------------------
r592 | mdorr | 2012-06-19 15:45:43 -0700 (Tue, 19 Jun 2012) | 3 lines


Modifying Newton initital iterates.

------------------------------------------------------------------------
r591 | mdorr | 2012-06-19 15:35:08 -0700 (Tue, 19 Jun 2012) | 2 lines

Added option to read velocity from input.

------------------------------------------------------------------------
r590 | mdorr | 2012-06-18 10:10:36 -0700 (Mon, 18 Jun 2012) | 2 lines

Removing (commented out) references to example/fourthOrderMappedGrids.

------------------------------------------------------------------------
r589 | mdorr | 2012-06-18 10:09:50 -0700 (Mon, 18 Jun 2012) | 2 lines

Removing (commented out) references to example/fourthOrderMappedGrids.

------------------------------------------------------------------------
r588 | mdorr | 2012-06-13 16:15:57 -0700 (Wed, 13 Jun 2012) | 2 lines

Fixing initial prefactor calculation to use a consistent charge density.

------------------------------------------------------------------------
r587 | mdorr | 2012-06-12 15:42:21 -0700 (Tue, 12 Jun 2012) | 2 lines

Adding L1 and L2 error norm calculations.

------------------------------------------------------------------------
r586 | mdorr | 2012-06-12 15:41:45 -0700 (Tue, 12 Jun 2012) | 2 lines

Adding option to control the distance between the blocks in global index space, which was needed in order to use coarser grids.

------------------------------------------------------------------------
r584 | mdorr | 2012-06-06 12:15:48 -0700 (Wed, 06 Jun 2012) | 2 lines

Adding missing Z factor to polarization density.

------------------------------------------------------------------------
r583 | mdorr | 2012-06-06 11:33:23 -0700 (Wed, 06 Jun 2012) | 2 lines

Removing the divide by J prior to the density calculation for the Boltzmann prefactor, since we are no longer saving the J factor with the distribution function initial conditions.

------------------------------------------------------------------------
r582 | dmartin | 2012-05-21 14:33:12 -0700 (Mon, 21 May 2012) | 4 lines

makefile changes corresponding to new Chombo mapped-grid and HO libraries (no longer point to Chombo/example, the moveToBoxTools.sh script is *gone*!.

Milo may want to mark this day on his calendar and commemorate it every year...

------------------------------------------------------------------------
r581 | dmartin | 2012-05-21 14:30:29 -0700 (Mon, 21 May 2012) | 3 lines

removing configure-generated files from version control


------------------------------------------------------------------------
r580 | dmartin | 2012-05-21 14:26:09 -0700 (Mon, 21 May 2012) | 3 lines

moving advection utility stuff over from Chombo/example/fourthOrderMappedGrids/advection to live under COGENT for now, since it's apparently the only one actually using this stuff. This will hopefully be a temporary home for at least some of this (the mapped limiter, for example) before being moved back to a more generally-accessible location


------------------------------------------------------------------------
r579 | mdorr | 2012-05-08 21:06:59 -0700 (Tue, 08 May 2012) | 2 lines

Renaming esl.cpp to cogent.cpp and changing all the esls to cogent in the makefiles.  It's good to finally be able to invoke the code by it's proper name.

------------------------------------------------------------------------
r578 | mdorr | 2012-05-08 20:12:46 -0700 (Tue, 08 May 2012) | 2 lines

Modifying the path to the hypre_loc link, which is now one directory level lower since hypre is now under COGENT.

------------------------------------------------------------------------
r577 | mdorr | 2012-05-08 09:02:39 -0700 (Tue, 08 May 2012) | 4 lines

Fixing rotate_only=true branch of updateVelocities() to also perform second-order extrapolation in the velocity coordinate directions.

Fixing plotAtVelocityIndex(LD<FluxBox>) to include the velocity coordinate directions in the averaging to cell centers.

------------------------------------------------------------------------
r576 | mdorr | 2012-05-08 08:59:18 -0700 (Tue, 08 May 2012) | 2 lines

Adding accessor to report whether or not the geometry is axisymmetric.

------------------------------------------------------------------------
r575 | mdorr | 2012-05-08 08:56:05 -0700 (Tue, 08 May 2012) | 2 lines

Modification to get cell-centered physical coordinates in an FArrayBox rather than cell by cell.

------------------------------------------------------------------------
r574 | mdorr | 2012-05-08 08:52:04 -0700 (Tue, 08 May 2012) | 2 lines

Updating stable dt diagnostic to also report which coordinate direction makes the largest contribution.

------------------------------------------------------------------------
r573 | mdorr | 2012-05-03 14:42:41 -0700 (Thu, 03 May 2012) | 2 lines

Updates to 2d singlenull test.

------------------------------------------------------------------------
r572 | mdorr | 2012-04-30 15:13:12 -0700 (Mon, 30 Apr 2012) | 2 lines

Tweaking the stable dt calculation once again, this time to actually agree with equation (79) in our JCP paper.  Added a diagnostic to plot the stable dt (at the velocity coordinate of the actual limiting cell) as a function of the spatial variable.

------------------------------------------------------------------------
r571 | mdorr | 2012-04-13 00:16:54 -0700 (Fri, 13 Apr 2012) | 2 lines

Adding mapped coordinate to stable dt diagnostic.

------------------------------------------------------------------------
r570 | mdorr | 2012-04-06 13:38:27 -0700 (Fri, 06 Apr 2012) | 2 lines

Adding some diagnostics for the stable dt calculation.

------------------------------------------------------------------------
r569 | mdorr | 2012-04-05 21:32:48 -0700 (Thu, 05 Apr 2012) | 2 lines

Replacing the MayDay::Warning about no collision operator with a less alarming if(procID()==0) {cout << ...} message.

------------------------------------------------------------------------
r568 | mdorr | 2012-04-05 21:29:38 -0700 (Thu, 05 Apr 2012) | 2 lines

Adding functions to compute the physical cell face averages for the configuration and velocity space geometries, and a function to multiply by them in the phase space geometry.

------------------------------------------------------------------------
r567 | mdorr | 2012-04-05 21:27:14 -0700 (Thu, 05 Apr 2012) | 2 lines

Replacing multJ by multJonValid in LocSpatialIBC.

------------------------------------------------------------------------
r566 | mdorr | 2012-04-05 21:24:40 -0700 (Thu, 05 Apr 2012) | 2 lines

Replacing computational cell face averages with physical space cell averages in computeMappedDt().

------------------------------------------------------------------------
r565 | mdorr | 2012-04-04 13:13:11 -0700 (Wed, 04 Apr 2012) | 2 lines

Making a performance enhancement to the phase space interpGhosts().

------------------------------------------------------------------------
r564 | mdorr | 2012-04-04 11:18:20 -0700 (Wed, 04 Apr 2012) | 2 lines

Workaround fix for phase space multiblock level exchange problem with velocity decomposed phase space.

------------------------------------------------------------------------
r563 | mdorr | 2012-03-28 13:28:23 -0700 (Wed, 28 Mar 2012) | 2 lines

Fixing Miller non-periodic radial block boundary tags.

------------------------------------------------------------------------
r562 | mdorr | 2012-03-28 13:01:49 -0700 (Wed, 28 Mar 2012) | 2 lines

Fixing Miller non-periodic radial block boundary tags.

------------------------------------------------------------------------
r561 | mdorr | 2012-03-28 11:14:24 -0700 (Wed, 28 Mar 2012) | 2 lines

Modified blockRemapping().

------------------------------------------------------------------------
r560 | dmartin | 2012-03-20 14:52:59 -0700 (Tue, 20 Mar 2012) | 2 lines

removed definition of LAPACKLIBS variable, since it should be defined in Make.defs.local

------------------------------------------------------------------------
r559 | jhittinger | 2012-02-14 09:54:41 -0800 (Tue, 14 Feb 2012) | 2 lines

A few missing changes

------------------------------------------------------------------------
r558 | jhittinger | 2012-02-14 09:41:34 -0800 (Tue, 14 Feb 2012) | 2 lines

Eliminated SpeciesModel, which removed most RTTI calls.  This required a reworking of the cyclical dependence of KineticSpecies on CLSInterface and vice versa.  Collisions were reworked into the GKCollision operator class, but this needs to be debugged to ensure that functionality was not lost.

------------------------------------------------------------------------
r557 | jhittinger | 2012-02-12 19:08:36 -0800 (Sun, 12 Feb 2012) | 2 lines

Completed initial condition classes with tests

------------------------------------------------------------------------
r556 | mdorr | 2012-02-10 12:47:30 -0800 (Fri, 10 Feb 2012) | 2 lines

Printing out domain boxes for each single null block.

------------------------------------------------------------------------
r555 | mdorr | 2012-02-07 14:57:52 -0800 (Tue, 07 Feb 2012) | 2 lines

Adding single null and fake x point input and mapping files.

------------------------------------------------------------------------
r554 | mdorr | 2012-02-07 14:56:39 -0800 (Tue, 07 Feb 2012) | 6 lines

Added utility functions to PhaseGeom to multiply or divide by J on an arbitrary box.  This will be needed for the new boundary condition strategy.

Updated many loops over blocks to use the PhaseGeom accessor that returns the block phase space coord system given a box.

Modified phase space LocalizedIBC to work correctly with multiblock.  The interface has now also been changed to require the blob center to be defined in terms of (R,Z,vp,mu) coordinates rather than (phi,theta,vp,mu).  This will all be replaced when the new bc refactorization is complete, but gives us something to use in the meantime.

------------------------------------------------------------------------
r553 | dmartin | 2012-02-02 12:12:49 -0800 (Thu, 02 Feb 2012) | 2 lines

gfortran on hopper doesn't like tabs. also removed a couple of semicolons)

------------------------------------------------------------------------
r552 | mdorr | 2012-01-31 16:01:16 -0800 (Tue, 31 Jan 2012) | 2 lines

Changing PhaseIBC::ghostCellIBC() to fill ghosts without the J factor.  A few other minor cleanups as well.

------------------------------------------------------------------------
r551 | mdorr | 2012-01-30 17:35:33 -0800 (Mon, 30 Jan 2012) | 2 lines

Adding check on number of blocks to avoid interGhost() set up and execution when there is only one block.

------------------------------------------------------------------------
r550 | mdorr | 2012-01-30 17:34:08 -0800 (Mon, 30 Jan 2012) | 2 lines

Undefining JAFH

------------------------------------------------------------------------
r549 | jhittinger | 2012-01-27 15:48:31 -0800 (Fri, 27 Jan 2012) | 2 lines

Partial implementation of IC classes with tests; forced to commit due to repo change to svn

------------------------------------------------------------------------
r548 | mdorr | 2012-01-27 13:26:40 -0800 (Fri, 27 Jan 2012) | 2 lines

Add one last time...

------------------------------------------------------------------------
r547 | mdorr | 2012-01-27 13:19:28 -0800 (Fri, 27 Jan 2012) | 2 lines

Syncing with repo before svn move.

------------------------------------------------------------------------
r546 | mdorr | 2012-01-27 13:09:34 -0800 (Fri, 27 Jan 2012) | 2 lines

Syncing with repo before svn move.

------------------------------------------------------------------------
r545 | mdorr | 2012-01-27 12:53:19 -0800 (Fri, 27 Jan 2012) | 2 lines

Syncing lastest version with repo before svn move.  Changes include PhaseGeom::interpGhost() member that loops over velocity indices and performs 2D MBLevelExchanges in the magnetic coordinates only.  Removed some static casting.

------------------------------------------------------------------------
r544 | mdorr | 2012-01-26 14:22:27 -0800 (Thu, 26 Jan 2012) | 2 lines

Removing carriage returns.

------------------------------------------------------------------------
r543 | mdorf | 2011-12-20 16:47:04 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding an empty class for colisionless species

------------------------------------------------------------------------
r542 | mdorf | 2011-12-20 16:46:24 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding the empty collision class for collisionless species

------------------------------------------------------------------------
r541 | mdorf | 2011-12-20 16:45:33 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding the Lorentz class that computes the Lorentz operator

------------------------------------------------------------------------
r540 | mdorf | 2011-12-20 16:44:27 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding the Linearized class that computes the Linearized model collision operator

------------------------------------------------------------------------
r539 | mdorf | 2011-12-20 16:42:58 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding the Krook class that computes the Krook operator

------------------------------------------------------------------------
r538 | mdorf | 2011-12-20 16:42:21 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding the Krook class that computes the Krook collision operator

------------------------------------------------------------------------
r537 | mdorf | 2011-12-20 16:41:22 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding fortran routines used by collision classes

------------------------------------------------------------------------
r536 | mdorf | 2011-12-20 16:39:26 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding the CLSInterface class (analogous to IBCInterface class)

------------------------------------------------------------------------
r535 | mdorf | 2011-12-20 16:36:47 -0800 (Tue, 20 Dec 2011) | 2 lines

Define accumulateRHS method

------------------------------------------------------------------------
r534 | mdorf | 2011-12-20 16:34:39 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding collision model to the KineticSpecies class

------------------------------------------------------------------------
r533 | mdorf | 2011-12-20 16:31:42 -0800 (Tue, 20 Dec 2011) | 2 lines

Adding model collision opperators

------------------------------------------------------------------------
r532 | mdorr | 2011-12-13 10:55:38 -0800 (Tue, 13 Dec 2011) | 2 lines

Fixing the stdout diagnostic that reports the assignment of boxes to processes.

------------------------------------------------------------------------
r531 | dmartin | 2011-12-07 23:05:44 -0800 (Wed, 07 Dec 2011) | 2 lines

more tweaking

------------------------------------------------------------------------
r530 | dmartin | 2011-12-07 22:55:06 -0800 (Wed, 07 Dec 2011) | 2 lines

switch to mpif77

------------------------------------------------------------------------
r529 | dmartin | 2011-12-07 22:47:42 -0800 (Wed, 07 Dec 2011) | 2 lines

add mpi-enabled config script for ANAG machines

------------------------------------------------------------------------
r528 | mdorr | 2011-11-18 16:19:50 -0800 (Fri, 18 Nov 2011) | 6 lines

-Activating new strategy for finding the valid single null block for a given computational coordinate.

-Now printing out the number of ghost cells for each phase space block

-Changing the specification of the number of domains across the poloidal direction of the core and central scrape-off regions.

------------------------------------------------------------------------
r527 | mdorr | 2011-11-18 12:01:53 -0800 (Fri, 18 Nov 2011) | 2 lines

Changes necessitated by the geometry class refactoring.

------------------------------------------------------------------------
r526 | mdorr | 2011-11-18 11:59:41 -0800 (Fri, 18 Nov 2011) | 11 lines

Overdue merge of my latest branch:

- Added new classes to implement (and encapsulate from each other) the various geometry mapping interpolation options (Hermite,spline,bspline).
- Added code to generate single null field data from the geometry mapping file (created from gridue data)
- More refactoring of geometry classes to better associate functionality with specific geometries (e.g., radial spreading is only available for the Miller geometry) and consolidate common functionality in the base classes.
- Moved reading of block data from GKSystem to the respective geometry classes.
- Began implementation of new way of computing valid blocks from computational grid points (not yet fully tested and therefore still #ifdefed out).
- Added phase coordinate system (MultiBlockCoordSys) base class, from which MillerPhaseCoordSys and SingleNullPhaseCoordSys are now derived.
- Removed Windows-induced carriage returns from various files
- Changed defines of MultiBlockLevelGeoms to the define() interface that includes the interpolation order (to better ensure the correct number of ghost cells are specified).

------------------------------------------------------------------------
r525 | jcompton | 2011-11-07 18:42:41 -0800 (Mon, 07 Nov 2011) | 2 lines

allow more than one interpolant at a time

------------------------------------------------------------------------
r524 | jhittinger | 2011-10-20 17:04:02 -0700 (Thu, 20 Oct 2011) | 2 lines

Added INOutFlowBCF.ChF

------------------------------------------------------------------------
r523 | jhittinger | 2011-10-20 17:03:02 -0700 (Thu, 20 Oct 2011) | 2 lines

Added InOutFlowBC class

------------------------------------------------------------------------
r522 | jhittinger | 2011-10-20 17:01:12 -0700 (Thu, 20 Oct 2011) | 2 lines

Revert to correct make files

------------------------------------------------------------------------
r521 | jhittinger | 2011-10-20 16:57:22 -0700 (Thu, 20 Oct 2011) | 2 lines

New input file for in/outflow bcs.

------------------------------------------------------------------------
r520 | mdorr | 2011-10-07 16:40:11 -0700 (Fri, 07 Oct 2011) | 2 lines

Adding bspline interpolation package.  Renaming akimaspline.f to compton.f to avoid confusion of John's spine routine with the original Akima interpolation package.

------------------------------------------------------------------------
r519 | jcompton | 2011-10-05 15:58:19 -0700 (Wed, 05 Oct 2011) | 2 lines

fixed derivatives in akimaspline.f

------------------------------------------------------------------------
r518 | mdorr | 2011-10-04 21:12:17 -0700 (Tue, 04 Oct 2011) | 2 lines

Adding isnan checks on the inputs and outputs of akimaspline.

------------------------------------------------------------------------
r517 | mdorr | 2011-10-04 15:01:28 -0700 (Tue, 04 Oct 2011) | 2 lines

Adding sample geometry mapping file.

------------------------------------------------------------------------
r516 | mdorr | 2011-10-04 11:11:23 -0700 (Tue, 04 Oct 2011) | 2 lines

Adding input files for the truncated single null problem.

------------------------------------------------------------------------
r515 | mdorr | 2011-10-04 11:09:19 -0700 (Tue, 04 Oct 2011) | 2 lines

Adding spline interpolation option.

------------------------------------------------------------------------
r514 | mdorr | 2011-10-02 16:32:48 -0700 (Sun, 02 Oct 2011) | 2 lines

Modifications to make the ghost cell strategy more similar to that used in GKSystem.

------------------------------------------------------------------------
r513 | mdorr | 2011-10-02 16:31:42 -0700 (Sun, 02 Oct 2011) | 4 lines

Refactor of SingleNullBlockCoordSys to read mapping data from geometry_mapping file and construct the mapping using the Akima bicubic Hermite interpolation package.

Added option in LocSpatialIBC to specify blob parameters relative to cylindricalcoordinates rather than mapped.

------------------------------------------------------------------------
r512 | mdorr | 2011-10-02 12:31:38 -0700 (Sun, 02 Oct 2011) | 2 lines

Fixing multJ() and divideJ() to work correctly with multiblock (even though this single block example doesn't need it).

------------------------------------------------------------------------
r511 | mdorr | 2011-09-30 18:59:20 -0700 (Fri, 30 Sep 2011) | 2 lines

Adding executable directory for 2d test code in annular geometry.

------------------------------------------------------------------------
r510 | mdorr | 2011-09-30 18:57:43 -0700 (Fri, 30 Sep 2011) | 2 lines

Adding new source directory and files for a 2d test code in annular geometry.

------------------------------------------------------------------------
r509 | mdorr | 2011-09-30 18:41:25 -0700 (Fri, 30 Sep 2011) | 2 lines

Adding an option to specify the blob parameters in real space rather than mapped (#if 0'd out for now).

------------------------------------------------------------------------
r508 | mdorr | 2011-09-30 18:34:35 -0700 (Fri, 30 Sep 2011) | 2 lines

Fixing a bug that causes the radial spreading to malfunction if an insufficient number of ghost cells are used.

------------------------------------------------------------------------
r507 | mdorr | 2011-09-23 22:48:27 -0700 (Fri, 23 Sep 2011) | 2 lines

Fixing potential boundary extrapolation in field calculation.

------------------------------------------------------------------------
r506 | jcompton | 2011-09-14 20:54:00 -0700 (Wed, 14 Sep 2011) | 2 lines

reactivated retoct in divert_interp

------------------------------------------------------------------------
r505 | jcompton | 2011-09-13 14:42:41 -0700 (Tue, 13 Sep 2011) | 2 lines

nsplinepts /5/, formats generalized for gridue file

------------------------------------------------------------------------
r504 | jcompton | 2011-09-07 12:00:42 -0700 (Wed, 07 Sep 2011) | 2 lines

variable no. of spline points for interpolation

------------------------------------------------------------------------
r503 | mdorr | 2011-09-06 20:28:01 -0700 (Tue, 06 Sep 2011) | 2 lines

Removing extra J factor in initial condition.

------------------------------------------------------------------------
r502 | jcompton | 2011-09-05 20:02:44 -0700 (Mon, 05 Sep 2011) | 2 lines

optimized spline interpolation

------------------------------------------------------------------------
r501 | jcompton | 2011-08-22 00:52:26 -0700 (Mon, 22 Aug 2011) | 2 lines

variable spacing of splines in gridue_gh in radial direction

------------------------------------------------------------------------
r500 | mdorr | 2011-08-17 16:51:44 -0700 (Wed, 17 Aug 2011) | 2 lines

Adding more diagnostics.

------------------------------------------------------------------------
r499 | mdorr | 2011-08-17 16:49:42 -0700 (Wed, 17 Aug 2011) | 3 lines

Splitting core and central scrape off into two block each to allow the coordinate mappings extended through the X point to be single-valued.
More tweeks to the mappings near the X point.

------------------------------------------------------------------------
r498 | mdorr | 2011-08-17 11:04:19 -0700 (Wed, 17 Aug 2011) | 2 lines

Removing carriage returns accidentally inserted by a Windows user.

------------------------------------------------------------------------
r497 | mdorr | 2011-08-10 18:12:00 -0700 (Wed, 10 Aug 2011) | 2 lines

Cleaning up the Newton solve.

------------------------------------------------------------------------
r496 | jcompton | 2011-08-09 22:34:50 -0700 (Tue, 09 Aug 2011) | 2 lines

bug fixes

------------------------------------------------------------------------
r495 | mdorr | 2011-08-09 12:30:10 -0700 (Tue, 09 Aug 2011) | 4 lines

Adding mesh size to SingleNullBlockCoordSys constructor.
Adding octant argument to getMapping.
Adding a backtracking option to the Newton solver.

------------------------------------------------------------------------
r494 | mdorr | 2011-08-09 10:44:55 -0700 (Tue, 09 Aug 2011) | 2 lines

Modifying diagnostics.

------------------------------------------------------------------------
r493 | jcompton | 2011-08-08 15:37:08 -0700 (Mon, 08 Aug 2011) | 2 lines

use only splines to compute single null geometry

------------------------------------------------------------------------
r492 | jcompton | 2011-08-02 22:48:57 -0700 (Tue, 02 Aug 2011) | 2 lines

smoothed out kinks in mesh

------------------------------------------------------------------------
r491 | jcompton | 2011-08-02 15:54:26 -0700 (Tue, 02 Aug 2011) | 2 lines

fixed some discontinuities

------------------------------------------------------------------------
r490 | jcompton | 2011-07-31 23:41:13 -0700 (Sun, 31 Jul 2011) | 2 lines

replaced numerical derivatives with analytic ones

------------------------------------------------------------------------
r489 | jcompton | 2011-06-28 22:31:12 -0700 (Tue, 28 Jun 2011) | 2 lines

correct new return code from divert_interp

------------------------------------------------------------------------
r488 | mdorr | 2011-06-23 14:26:39 -0700 (Thu, 23 Jun 2011) | 2 lines

Updating mapping of block to divertor region numbers.

------------------------------------------------------------------------
r487 | jcompton | 2011-06-22 23:05:55 -0700 (Wed, 22 Jun 2011) | 2 lines

added new gridding near the null point for single null geometry

------------------------------------------------------------------------
r486 | mdorf | 2011-05-25 13:09:02 -0700 (Wed, 25 May 2011) | 2 lines

Plotting of the new diagnostics (parallel velocity, particle and heat fluxes) has been added

------------------------------------------------------------------------
r485 | mdorf | 2011-05-25 13:07:30 -0700 (Wed, 25 May 2011) | 2 lines

New diagnostics (parallel velocity momenet, radial particle and heat fluxes) hasbeen added

------------------------------------------------------------------------
r484 | mdorf | 2011-05-25 13:05:43 -0700 (Wed, 25 May 2011) | 2 lines

an option to rotate the physical velocity components to the mapped space (without amplitude rescaling) has been added to updateVelocity()

------------------------------------------------------------------------
r483 | mdorr | 2011-05-20 16:26:08 -0700 (Fri, 20 May 2011) | 2 lines

Modifying Newton iteration convergence criteria to include a tolerance on iterate change.

------------------------------------------------------------------------
r482 | mdorr | 2011-05-19 15:39:40 -0700 (Thu, 19 May 2011) | 2 lines

Removing physical cell volumes in the computation of the integrals defining the averages, which should be computed in computational coordinates instead.

------------------------------------------------------------------------
r481 | mdorr | 2011-05-16 16:32:23 -0700 (Mon, 16 May 2011) | 2 lines

Adding new test src and exec directories/files.

------------------------------------------------------------------------
r480 | jhittinger | 2011-05-12 16:40:50 -0700 (Thu, 12 May 2011) | 2 lines

Fixed header file issues in GKSystem

------------------------------------------------------------------------
r479 | jhittinger | 2011-05-12 16:09:54 -0700 (Thu, 12 May 2011) | 2 lines

Revisions to improve Hilditch-Colella positivity preservation

------------------------------------------------------------------------
r478 | jhittinger | 2011-05-12 16:08:35 -0700 (Thu, 12 May 2011) | 2 lines

Input file with controls for positivity preservation

------------------------------------------------------------------------
r477 | jhittinger | 2011-05-12 10:17:49 -0700 (Thu, 12 May 2011) | 2 lines

Clean-up of max/min calculation

------------------------------------------------------------------------
r476 | jhittinger | 2011-05-11 17:37:56 -0700 (Wed, 11 May 2011) | 2 lines

Fixed unintended check-in of change to KineticSpecies

------------------------------------------------------------------------
r475 | jhittinger | 2011-05-11 16:27:27 -0700 (Wed, 11 May 2011) | 2 lines

Changes to allow initial version of positivity enforcement

------------------------------------------------------------------------
r474 | jhittinger | 2011-05-11 16:21:49 -0700 (Wed, 11 May 2011) | 2 lines

Fixed passing of dir as Real instead of int

------------------------------------------------------------------------
r473 | mdorr | 2011-05-01 09:54:45 -0700 (Sun, 01 May 2011) | 2 lines

Turning off the old (broken) limiter that had accidently gotten turn back on.

------------------------------------------------------------------------
r472 | mdorr | 2011-04-19 11:48:27 -0700 (Tue, 19 Apr 2011) | 7 lines

More fixes to single null geometry.

Adding src and test directories for a stripped down version of the code that just does advection in a 2D single null geometry.

The Simulation class is now templated on system type (currently either GKSystem for the real code or SNSystem for the stripped down
 single null advection version).

------------------------------------------------------------------------
r471 | jcompton | 2011-04-13 19:25:12 -0700 (Wed, 13 Apr 2011) | 2 lines

converted output arrays from divert_interp1 to row-order in (theta,r)

------------------------------------------------------------------------
r470 | dmartin | 2011-04-12 16:41:28 -0700 (Tue, 12 Apr 2011) | 2 lines

changes to allow for serial compilation. Also changed char* -> const char* to silence annoying compiler warning.

------------------------------------------------------------------------
r469 | dmartin | 2011-04-12 16:39:24 -0700 (Tue, 12 Apr 2011) | 2 lines

added noLibs target, which does the multidim build assuming that the Chombo libraries are up to date (so it doesn't look at them at all). This results in a substantially faster build if all you're modifying is stuff under ESLCode, but obviously should be used carefully to make sure things stay in sync.

------------------------------------------------------------------------
r468 | mdorr | 2011-04-11 18:14:17 -0700 (Mon, 11 Apr 2011) | 7 lines

Removing Constants.H and adding ConstFact.H (which I should have done last commit...).

Adding a (defaulted false) argument to tell GKPoisson::computeElectricField to use the cell-centered potentials provided in ghost cells rather than performing its own extrapolation.

Changed the default field plotted to be the mapped field rather than
the unmapped field.

------------------------------------------------------------------------
r467 | mdorr | 2011-04-11 12:28:43 -0700 (Mon, 11 Apr 2011) | 2 lines

Renaming Constants.H to ConstFact.H to avoid collisions with the Chombo CONSTANTS.H header on platforms with case insensitive file name (e.g., Ron Cohen's Macintosh).

------------------------------------------------------------------------
r466 | mdorr | 2011-04-08 17:58:44 -0700 (Fri, 08 Apr 2011) | 2 lines

Fixing bad index in ghost extrapolation.

------------------------------------------------------------------------
r465 | dmartin | 2011-04-05 01:37:36 -0700 (Tue, 05 Apr 2011) | 2 lines

added doconfig file for hopp2.nersc.gov (eventually hopper.nersc.gov) which appears to work...

------------------------------------------------------------------------
r464 | dmartin | 2011-04-05 01:08:17 -0700 (Tue, 05 Apr 2011) | 2 lines

switched IntVect::IntVect(...) to IntVect(...) to make gnu compiler on hopper happy

------------------------------------------------------------------------
r463 | jcompton | 2011-04-04 18:08:28 -0700 (Mon, 04 Apr 2011) | 2 lines

made numerical constants double precision

------------------------------------------------------------------------
r462 | mdorr | 2011-04-04 15:33:47 -0700 (Mon, 04 Apr 2011) | 4 lines

Changes related to the calculation of velocities directly from the electric field, rather than the potential.

Add a blockRemappingGeneral function to the single null coord sys.

------------------------------------------------------------------------
r461 | mdorr | 2011-03-24 09:19:59 -0700 (Thu, 24 Mar 2011) | 2 lines

Declaring the constructor argument as const, to fix a problem Mikhail hit.

------------------------------------------------------------------------
r460 | mdorr | 2011-03-18 14:54:35 -0700 (Fri, 18 Mar 2011) | 2 lines

Adding a default argument to PhaseGeom::updateVelocities to specify whether a volume factor is included in the returned velocity, or is simply rotated from the lab frame to the computational coordinate frame.  Mikhail needed this for a diagnostic.

------------------------------------------------------------------------
r459 | mdorr | 2011-03-17 13:00:01 -0700 (Thu, 17 Mar 2011) | 2 lines

Removing minus signs from dXdxi, since the variable change they resulted from is now performed at the end of getMappingValues.

------------------------------------------------------------------------
r458 | mdorr | 2011-03-16 10:26:36 -0700 (Wed, 16 Mar 2011) | 2 lines

Fixing the accidently checked in conflict.

------------------------------------------------------------------------
r457 | jcompton | 2011-03-15 20:47:35 -0700 (Tue, 15 Mar 2011) | 2 lines

fixed some derivatives in scrape-off layer

------------------------------------------------------------------------
r456 | jcompton | 2011-03-08 21:23:25 -0800 (Tue, 08 Mar 2011) | 2 lines

improved boundary conditions for spline interpolations

------------------------------------------------------------------------
r455 | jcompton | 2011-03-08 21:19:34 -0800 (Tue, 08 Mar 2011) | 2 lines

fixed block interface extrapolation bug

------------------------------------------------------------------------
r454 | mdorr | 2011-03-08 09:56:39 -0800 (Tue, 08 Mar 2011) | 2 lines

Increasing domain box size in diagnostic plots of the metric data in order to see the physical boundary ghost data in VisIt.

------------------------------------------------------------------------
r453 | jcompton | 2011-03-07 22:00:41 -0800 (Mon, 07 Mar 2011) | 2 lines

updated geometry and derivatives

------------------------------------------------------------------------
r452 | mdorr | 2011-03-07 16:45:27 -0800 (Mon, 07 Mar 2011) | 2 lines

Adding recalculation of Boltzmann prefactor numerator after a restart when thefs_neutrality_initial_fs_ni option is specified.

------------------------------------------------------------------------
r451 | mdorr | 2011-03-07 12:11:26 -0800 (Mon, 07 Mar 2011) | 2 lines

Fixing the Boltzmann prefactor option in which the numerator is the flux surface averaged ion density at the initial time.  As discovered by Mikhail, the numerator was instead being recomputed at every evaluation of the prefactor.

------------------------------------------------------------------------
r450 | mdorr | 2011-02-21 16:35:17 -0800 (Mon, 21 Feb 2011) | 8 lines

Implementing the real single null interblock connectivity instead of the initial test configuration.

Added new (separate) classes for the Miller and SingleNull multiblock phase space coordinate systems.

Renamed ESLConstants.H, ESLDimensions.H and ESLDirections.H to just Constants.H, Dimensions.H and Directions.H.  The enumerated type defining RADIAL_DIR, POLOIDAL_DIR, TOROIDAL_DIR, VPARALLEL_DIR and MU_DIR has been added to Directions.H (at long last).

LocalizedIBC has been converted to work with multiblock geometries.  The remaining IBC classes still need to be converted.

------------------------------------------------------------------------
r449 | mdorr | 2011-02-14 17:48:24 -0800 (Mon, 14 Feb 2011) | 2 lines

Creating disjointBoxLayouts with a ProblemDomain defined from a bounding box when there is more than one block.

------------------------------------------------------------------------
r448 | mdorr | 2011-02-05 18:31:45 -0800 (Sat, 05 Feb 2011) | 2 lines

New files.

------------------------------------------------------------------------
r447 | mdorr | 2011-02-05 18:25:21 -0800 (Sat, 05 Feb 2011) | 2 lines

More changes for divertor geometry.

------------------------------------------------------------------------
r446 | jcompton | 2011-02-03 22:11:57 -0800 (Thu, 03 Feb 2011) | 2 lines

added single null regions 2 and 3 (old numbering)

------------------------------------------------------------------------
r445 | jcompton | 2011-01-30 22:39:03 -0800 (Sun, 30 Jan 2011) | 2 lines

improved continuity of 1st derivatives within blocks

------------------------------------------------------------------------
r444 | jcompton | 2011-01-10 19:30:42 -0800 (Mon, 10 Jan 2011) | 2 lines

added scrape-off layer to single-null geometry

------------------------------------------------------------------------
r443 | mdorr | 2010-12-21 13:51:13 -0800 (Tue, 21 Dec 2010) | 2 lines

Since the enumerated block boundary type is no longer available in the public interface of MultiBlockCoordSys, replacing it by zero for now.

------------------------------------------------------------------------
r442 | jcompton | 2010-12-15 20:18:32 -0800 (Wed, 15 Dec 2010) | 2 lines

fix to single null geometry core near null point

------------------------------------------------------------------------
r441 | mdorr | 2010-12-15 11:31:54 -0800 (Wed, 15 Dec 2010) | 2 lines

Add missing source file.

------------------------------------------------------------------------
r440 | mdorr | 2010-12-06 10:26:12 -0800 (Mon, 06 Dec 2010) | 2 lines

Adding missing header.

------------------------------------------------------------------------
r439 | mdorr | 2010-11-22 10:09:03 -0800 (Mon, 22 Nov 2010) | 2 lines

Updates for multiblock divertor.

------------------------------------------------------------------------
r438 | mdorr | 2010-11-17 12:46:23 -0800 (Wed, 17 Nov 2010) | 4 lines

Adding single null block coord sys.
Removing some temporarty files.
Refactor field calculation to remove Miller-specific geometry data from code that can/should be generic.

------------------------------------------------------------------------
r437 | mdorr | 2010-11-09 09:46:29 -0800 (Tue, 09 Nov 2010) | 2 lines

Fixing bug in blockMapping() member.

------------------------------------------------------------------------
r436 | mdorr | 2010-11-09 09:45:43 -0800 (Tue, 09 Nov 2010) | 2 lines

Hiding these files from the build system for the time being.

------------------------------------------------------------------------
r435 | mdorr | 2010-11-05 14:19:53 -0700 (Fri, 05 Nov 2010) | 2 lines

Adding lapack libs.

------------------------------------------------------------------------
r434 | mdorr | 2010-11-05 14:18:40 -0700 (Fri, 05 Nov 2010) | 2 lines

Checking in the latest so that Peter can help me get the MultiBlockExchange working.

------------------------------------------------------------------------
r433 | mdorr | 2010-10-28 14:21:32 -0700 (Thu, 28 Oct 2010) | 2 lines

Refactor of the setting of initial and boundary data.

------------------------------------------------------------------------
r432 | jcompton | 2010-10-22 10:30:03 -0700 (Fri, 22 Oct 2010) | 2 lines

read single null parameters from input deck

------------------------------------------------------------------------
r431 | mdorr | 2010-10-19 14:50:04 -0700 (Tue, 19 Oct 2010) | 2 lines

Moving the utilities to multiply or divide by BStarParallel from GKSystem to the phase space coordinate system where it belongs.  Removing the accessor to BStarParallel, which should no longer be used for anything.

------------------------------------------------------------------------
r430 | mdorr | 2010-10-19 11:40:29 -0700 (Tue, 19 Oct 2010) | 2 lines

Accessing the initial dfn in the Moment Kernel.

------------------------------------------------------------------------
r429 | mdorr | 2010-10-19 11:39:15 -0700 (Tue, 19 Oct 2010) | 2 lines

Adding a const accessor for the initial dfn.

------------------------------------------------------------------------
r428 | mdorr | 2010-10-18 22:34:12 -0700 (Mon, 18 Oct 2010) | 2 lines

Fixing ghost cell calculation that was causing the code to break on smaug and grendel.

------------------------------------------------------------------------
r427 | mdorr | 2010-10-08 14:49:27 -0700 (Fri, 08 Oct 2010) | 2 lines

*** empty log message ***

------------------------------------------------------------------------
r426 | mdorr | 2010-10-08 14:46:17 -0700 (Fri, 08 Oct 2010) | 2 lines

Missed the species directory somehow.

------------------------------------------------------------------------
r425 | mdorr | 2010-10-08 14:42:56 -0700 (Fri, 08 Oct 2010) | 2 lines

Still more renaming.

------------------------------------------------------------------------
r424 | mdorr | 2010-10-08 14:37:55 -0700 (Fri, 08 Oct 2010) | 2 lines

Renaming some things.

------------------------------------------------------------------------
r423 | mdorr | 2010-09-30 14:48:49 -0700 (Thu, 30 Sep 2010) | 2 lines

Adding a velocity space coordinate system.

------------------------------------------------------------------------
r422 | mdorr | 2010-09-24 17:18:41 -0700 (Fri, 24 Sep 2010) | 2 lines

Refactoring the coordinate system classes to enable access of the Chombo NewCoordSys and Multiblock API.

------------------------------------------------------------------------
r421 | mdorr | 2010-09-24 17:16:16 -0700 (Fri, 24 Sep 2010) | 2 lines

Adding new Chombo Multiblock directories to the build source tree.

------------------------------------------------------------------------
r420 | jcompton | 2010-09-13 16:02:35 -0700 (Mon, 13 Sep 2010) | 2 lines

files for diverted geometry

------------------------------------------------------------------------
r419 | mdorr | 2010-09-01 15:39:01 -0700 (Wed, 01 Sep 2010) | 2 lines

Refactor and cleanup of configuration and phase space geometries before migration to new coord sys API and multiblock.

------------------------------------------------------------------------
r418 | rcohen | 2010-08-26 10:14:44 -0700 (Thu, 26 Aug 2010) | 4 lines

Corrected for psi_i being defined in some cases locally and so not storing the value in PhaseBC's class
member.   This was messing up PhaseBC's calculations of radii.   PhaseBC.cpp and PoloidalIBCF.ChF are
updated here only because some print statements were added and removed.

------------------------------------------------------------------------
r417 | rcohen | 2010-08-23 14:59:29 -0700 (Mon, 23 Aug 2010) | 9 lines

Added declaration of m_psi that was previously undefined for some of the IBC's that make
use of PhaseBC via MIonIBC or MElecIBC.  It is for the moment still defined assuming
uniformly spaced grids; this should be replaced by a call back to physical grids, but
that requires some thought.

The coding for m_psi is in PhaseBC.cpp; the other files updated were:
PhaseBC.H, added psi_i as class member;
MElecIBC.cpp and MIonIBC.cpp, added computation of psi_i.

------------------------------------------------------------------------
r416 | mdorr | 2010-08-20 13:43:13 -0700 (Fri, 20 Aug 2010) | 2 lines

Adding a .cpp for the MagGeomCoordSys class to add more members.  Only a .H existed previously.

------------------------------------------------------------------------
r415 | mdorr | 2010-08-11 09:30:07 -0700 (Wed, 11 Aug 2010) | 2 lines

Adding member functions to MagGeomCoordSys to return face-centered values of the metrics N.  This is needed in cases where we want to compute N^T * F as a face-centered quantity and then convert to face-averages, rather than using the mapped grid product formula on the face-averages of the factors N^T and F.  This reduces the error for special cases like our flux-surface aligned coordinate system, especially for coarse grids.

------------------------------------------------------------------------
r414 | mdorr | 2010-08-11 09:10:14 -0700 (Wed, 11 Aug 2010) | 2 lines

Modifications to compute a 4th-order cell-averaged initial condition rather than the previous cell-centered value.

------------------------------------------------------------------------
r413 | mdorr | 2010-08-10 12:34:34 -0700 (Tue, 10 Aug 2010) | 3 lines

Adding division by BStarParallel to the plots of distributions versus poloidal
angle and vparallel (for a particular radius and mu).

------------------------------------------------------------------------
r412 | rcohen | 2010-06-24 17:21:53 -0700 (Thu, 24 Jun 2010) | 4 lines

gamteover10 is base case q=3 tau=0.1 input deck.
fixedmilogam seems to be identical with what's in repo, not sure
why it shows up as different.

------------------------------------------------------------------------
r411 | mdorr | 2010-04-07 09:21:59 -0700 (Wed, 07 Apr 2010) | 2 lines

Adding the option to plot distribution functions at a specified configuration space point (as a function of vparallel and mu).

------------------------------------------------------------------------
r410 | jcompton | 2010-03-19 20:58:59 -0700 (Fri, 19 Mar 2010) | 2 lines

minor I/O corrections necessary for running comparison tests

------------------------------------------------------------------------
r409 | mdorr | 2010-03-12 16:40:48 -0800 (Fri, 12 Mar 2010) | 2 lines

Removing cellUJToCellU, since we will instead use cellFGToCellF from the 4th-order utilities.

------------------------------------------------------------------------
r408 | mdorr | 2010-03-11 11:15:32 -0800 (Thu, 11 Mar 2010) | 2 lines

Completed implementation of radial spreader for LD<FluxBox>es.  Removed SPREAD_PATCH workaround since it's no longer needed and is now inconsistent with the recent spreader changes.

------------------------------------------------------------------------
r407 | mdorr | 2010-03-08 09:04:55 -0800 (Mon, 08 Mar 2010) | 2 lines

Modifying radial spreading to spread from the middle flux surface instead of theone a half cell beyond the middle.

------------------------------------------------------------------------
r406 | mdorr | 2010-03-03 16:42:42 -0800 (Wed, 03 Mar 2010) | 4 lines

Adding 4th-order field calculation in construction of GK velocities.

Removing a print statement from the poloidal velocity test option.

------------------------------------------------------------------------
r405 | jcompton | 2010-03-01 13:34:21 -0800 (Mon, 01 Mar 2010) | 2 lines

commented out some debug print statements to enable testing

------------------------------------------------------------------------
r404 | jcompton | 2010-02-16 15:23:47 -0800 (Tue, 16 Feb 2010) | 2 lines

fixed memory allocation for field histories on restart

------------------------------------------------------------------------
r403 | mdorr | 2010-02-06 13:22:03 -0800 (Sat, 06 Feb 2010) | 2 lines

Just turning the field solve at the end of initialize() back on, which I had turned off for restart debugging.

------------------------------------------------------------------------
r402 | mdorr | 2010-02-06 12:10:30 -0800 (Sat, 06 Feb 2010) | 2 lines

Interface changes to pass in current time, timestep and step number.

------------------------------------------------------------------------
r401 | mdorr | 2010-02-06 12:09:19 -0800 (Sat, 06 Feb 2010) | 2 lines

Removing the current time, timestep and step number as class members.  The Simulation object owns these quantities, which are now passed into any GKSystem members that require them.  A number of interfaces have been modified as a result.  This will hopefully improve consistency (e.g., after restarts).

------------------------------------------------------------------------
r400 | mdorr | 2010-02-06 12:04:00 -0800 (Sat, 06 Feb 2010) | 2 lines

Fixing the projection of phase space onto configuration space.

------------------------------------------------------------------------
r399 | rcohen | 2010-01-29 10:35:39 -0800 (Fri, 29 Jan 2010) | 4 lines

Added option fs_neutrality_global_ni for gkpoissonboltzmann.prefactor.
This calculates the prefactor using the current-time global average
ion density, and so ensures consistency for a doubly periodic potential

------------------------------------------------------------------------
r398 | mdorr | 2010-01-28 14:57:55 -0800 (Thu, 28 Jan 2010) | 2 lines

Removing solution change test from Newton iteration.

------------------------------------------------------------------------
r397 | mdorr | 2010-01-28 13:15:23 -0800 (Thu, 28 Jan 2010) | 2 lines

Checking in limiter workaround.

------------------------------------------------------------------------
r396 | mdorr | 2010-01-20 15:37:19 -0800 (Wed, 20 Jan 2010) | 2 lines

Turning the limiter back on.

------------------------------------------------------------------------
r395 | mdorr | 2010-01-19 08:55:29 -0800 (Tue, 19 Jan 2010) | 2 lines

Fixing multicomponent bug in flux surface averager.

------------------------------------------------------------------------
r394 | jcompton | 2010-01-15 19:16:48 -0800 (Fri, 15 Jan 2010) | 2 lines

corrected possible synchronization error with 1/13 change for deterministic output

------------------------------------------------------------------------
r393 | mdorr | 2010-01-15 12:50:39 -0800 (Fri, 15 Jan 2010) | 2 lines

Adding new field solve preconditioner.

------------------------------------------------------------------------
r392 | jcompton | 2010-01-13 18:55:50 -0800 (Wed, 13 Jan 2010) | 2 lines

output forced to process order (i.e., deterministic) to enable baseline comparisons

------------------------------------------------------------------------
r391 | rcohen | 2010-01-11 17:47:21 -0800 (Mon, 11 Jan 2010) | 2 lines

Further corrected parameters to agree with base case for Xu's gam benchmark

------------------------------------------------------------------------
r390 | mdorr | 2010-01-11 13:10:40 -0800 (Mon, 11 Jan 2010) | 2 lines

If the problem domain is fully periodic, we now subtract the solution average after the Jacobian solve to nail down the arbitrary constant.

------------------------------------------------------------------------
r389 | mdorr | 2010-01-08 14:29:18 -0800 (Fri, 08 Jan 2010) | 2 lines

Adding BiCGStab Jacobian solver in the Newton iteration of the GKP Boltzmann equation.

------------------------------------------------------------------------
r388 | mdorr | 2010-01-04 09:55:45 -0800 (Mon, 04 Jan 2010) | 2 lines

Passing stage number (rather than a boolean indicating whether or not the stage is the initial one) to m_op.evalRHS().

------------------------------------------------------------------------
r387 | rcohen | 2009-12-29 15:06:58 -0800 (Tue, 29 Dec 2009) | 4 lines

a GAM deck with proper range of radisu to correspond to Xu's parameters;
also has a range of vparallel and mu that should pick up the important
Landau resonances.

------------------------------------------------------------------------
r386 | mdorr | 2009-12-28 08:09:45 -0800 (Mon, 28 Dec 2009) | 6 lines

Fixing Nevins Boltzmann prefactor to only evaluate numerator at t=0.

Changing to HYPRE SMG multigrid solver for more robust handling of high cell aspect ratios.

Adding test on relative solution change in Newton iteration.

------------------------------------------------------------------------
r385 | rcohen | 2009-12-23 15:56:51 -0800 (Wed, 23 Dec 2009) | 2 lines

Deleting the specious divide by bpoloidal in the GK Poisson operator

------------------------------------------------------------------------
r384 | mdorr | 2009-12-19 16:36:42 -0800 (Sat, 19 Dec 2009) | 4 lines

Added new E field calculation at face centers.

Added new Boltzmann prefactor options.

------------------------------------------------------------------------
r383 | jcompton | 2009-12-18 17:22:27 -0800 (Fri, 18 Dec 2009) | 2 lines

place plot files in their own separate directories by category

------------------------------------------------------------------------
r382 | jcompton | 2009-12-16 17:44:01 -0800 (Wed, 16 Dec 2009) | 2 lines

delete field history arrays in GKSystem destructor

------------------------------------------------------------------------
r381 | jcompton | 2009-12-15 18:20:59 -0800 (Tue, 15 Dec 2009) | 2 lines

save field histories on initialization (start-up or restart)

------------------------------------------------------------------------
r380 | mdorr | 2009-12-14 15:08:30 -0800 (Mon, 14 Dec 2009) | 2 lines

Adding cell volume weighting to the flux surface averages.

------------------------------------------------------------------------
r379 | mdorr | 2009-12-12 15:12:25 -0800 (Sat, 12 Dec 2009) | 2 lines

Fixing the perpendicular projection to use the poloidal field unit vector.

------------------------------------------------------------------------
r378 | mdorr | 2009-12-12 12:11:28 -0800 (Sat, 12 Dec 2009) | 2 lines

Adding input options for the manual specification of the configuration, velocity and phase space domain decompositions.

------------------------------------------------------------------------
r377 | mdorr | 2009-12-12 11:29:19 -0800 (Sat, 12 Dec 2009) | 2 lines

Fixing bug in perpendicular projection term.  A DataIterator was created, but never iterated over.

------------------------------------------------------------------------
r376 | mdorr | 2009-12-11 17:44:55 -0800 (Fri, 11 Dec 2009) | 2 lines

Adding minor radius to vparallel velocity.

------------------------------------------------------------------------
r375 | mdorr | 2009-12-10 23:16:41 -0800 (Thu, 10 Dec 2009) | 2 lines

Multiplying the vparallel velocity by 2piR too.

------------------------------------------------------------------------
r374 | rcohen | 2009-12-10 11:18:03 -0800 (Thu, 10 Dec 2009) | 4 lines

A test of parallel dynamics in a potential well.  Initializes a phase space
blob at rest on the side of the well.  Should bounce with an angular
frequency of about sqrt(10)/2, with the checked-in parameters.

------------------------------------------------------------------------
r373 | mdorr | 2009-12-09 17:54:24 -0800 (Wed, 09 Dec 2009) | 2 lines

Adding an option to compute the GK velocities with components in the physical rather than lab frame.

------------------------------------------------------------------------
r372 | rcohen | 2009-12-09 00:43:07 -0800 (Wed, 09 Dec 2009) | 3 lines

A python script to convert Xu's dimensionless GAM parameters to ESL Code input
parameters

------------------------------------------------------------------------
r371 | rcohen | 2009-12-09 00:41:23 -0800 (Wed, 09 Dec 2009) | 4 lines

An input file with proper input parameters to match Xu's q=3 GAM case.
Previous input files were derived from Xu's parameters with inconsistent
mass.

------------------------------------------------------------------------
r370 | mdorr | 2009-12-07 15:27:27 -0800 (Mon, 07 Dec 2009) | 2 lines

Adding a check for minimum phase space box size (4).

------------------------------------------------------------------------
r369 | mdorr | 2009-12-07 15:16:33 -0800 (Mon, 07 Dec 2009) | 2 lines

Fixing memory leak caused by multiple call to Hypre matrix and vector Initialize functions.

------------------------------------------------------------------------
r368 | rcohen | 2009-12-07 14:49:01 -0800 (Mon, 07 Dec 2009) | 2 lines

Added option (default turned off) to zero the radial flux.

------------------------------------------------------------------------
r367 | rcohen | 2009-12-05 11:31:32 -0800 (Sat, 05 Dec 2009) | 2 lines

fixed some memory leaks

------------------------------------------------------------------------
r366 | jcompton | 2009-12-04 16:27:35 -0800 (Fri, 04 Dec 2009) | 2 lines

output two history files per watchpoint (one for Visit); new efield plot warnings

------------------------------------------------------------------------
r365 | mdorr | 2009-12-04 09:38:40 -0800 (Fri, 04 Dec 2009) | 2 lines

Fixing the no_drifts switch and adding another one to turn parallel streaming on and off from the input file.

------------------------------------------------------------------------
r364 | mdorr | 2009-12-02 15:47:33 -0800 (Wed, 02 Dec 2009) | 6 lines

Fixing unmapped field calculation that was causing the ExB term of the velocities to be too small (and therefore a large stableDt was computed).

When the NEW_VELOCITIES option is set in PhaseSpaceCoordSys (now the default), we now compute face-centered field values from face averages, since the GK velocities are computed at face-centers too.

Removed some unused code from the Miller geometry.

------------------------------------------------------------------------
r363 | mdorr | 2009-12-02 10:15:13 -0800 (Wed, 02 Dec 2009) | 2 lines

Removing this header from the repo, since it's built locally automatically.

------------------------------------------------------------------------
r362 | rcohen | 2009-12-01 23:46:53 -0800 (Tue, 01 Dec 2009) | 3 lines

Implemented const_minorradius option into get_field_data.  Changed interface including
call in the cpp file accordingly.

------------------------------------------------------------------------
r361 | rcohen | 2009-12-01 11:07:44 -0800 (Tue, 01 Dec 2009) | 3 lines

update to Miller ChF file to be consistent with carefully derived notes.
Included fix to dimensionally inconsistent quantities.

------------------------------------------------------------------------
r360 | mdorr | 2009-11-27 11:25:56 -0800 (Fri, 27 Nov 2009) | 2 lines

Modifications to the new velocity calculation.

------------------------------------------------------------------------
r359 | mdorr | 2009-11-25 12:25:00 -0800 (Wed, 25 Nov 2009) | 2 lines

Adding new velocity option.

------------------------------------------------------------------------
r358 | rcohen | 2009-11-25 10:50:27 -0800 (Wed, 25 Nov 2009) | 2 lines

Removed spurious occurrence of jac from pointval

------------------------------------------------------------------------
r357 | rcohen | 2009-11-25 09:51:32 -0800 (Wed, 25 Nov 2009) | 5 lines

Added pointvals subroutine to compute B field quantities at a point value.
This is just taking the coding already there in get_field_cell_averages and
stripping away the chombo indices and averaging, so it is dependent on correct
expressions having been coded in that routine.

------------------------------------------------------------------------
r356 | rcohen | 2009-11-24 11:32:44 -0800 (Tue, 24 Nov 2009) | 2 lines

Corrected == to = in test of m_initializedE

------------------------------------------------------------------------
r355 | rcohen | 2009-11-24 11:30:56 -0800 (Tue, 24 Nov 2009) | 2 lines

Forgot to commit this before.

------------------------------------------------------------------------
r354 | rcohen | 2009-11-24 09:56:42 -0800 (Tue, 24 Nov 2009) | 3 lines

A file to test advection of a blob in a fixed Efield.   It looks like there are problems
with ExB advection based on the results.

------------------------------------------------------------------------
r353 | rcohen | 2009-11-23 20:21:46 -0800 (Mon, 23 Nov 2009) | 3 lines

Replaced test for step_number == 0 by test for m_initializedE== false (which is then set to true)
in calling E field calculation for fixed_efield; so this will work with a restart as well.

------------------------------------------------------------------------
r352 | rcohen | 2009-11-23 20:12:10 -0800 (Mon, 23 Nov 2009) | 8 lines

Added creating an instance of gkpoisson for fixed_efield (if potential_model not equal "zero")
so we can actually calculate the fixed E field.  Also added the call to calculate the efield
in that case.   Removed redundant recomputation of the E field on subsequent steps.
Need to fix so works on restart; I will do this shortly.

We need Milo to remove restriction on doubly periodic from GKPoisson for the case of fixed_efield,
as there is no actual potential solve in that case so the test is not needed.

------------------------------------------------------------------------
r351 | mdorr | 2009-11-23 18:43:47 -0800 (Mon, 23 Nov 2009) | 2 lines

Fixing phase space jacobian, which was varying radially even though the constant minor radius option was on.

------------------------------------------------------------------------
r350 | rcohen | 2009-11-23 17:35:35 -0800 (Mon, 23 Nov 2009) | 4 lines

Removed John's test for has_electrons from the decision about whether
to write an Efield plot, since if fixed_efield is true we will want to
plot the fixed Efield at t=0.

------------------------------------------------------------------------
r349 | mdorr | 2009-11-23 10:32:01 -0800 (Mon, 23 Nov 2009) | 2 lines

Adding an ExB velocity option.

------------------------------------------------------------------------
r348 | dmartin | 2009-11-22 14:31:19 -0800 (Sun, 22 Nov 2009) | 5 lines

fixed "normal" implementation of SpreadRadially.  Replaced LevelData::degenerate" function call and instead define a one-cell-wide single-box DisjointBoxLayout at the midplane, define a corresponding temporary LevelData, copyTo that, then use the spreadingCopier as before.

Apparently the DisjointBoxLayout::degenerate function is broken in some way which was causing us problems
.

------------------------------------------------------------------------
r347 | mdorr | 2009-11-21 17:25:13 -0800 (Sat, 21 Nov 2009) | 4 lines

Fixing the radial spreader again.

Added an option to use global neutrality only at t=0 in the Boltzmann prefactor.

------------------------------------------------------------------------
r346 | dmartin | 2009-11-20 17:26:41 -0800 (Fri, 20 Nov 2009) | 2 lines

use hypre_loc_serial if we're compiling in serial. This allows switching between serial and parallel builds w/o having to re-point the symbolic link back and forth. (MPI still points to hypre_loc, so this probably only affects me)

------------------------------------------------------------------------
r345 | rcohen | 2009-11-20 10:02:41 -0800 (Fri, 20 Nov 2009) | 2 lines

Update to reflect what I've actually been running

------------------------------------------------------------------------
r344 | jcompton | 2009-11-19 19:09:06 -0800 (Thu, 19 Nov 2009) | 2 lines

pressure moment added; new plot efield logic

------------------------------------------------------------------------
r343 | rcohen | 2009-11-18 23:22:51 -0800 (Wed, 18 Nov 2009) | 4 lines

Added logic to create Phi and E dump files at t=0 if fixed_efield = true.
Now we just need to have an efield calculation at t=0 consistent with a specified
potential model...

------------------------------------------------------------------------
r342 | rcohen | 2009-11-18 18:07:45 -0800 (Wed, 18 Nov 2009) | 2 lines

a vparallel advection problem tha seems to run with field solve and without incident.

------------------------------------------------------------------------
r341 | mdorr | 2009-11-18 17:59:44 -0800 (Wed, 18 Nov 2009) | 2 lines

Fixing the workaround radial spreader, which will now be the default until we figure out why the original one causes trouble.

------------------------------------------------------------------------
r340 | rcohen | 2009-11-18 17:58:48 -0800 (Wed, 18 Nov 2009) | 2 lines

A test script to illustrate a problem with the radial spreader

------------------------------------------------------------------------
r339 | mdorr | 2009-11-17 16:33:47 -0800 (Tue, 17 Nov 2009) | 2 lines

Test file for Dan.

------------------------------------------------------------------------
r338 | mdorr | 2009-11-17 16:00:19 -0800 (Tue, 17 Nov 2009) | 2 lines

Some repairs to the field solve.  Changing the field plot to be the mapped field rather than the unmapped field, at least for the time being.

------------------------------------------------------------------------
r337 | mdorr | 2009-11-17 15:38:15 -0800 (Tue, 17 Nov 2009) | 2 lines

Adding macro to turn off the spreading patch (default).

------------------------------------------------------------------------
r336 | rcohen | 2009-11-16 14:19:23 -0800 (Mon, 16 Nov 2009) | 2 lines

poloidally varying blob, with field solved turned on.  Set up to run one small step and stop.

------------------------------------------------------------------------
r335 | mdorr | 2009-11-16 14:17:17 -0800 (Mon, 16 Nov 2009) | 2 lines

Workaround for radial spreading mystery.

------------------------------------------------------------------------
r334 | rcohen | 2009-11-14 11:25:37 -0800 (Sat, 14 Nov 2009) | 2 lines

adding higher res. gam input deck

------------------------------------------------------------------------
r333 | mdorr | 2009-11-13 14:00:03 -0800 (Fri, 13 Nov 2009) | 2 lines

Removing spurious <

------------------------------------------------------------------------
r332 | rcohen | 2009-11-13 12:57:35 -0800 (Fri, 13 Nov 2009) | 2 lines

Changed fixed_dt to a stable value, had been set at 10000 to print out stable_dt.

------------------------------------------------------------------------
r331 | rcohen | 2009-11-13 12:42:42 -0800 (Fri, 13 Nov 2009) | 2 lines

low resolution banana test problem

------------------------------------------------------------------------
r330 | mdorr | 2009-11-13 12:11:08 -0800 (Fri, 13 Nov 2009) | 2 lines

Restructuring Miller geometry.  Moved the major radius back into the metric factors (in addition to the previous 2pi).  Deleted the overridden mappedGridDivergence.  Added spreader functions to spread the metric factors radially when a constant minor radius is requested.  Removed the no longer needed overridden getNMatrix entry.

------------------------------------------------------------------------
r329 | rcohen | 2009-11-13 10:06:05 -0800 (Fri, 13 Nov 2009) | 4 lines

vpar1.in has the same R and advection rate as vpar.in but the vparallel grid adjusted
so the blob is on a vparallel cell center.  vpar2.in is the same as vpar1.in but
the radius is doubled.

------------------------------------------------------------------------
r328 | mdorr | 2009-11-12 14:22:22 -0800 (Thu, 12 Nov 2009) | 2 lines

Adding no_drifts flag to the computation of BStarVParallel.

------------------------------------------------------------------------
r327 | rcohen | 2009-11-11 21:17:46 -0800 (Wed, 11 Nov 2009) | 4 lines

input file with a specified-vparallel blob.   Since Btor/Bpol = 4 for this deck, the specified
vparallel should correspond to v_pol = 1, so at r=0.5 a circuit should be made in pi time units.
For dt = 0.05, this should be about 30 steps.

------------------------------------------------------------------------
r326 | mdorr | 2009-11-10 09:52:53 -0800 (Tue, 10 Nov 2009) | 6 lines

Updating Miller geometry to multiply all fluxes by major radius before computing mapped grid divergence.

Moved latter part of GKSystem constructor to a separate initialize function so that restart data can be read in between.

Restructured IBC classes to better hand resetting of boundary data after restarts.

------------------------------------------------------------------------
r325 | mdorr | 2009-11-06 17:17:14 -0800 (Fri, 06 Nov 2009) | 2 lines

Fro Dan.

------------------------------------------------------------------------
r324 | mdorr | 2009-11-06 17:15:08 -0800 (Fri, 06 Nov 2009) | 2 lines

For Dan.

------------------------------------------------------------------------
r323 | mdorr | 2009-11-04 16:42:28 -0800 (Wed, 04 Nov 2009) | 2 lines

Adding pressure kernel.

------------------------------------------------------------------------
r322 | rcohen | 2009-11-04 05:27:09 -0800 (Wed, 04 Nov 2009) | 3 lines

Updated comment in GKSystem::iniitalToMapped to reflect the residual
question about an alternative to the now-working coding.

------------------------------------------------------------------------
r321 | rcohen | 2009-11-03 20:46:25 -0800 (Tue, 03 Nov 2009) | 6 lines

updated parameters to input files; added gam_per_notor_constr.in which is used
to run with radial periodicity, l_const_minorrad = 1 when NO_TOROIDAL is defined.
Added more #ifdef NO_TOROIDAL's to MillerMagGeom so as to more fully revert to pre-toroidal
version and also ensures that l_const_minorrad = 1 only affects calculation of field magnitudes
and gradients in the fortran.

------------------------------------------------------------------------
r320 | mdorr | 2009-11-03 17:06:12 -0800 (Tue, 03 Nov 2009) | 2 lines

Adding a switch to turn off toroidal metric modifications.

------------------------------------------------------------------------
r319 | rcohen | 2009-11-02 23:02:28 -0800 (Mon, 02 Nov 2009) | 3 lines

GKSystem modified to divide dfn by J to get physical dfn to hand to field
solver.  Input files modified to reflect cases I've recently run.

------------------------------------------------------------------------
r318 | mdorr | 2009-11-02 17:32:16 -0800 (Mon, 02 Nov 2009) | 2 lines

Changing default tolerances again.

------------------------------------------------------------------------
r317 | mdorr | 2009-11-02 17:21:53 -0800 (Mon, 02 Nov 2009) | 2 lines

ParmParsing linear solver tolerances and maximum iterations from input.

------------------------------------------------------------------------
r316 | mdorr | 2009-11-02 17:09:16 -0800 (Mon, 02 Nov 2009) | 2 lines

Relaxing solver default tolerances and max iterations.

------------------------------------------------------------------------
r315 | mdorr | 2009-11-02 16:16:58 -0800 (Mon, 02 Nov 2009) | 2 lines

Fixing broken ParmParsing of the maximum nonlinear iteration parameter.

------------------------------------------------------------------------
r314 | mdorr | 2009-11-02 15:56:05 -0800 (Mon, 02 Nov 2009) | 2 lines

Adding missing exchange before field calculation.

------------------------------------------------------------------------
r313 | rcohen | 2009-11-01 21:17:28 -0800 (Sun, 01 Nov 2009) | 2 lines

test deck illustrating radial periodicity problem

------------------------------------------------------------------------
r312 | rcohen | 2009-11-01 19:08:09 -0800 (Sun, 01 Nov 2009) | 3 lines

Updating these parameters to match minigam_nophi.in.   Except this does
variable timestep.

------------------------------------------------------------------------
r311 | rcohen | 2009-10-31 22:46:39 -0700 (Sat, 31 Oct 2009) | 4 lines

moving the multiplication of the initial (saved) distribution function by J, to
a more logical place, right after the initialization -- just in case the mapped
grids ever get a copy rather than a pointer to the initial condition.

------------------------------------------------------------------------
r310 | rcohen | 2009-10-31 22:22:19 -0700 (Sat, 31 Oct 2009) | 13 lines

Undid my hack which now uses Milo's conversions to and from mapped dist.fns (mult. by J)
and adds the corresponding multiplication of the initial distribution function, which is
used for t>0 for boundary conditions.  This required adding a new method to GKSystem,
including an accessor to get
the initial distribution function, which turns out to be analagous to the already existing
accessor for configuration-space fields.  Since we now have accessors for the initial fields
in both configuration space and phase space I added this accessor as a method in ICInterface.h,
which as it turns out is necessary in order to have an ic object from kinetic species which
has this accessor.   Changed name of config. space accessor in PhaseBC.H and where called
in MIonIBC.cpp to conform with the name in ICInterface (get_initial_soln).

Modified input files to have more interesting parameters.

------------------------------------------------------------------------
r309 | rcohen | 2009-10-31 08:20:46 -0700 (Sat, 31 Oct 2009) | 2 lines

corrected typo

------------------------------------------------------------------------
r308 | rcohen | 2009-10-31 08:19:06 -0700 (Sat, 31 Oct 2009) | 2 lines

better vparallelmax, mumax params

------------------------------------------------------------------------
r307 | rcohen | 2009-10-31 08:17:23 -0700 (Sat, 31 Oct 2009) | 2 lines

changed to non-periodic radial and not using const_minorrad

------------------------------------------------------------------------
r306 | rcohen | 2009-10-31 08:05:17 -0700 (Sat, 31 Oct 2009) | 3 lines

temporarily commenting out divide by J in converttophysical so results should
be the same as before introducing converttophysical

------------------------------------------------------------------------
r305 | mdorr | 2009-10-30 18:37:09 -0700 (Fri, 30 Oct 2009) | 2 lines

Adding a solution vector to contain the unmapped distribution functions (no Jacobian J factor).  This is used for computing densities for plotting and for passing to the field solver.  Added conversion routines for multiplying and dividing by J.

------------------------------------------------------------------------
r304 | jcompton | 2009-10-30 17:41:02 -0700 (Fri, 30 Oct 2009) | 2 lines

added restartable field histories (watchpoints)

------------------------------------------------------------------------
r303 | mdorr | 2009-10-29 23:29:15 -0700 (Thu, 29 Oct 2009) | 2 lines

Reverting metric modifications for toroidal symmetric.  All entries are again multiplied by 2piR.

------------------------------------------------------------------------
r302 | mdorr | 2009-10-29 17:03:28 -0700 (Thu, 29 Oct 2009) | 2 lines

Adding multiplication by J in the setInitialCondition.

------------------------------------------------------------------------
r301 | mdorr | 2009-10-29 13:05:17 -0700 (Thu, 29 Oct 2009) | 2 lines

Another Jacobian correction.

------------------------------------------------------------------------
r300 | mdorr | 2009-10-29 09:55:30 -0700 (Thu, 29 Oct 2009) | 2 lines

Fixing bug in phase space jacobian.

------------------------------------------------------------------------
r299 | rcohen | 2009-10-27 13:47:12 -0700 (Tue, 27 Oct 2009) | 2 lines

Adding hypre script for Mac OS X

------------------------------------------------------------------------
r298 | rcohen | 2009-10-27 12:13:22 -0700 (Tue, 27 Oct 2009) | 2 lines

Corrected typo

------------------------------------------------------------------------
r297 | rcohen | 2009-10-27 10:19:33 -0700 (Tue, 27 Oct 2009) | 2 lines

Properly conservative poloidal and radpol advection tests, in toroidal geometry

------------------------------------------------------------------------
r296 | rcohen | 2009-10-26 17:13:53 -0700 (Mon, 26 Oct 2009) | 3 lines

Gemeral class of Maxwellian electrons with passed-in class for spatial shape; it now compiles,
so remove the ".dev".

------------------------------------------------------------------------
r295 | rcohen | 2009-10-26 16:58:12 -0700 (Mon, 26 Oct 2009) | 2 lines

updating my development version not yet for general compilation

------------------------------------------------------------------------
r294 | rcohen | 2009-10-24 09:33:38 -0700 (Sat, 24 Oct 2009) | 2 lines

A class in development, adding .dev so it won't interfere with compilations

------------------------------------------------------------------------
r293 | rcohen | 2009-10-23 12:22:06 -0700 (Fri, 23 Oct 2009) | 2 lines

Updated parameters for comparison

------------------------------------------------------------------------
r292 | rcohen | 2009-10-21 23:05:40 -0700 (Wed, 21 Oct 2009) | 2 lines

constant poloidal advection test case

------------------------------------------------------------------------
r291 | rcohen | 2009-10-21 22:25:56 -0700 (Wed, 21 Oct 2009) | 2 lines

Added underscore to "history_frequency" so will parmparse correctly

------------------------------------------------------------------------
r290 | mdorr | 2009-10-21 17:51:07 -0700 (Wed, 21 Oct 2009) | 2 lines

Adding analytic calculation of cell volumes for the constant minor radius option.

------------------------------------------------------------------------
r289 | mdorr | 2009-10-21 10:48:05 -0700 (Wed, 21 Oct 2009) | 2 lines

Adding new switch to specify the Boltzmann prefactor option.  Also added a new option to enforce flux surface neutrality at the first step, then keep the prefactor fixed from then on.

------------------------------------------------------------------------
r288 | mdorr | 2009-10-20 15:15:03 -0700 (Tue, 20 Oct 2009) | 2 lines

Removing an exchange in MillerMagGeomCoordSys::defineFaceMetricTerms() that was causing trouble when radial periodicity was specified.

------------------------------------------------------------------------
r287 | rcohen | 2009-10-20 11:08:41 -0700 (Tue, 20 Oct 2009) | 3 lines

Removed unused cruft from MionIBC.  Added first cut at corresponding electron
class

------------------------------------------------------------------------
r286 | rcohen | 2009-10-20 00:19:17 -0700 (Tue, 20 Oct 2009) | 2 lines

Fixed brain-dead min f algorithm so now get correct min value of f

------------------------------------------------------------------------
r285 | rcohen | 2009-10-19 17:05:05 -0700 (Mon, 19 Oct 2009) | 2 lines

added default vparshift

------------------------------------------------------------------------
r284 | rcohen | 2009-10-19 13:21:07 -0700 (Mon, 19 Oct 2009) | 3 lines

Updated mingam.in to closely reproduce Xu's test input.   minigam_nophi.in
has spame parameters but not field solve.   For diagnostic of nan problem.

------------------------------------------------------------------------
r283 | rcohen | 2009-10-19 01:21:23 -0700 (Mon, 19 Oct 2009) | 3 lines

nx and ny must both be powers of 2.  Also got rid of a redundant setting of fixed_efield = false,
and added boltzmann_electron.name = "electron".

------------------------------------------------------------------------
r282 | rcohen | 2009-10-19 00:22:25 -0700 (Mon, 19 Oct 2009) | 2 lines

Turned off fixed_efield

------------------------------------------------------------------------
r281 | rcohen | 2009-10-19 00:15:32 -0700 (Mon, 19 Oct 2009) | 2 lines

hugely under-resolved GAM test setup.   Seems to give zero potential.  Why?

------------------------------------------------------------------------
r280 | rcohen | 2009-10-19 00:05:42 -0700 (Mon, 19 Oct 2009) | 5 lines

Fixed bugs in cosine initialization: hadn't divided by extent of radial domain in
radial phase factor; had n and T reversed in fortran function declarations; and was
using radial mode number in poloidal variation.  From the plots it now appears to
be OK.

------------------------------------------------------------------------
r279 | rcohen | 2009-10-18 01:32:35 -0700 (Sun, 18 Oct 2009) | 4 lines

A version of blob_radial.in that writes a history for the potential, even though
it is always zero for this input deck.  Just done to check the history-writing
logic

------------------------------------------------------------------------
r278 | rcohen | 2009-10-18 01:26:37 -0700 (Sun, 18 Oct 2009) | 6 lines

Removed bugs in history-writing methods; initialized class data relating to the history
files.   (What was in the archive since yesterday had uninitialized data that could
produce a math error if executed.)  Also updated the node search to reject node index
= desired index if the index lies in the ghost cells.  It would be better to iterate over
nodes of a box that excludes ghost cells.

------------------------------------------------------------------------
r277 | rcohen | 2009-10-17 01:23:38 -0700 (Sat, 17 Oct 2009) | 10 lines

GKSystem: coding to create instance of cosine-varying ion density added, using new
generic IonIBC class and CosSpatialIBC class for ion density and temperature.  Also added
code to print a field, and in particular potential, at a specified location.  The latter has not
yet been tested; I am preparing a test deck in preparation for a GAM run.

Simulation.cpp and .H are modified to read in parameters for a history dump of a spatial field at
a specified point.   It then calls the method in GKSystem.

CosSpatialIBC.H: a typo is removed from a comment card.

------------------------------------------------------------------------
r276 | mdorr | 2009-10-14 09:42:57 -0700 (Wed, 14 Oct 2009) | 2 lines

Yet one more attempt to correct the metric factor modifications for toroidal symmetry.  At least this gets us to second-order (!).

------------------------------------------------------------------------
r275 | dmartin | 2009-10-13 10:32:25 -0700 (Tue, 13 Oct 2009) | 2 lines

small fix -- if we're using the constant-radius approximation, then default back to the original FourthOrderCoordSys implementation of computeCellVolumes. Otherwise, use the version implemented in MillerMagGeomCoordSys to account for the curvature of our space.

------------------------------------------------------------------------
r274 | dmartin | 2009-10-13 01:40:46 -0700 (Tue, 13 Oct 2009) | 2 lines

over-ride FourthOrderCoordSys cell volume computation in order to use F= (0.5*R_major, 0,0), which has div=1 in the toroidal coordinates.  This gets volume computation up to 4th order.

------------------------------------------------------------------------
r273 | rcohen | 2009-10-12 19:06:27 -0700 (Mon, 12 Oct 2009) | 7 lines

Added proper metrics to the radial, poloidal, and radpol advection tests, and necessary
accessors to MagGeomCoordSys.H and MillerMagGeomCoordSys.H   Also removed a bug in
MillerMagGeomCoordSysF.ChF: rbar was being computed by averaging over the radii, but this
won't work in parallel.   rbar is now passed in to the appropriate functions and computed
in the  .cpp file as the average of the inner and outer radii.  Also my editor changed
indentation in one line of MillerMagGeomCoordSys.cpp.

------------------------------------------------------------------------
r272 | mdorr | 2009-10-09 19:00:28 -0700 (Fri, 09 Oct 2009) | 2 lines

Changing pointwiseJ() to accept a real space coordinate rather than mapped.

------------------------------------------------------------------------
r271 | mdorr | 2009-10-09 14:40:27 -0700 (Fri, 09 Oct 2009) | 2 lines

Changing ParmParse argument in the construct to a reference.

------------------------------------------------------------------------
r270 | rcohen | 2009-10-09 13:03:09 -0700 (Fri, 09 Oct 2009) | 2 lines

Removing unused files.  Now incorporated in MIonIBC.H, and will generate a MElecIBC.H soon.

------------------------------------------------------------------------
r269 | mdorr | 2009-10-09 12:21:58 -0700 (Fri, 09 Oct 2009) | 2 lines

Adding the major radius to the metric factors, which I had previously forgotten are stored as face averages (for about the twelfth time, I think).  The cell volumes should now be computed automatically (computeCellVolumes() is no longer overridden in the magnetic geometry FOCS).  pointwiseJ() remains overriden, however, to include the major radius.

------------------------------------------------------------------------
r268 | rcohen | 2009-10-09 01:40:39 -0700 (Fri, 09 Oct 2009) | 2 lines

Removing files no longer used

------------------------------------------------------------------------
r267 | rcohen | 2009-10-09 01:38:49 -0700 (Fri, 09 Oct 2009) | 19 lines

Added generic Maxwellian Ion initialization MIonIBC.cpp and .H,
which gets its density and temperature
profiles from density and temperature instances of spatial-field classes.  So far
only CosSpatialIBC.cpp has been adapted to work with this, but the modification
to any of the other classes in ibc/configuration is trivial: add the two extra
parameters a_doaverage and a_positivity to the constructor,  and corresponding
class members m_doaverage and m_positivity, and appropriate flags so m_doaverage
controls whether the 4th order average is done (NOT done for density and temperature
used to set up point values of a distribution function) and m_positivity = 1 causes
a test of the model parameters  positive-definiteness of the field.

SpatialBC.H is modified to add a method to return a levelData with the initialized
field.

CosSpatialF.ChF.notused is the so-far unused fortran initialization for the spatial cosine class
(the initialization for now is done in C++).

Removed no-longer-used files.

------------------------------------------------------------------------
r266 | rcohen | 2009-10-07 17:57:59 -0700 (Wed, 07 Oct 2009) | 4 lines

Experimental and troublesome files for initializing 2D cosine spatial dependence
for temperature and density.  Suffixes added so they will not by default be included
in the compile.    The .H files seem OK.

------------------------------------------------------------------------
r265 | rcohen | 2009-10-07 17:41:41 -0700 (Wed, 07 Oct 2009) | 3 lines

Corrected assorted errors in the cosine initializations, and some corrections to
comments in theLocalized and Tanh files.

------------------------------------------------------------------------
r264 | mdorr | 2009-10-07 16:40:43 -0700 (Wed, 07 Oct 2009) | 2 lines

Correcting cell volumes and jacobian J for toroidal geometry.  Corrected calculation of the major radius when the constant minor radius option is selected to also work for non-circular annular poloidal sections.

------------------------------------------------------------------------
r263 | dmartin | 2009-10-07 01:42:06 -0700 (Wed, 07 Oct 2009) | 2 lines

couple of changes to try to implement Ron's periodic-in-R torus case. Still not uite correct... (but should default back to original behavior unless the constant-radius approximation is turned on)

------------------------------------------------------------------------
r262 | dmartin | 2009-10-07 01:40:55 -0700 (Wed, 07 Oct 2009) | 2 lines

added #ifdef CH_MULTIDIM around body of FluxSurface, since this file only compiles if we're doing a multidim build

------------------------------------------------------------------------
r261 | rcohen | 2009-10-06 16:43:46 -0700 (Tue, 06 Oct 2009) | 2 lines

Removed diagnostic printout line that would print lots of multiples of "GOT HERE" messages.

------------------------------------------------------------------------
r260 | rcohen | 2009-10-06 16:14:12 -0700 (Tue, 06 Oct 2009) | 3 lines

Put in mods that should, if the flag l_const_minorrad is set, remove minor-radius dependence
from the computation of dXdXi and the N matrix (replaces r by r_average).

------------------------------------------------------------------------
r259 | mdorr | 2009-10-05 09:34:15 -0700 (Mon, 05 Oct 2009) | 2 lines

Fixing test on number of ghost cells.

------------------------------------------------------------------------
r258 | rcohen | 2009-10-02 20:15:23 -0700 (Fri, 02 Oct 2009) | 2 lines

Deck to check stable_dt scaling

------------------------------------------------------------------------
r257 | rcohen | 2009-10-02 17:05:06 -0700 (Fri, 02 Oct 2009) | 4 lines

Took care of missing definition of m_ghostVect in first constructor.   May need to remove
the definition in the Define method to avoid a possible inconsistency.   Need Milo's judgement
on this.

------------------------------------------------------------------------
r256 | rcohen | 2009-10-02 15:53:34 -0700 (Fri, 02 Oct 2009) | 2 lines

A purely radial advection test

------------------------------------------------------------------------
r255 | rcohen | 2009-10-02 14:40:02 -0700 (Fri, 02 Oct 2009) | 3 lines

Smaller timestep for tomtest; new blob_radpol.in has blob propagating
radially and poloidally

------------------------------------------------------------------------
r254 | jcompton | 2009-10-01 18:56:48 -0700 (Thu, 01 Oct 2009) | 2 lines

store potential correctly in checkpoint files

------------------------------------------------------------------------
r253 | rcohen | 2009-10-01 16:34:55 -0700 (Thu, 01 Oct 2009) | 3 lines

Added a method to do a fixed advection simultaneously in radius and
poloidal angle, to test oblique advection.

------------------------------------------------------------------------
r252 | bolson | 2009-09-29 20:50:36 -0700 (Tue, 29 Sep 2009) | 2 lines

added plot prefix and species type to plot file names, removed dummy plot file

------------------------------------------------------------------------
r251 | mdorr | 2009-09-29 14:34:22 -0700 (Tue, 29 Sep 2009) | 2 lines

Minor edit.

------------------------------------------------------------------------
r250 | mdorr | 2009-09-29 13:33:55 -0700 (Tue, 29 Sep 2009) | 2 lines

Added a momentum density moment calculation member to KineticSpecies.  This required the creation of a new MomentDensityKernel, the source for which is contained in the newly created Kernels.cpp file.  The trivial number and charge density kernels were moved there as well, so we have all the kernels in one place.

------------------------------------------------------------------------
r249 | rcohen | 2009-09-25 15:53:00 -0700 (Fri, 25 Sep 2009) | 2 lines

Oops, previous commit had some duplicate definitions, fixed here.

------------------------------------------------------------------------
r248 | rcohen | 2009-09-25 15:38:59 -0700 (Fri, 25 Sep 2009) | 2 lines

Re-inserted a comment

------------------------------------------------------------------------
r247 | dmartin | 2009-09-25 02:29:26 -0700 (Fri, 25 Sep 2009) | 2 lines

returned to using common-code implementations of parts of the advection scheme (located in Chombo/example/fourthOrderMappedGrids/advection)

------------------------------------------------------------------------
r246 | mdorr | 2009-09-24 15:05:40 -0700 (Thu, 24 Sep 2009) | 2 lines

Changes mostly related to trimming off ghost cells.

------------------------------------------------------------------------
r245 | rcohen | 2009-09-21 10:44:01 -0700 (Mon, 21 Sep 2009) | 2 lines

Corrected species number errors

------------------------------------------------------------------------
r244 | rcohen | 2009-09-17 17:20:16 -0700 (Thu, 17 Sep 2009) | 10 lines

Made the necessary modifications to use the multidim versions of
IBCInterface.H, ICInterface.H, BCInterface.H.   Removed spurious calls to
m_params_are_set in the spatial ibc classes .   Added the invocation of the potential
initialization in GKSystem.    Created a new small input file, tomsmall_ke.in, that
exercises the potential setting and running with kinetic electrons.  Have not yet verified
that it actually does correct physics...

Remaining to do: add the flags so that the potential does NOT get recomputed at t=0,
and provide ability to plot potentials when the potential is specified rather than computed.

------------------------------------------------------------------------
r243 | rcohen | 2009-09-17 15:44:31 -0700 (Thu, 17 Sep 2009) | 3 lines

Removing ancient Maxwellian intialization files that haven't been used in months.
Modifying PhaseBC.H to use the multim form of IBCInterface.

------------------------------------------------------------------------
r242 | mdorr | 2009-09-17 14:28:53 -0700 (Thu, 17 Sep 2009) | 2 lines

Adding multidim wrappers for IC, BC and IBC headers.

------------------------------------------------------------------------
r241 | rcohen | 2009-09-15 15:21:34 -0700 (Tue, 15 Sep 2009) | 9 lines

Added localized (blob) initialization for potential, and corrected cosine initialization.  Did the
explicit copy of a_field to m_field (previously lacking) in TanhSpatialIBC.cpp.   Not sure why cvs
thinks that TanhSpatialIBC.H is updated; the diff lines seem to be identical.

I've added a parameter to read in GKSystem,  IBC.potential_type, to set what type of potential to
initialize.  Allowed values willl be "zero", "cosine", "tanh", and "localized".    This should be in
documentation somewhere via comments in a .H file but I'm not sure what .H file.  GKSystem.H?
This gets at our general lack of organized documentation.

------------------------------------------------------------------------
r240 | dmartin | 2009-09-04 17:15:31 -0700 (Fri, 04 Sep 2009) | 2 lines

unwound refactoring of common advection parts I did in July, because there appears to be a bug in that (based on the test code results). Reverted to the initial implementation, which I have more confidence in.

------------------------------------------------------------------------
r239 | rcohen | 2009-09-04 12:20:09 -0700 (Fri, 04 Sep 2009) | 8 lines

Added files/classes to initialize const + cosine initialization of a spatial field (e.g. the potential).
This is in anticipation of GAM tests.   I have not yet wired this class into GKSystem.

Also modified TanhSpatialIBC.cpp and TanhSpatialIBC.H to provide more accurate comment
statements (old ones referred in some places to initialization of distribution funcion); removed
positivity check on the input parameters (since the spatial field being initialized need not be
positive definite).

------------------------------------------------------------------------
r238 | jcompton | 2009-09-03 18:44:33 -0700 (Thu, 03 Sep 2009) | 2 lines

enable checkpoint files to be written and read for restart capability

------------------------------------------------------------------------
r237 | rcohen | 2009-08-31 13:00:27 -0700 (Mon, 31 Aug 2009) | 6 lines

Added coding to include gyrokinetic polarization density in electron density initialization
(used for kinetic electrons), and necessary changes to interface invocation in GKSystem.
All that I have verified so far is that this does not impact ion-only runs.   Next step is to
actually test the electron initialization, with zero potential and then with a prescribed
potential.

------------------------------------------------------------------------
r236 | mdorr | 2009-08-31 11:30:18 -0700 (Mon, 31 Aug 2009) | 4 lines

Fixing HYPRE_LOC to point to a soft link.

Added the new util directory to all of the dimensional src macros.

------------------------------------------------------------------------
r235 | mdorr | 2009-08-31 11:07:48 -0700 (Mon, 31 Aug 2009) | 2 lines

Adding functionality to invert the injection of configuration space data to phase space.  This is needed for restarting, since are only saving phase space data currently.

------------------------------------------------------------------------
r234 | mdorr | 2009-08-31 10:40:45 -0700 (Mon, 31 Aug 2009) | 2 lines

Just removing something I didn't mean to check in.

------------------------------------------------------------------------
r233 | mdorr | 2009-08-31 10:30:26 -0700 (Mon, 31 Aug 2009) | 2 lines

Adding a util directory, and some simple functions to facilitate looking at FArrayBox, FluxBox and LevelData objects in TotalView.

------------------------------------------------------------------------
r232 | mdorr | 2009-08-27 10:20:36 -0700 (Thu, 27 Aug 2009) | 2 lines

Removing J factor from flux shell integrals.  The quantities being integrated are already cell-averaged, so all we have to do is sum them.

------------------------------------------------------------------------
r231 | mdorr | 2009-08-26 18:05:33 -0700 (Wed, 26 Aug 2009) | 6 lines

Adding the Poisson-Boltzmann solver.

The BoltzmannElectron class was moved from the poisson directory to the species directory, where it was originally.

A file blob_test_boltzmann.in invoking the Poisson-Boltzmann solver was added to the inputs directory.

------------------------------------------------------------------------
r230 | rcohen | 2009-08-18 10:37:27 -0700 (Tue, 18 Aug 2009) | 9 lines

Added option which enables radially periodic pseudo-Miller geometry: replaces
minor radius by its radial average in geometric quantities (field magnitude,
gradients, etc).  Note this option introduces a small non-zero div B; this is
unavoidable.  A document will be forthcoming explaining this.

To activate, add a parameter l_const_minorrad to the Miller geometry input deck
section, and set its value to 1.  (If not set the default of 0, for normal Miller geometry,
is used).

------------------------------------------------------------------------
r229 | dmartin | 2009-07-28 15:39:44 -0700 (Tue, 28 Jul 2009) | 2 lines

re-ordered some initializations to match the order in which they're defined in the header file (to get the compiler to stop telling me that they're out of order)

------------------------------------------------------------------------
r228 | dmartin | 2009-07-28 15:38:33 -0700 (Tue, 28 Jul 2009) | 2 lines

removed semicolon after #ifdef CH_MPI

------------------------------------------------------------------------
r227 | dmartin | 2009-07-28 15:01:16 -0700 (Tue, 28 Jul 2009) | 2 lines

starting to factor out fourth-order advection stuff and switch to using common implementations which are (for now, at least) in Chombo/example/fourthOrderMappedGrids/advection

------------------------------------------------------------------------
r226 | dmartin | 2009-07-28 14:58:27 -0700 (Tue, 28 Jul 2009) | 3 lines

1. added ../src/collisions to 4d source directories (won't compile otherwise)
2. added a UNAMEN variable (= "uname -n") which makes machine-dependent hypre locations simpler (so that I won't have to keep modifying the path to various hypre locations)

------------------------------------------------------------------------
r225 | dmartin | 2009-07-27 16:32:35 -0700 (Mon, 27 Jul 2009) | 2 lines

reorder member data initialization to match order in GKSystem.H so that g++ will stop bugging me about it.

------------------------------------------------------------------------
r224 | mdorr | 2009-07-24 17:59:54 -0700 (Fri, 24 Jul 2009) | 2 lines

Adding collision directory.

------------------------------------------------------------------------
r223 | mdorr | 2009-07-24 17:45:19 -0700 (Fri, 24 Jul 2009) | 2 lines

Adding hook for collisions.

------------------------------------------------------------------------
r222 | dmartin | 2009-07-24 10:47:41 -0700 (Fri, 24 Jul 2009) | 2 lines

added non-mpi config file for my laptop

------------------------------------------------------------------------
r221 | dmartin | 2009-07-24 09:24:58 -0700 (Fri, 24 Jul 2009) | 2 lines

makefile now points to Chombo/example/fourthOrderMappedGrids/advection for advection stuff

------------------------------------------------------------------------
r220 | mdorr | 2009-07-15 11:30:33 -0700 (Wed, 15 Jul 2009) | 2 lines

Adding a function to apply the GK Poisson operator to an arbitrary vector.  This iwll be needed for the GAM tests to compute an initial perturbation from a neutral state.

------------------------------------------------------------------------
r219 | mdorr | 2009-07-10 18:56:19 -0700 (Fri, 10 Jul 2009) | 2 lines

Fixing some bugs in the GKPoisson matrix.  The matrix density contribution is currently turned off until I can add a routine to 4th-order interpolate the density to boundary faces.

------------------------------------------------------------------------
r218 | mdorr | 2009-07-09 17:42:00 -0700 (Thu, 09 Jul 2009) | 4 lines

Redoing the setting of periodic boundaries.  Previously, the periodicity of configuration space was determined by the magnetic geometry object, regardless of the setting of the gksystem.is_periodic array in the input file.  This is no longer the case; periodicity is now controlled entirely through the input file array.  This means that it is now the user's responsibility to ensure that the input periodicity is specified consistently with the desired magnetic geometry.

I also modified the GKPoisson solver to subtract the right-hand side average (forcing global charge neutrality) for fully periodic domains, which is necessary for solvability and the convergence of PCG.

------------------------------------------------------------------------
r217 | rcohen | 2009-05-27 14:27:15 -0700 (Wed, 27 May 2009) | 2 lines

Refactoring of spatial bc's

------------------------------------------------------------------------
r216 | rcohen | 2009-05-27 14:01:19 -0700 (Wed, 27 May 2009) | 2 lines

factored version of LocalzedIBC

------------------------------------------------------------------------
r215 | rcohen | 2009-05-27 13:33:54 -0700 (Wed, 27 May 2009) | 8 lines

Refactored MTanhElecIBC, MTanhIonIBC.   The common BC methods are now in PhaseBC.cpp.
MTanhElecIBC and MTanhIonIBC inherit from PhaseBC, which inherits from IBCInterface.

We could probably stand some additional refactoring in which MTanhElecIBC and MTanhIonIBC
would inherit from something like MaxwellianIBC which would set the common velocity-space
dependence and allow for various configuration space initializations via inheritance.  But this is
saved for a later day.

------------------------------------------------------------------------
r214 | mdorr | 2009-05-21 21:58:37 -0700 (Thu, 21 May 2009) | 2 lines

Restoring the option of saving the velocity computation when the field solve is not being performed.

------------------------------------------------------------------------
r213 | rcohen | 2009-05-20 08:23:50 -0700 (Wed, 20 May 2009) | 2 lines

Added hooks to get the needed plots with the recent versions of the code

------------------------------------------------------------------------
r212 | rcohen | 2009-05-20 08:17:23 -0700 (Wed, 20 May 2009) | 2 lines

longer run of Tom's test

------------------------------------------------------------------------
r211 | mdorr | 2009-05-19 11:09:37 -0700 (Tue, 19 May 2009) | 2 lines

A field solve test problem.

------------------------------------------------------------------------
r210 | mdorr | 2009-05-19 11:08:51 -0700 (Tue, 19 May 2009) | 2 lines

Adding a HYPRE_LOC macro and corresponding additions to the XTRA includes and libraries.

------------------------------------------------------------------------
r209 | mdorr | 2009-05-19 11:07:38 -0700 (Tue, 19 May 2009) | 10 lines

Adding GK Poisson solve.

Because this solver uses Hypre, it will now be necessary to checkout Hypre from the repo, configure and build it.  Even if the problem being run does not need a field solve, header files will still be required in order to compile.  So, in the directory that contains ESLCode and Chombo, do

cvs checkout hypre

Then, cd to the newly created hypre directory.  Modify the example doconfig* script to suit your platform, execute it to run autoconf, then run the doinstall script.

You will also need to update the HYPRE_LOC macro in ESLCode/exec/GNUMakefile.multidim to point to the library you just created.

------------------------------------------------------------------------
r207 | mdorr | 2009-05-18 16:47:42 -0700 (Mon, 18 May 2009) | 2 lines

Adding Hypre to the repo in preparation for adding the field solve to the ESLCode.  This version of Hypre has been slightly modified from the official v2.0.0 distribution.  The fourth-order discretization of the gyrokinetic Poisson operator results in a bigger stencil than the current Hypre structured multigrid solvers can handle.  We therefore use a preconditioner based on a second-order discretization with smaller stencil.  A slight modification of the PCG setup was required to pull this off.

------------------------------------------------------------------------
r206 | rcohen | 2009-05-18 15:16:59 -0700 (Mon, 18 May 2009) | 2 lines

Larger dt and max time

------------------------------------------------------------------------
r205 | rcohen | 2009-05-18 11:16:08 -0700 (Mon, 18 May 2009) | 3 lines

Restored TanhSpatialIBC to its state prior to refactoring, as the refactoring needs
more thought.

------------------------------------------------------------------------
r204 | rcohen | 2009-05-18 10:51:40 -0700 (Mon, 18 May 2009) | 2 lines

Added specification of which variables to write into HDF files

------------------------------------------------------------------------
r203 | rcohen | 2009-05-18 10:17:25 -0700 (Mon, 18 May 2009) | 2 lines

Example input file which now has the controls for what hdf's are written

------------------------------------------------------------------------
r202 | rcohen | 2009-05-18 10:15:35 -0700 (Mon, 18 May 2009) | 3 lines

Added safeguards to exit with error message if one attempts to write an HDF5 file
at an out-of-bounds index

------------------------------------------------------------------------
r201 | rcohen | 2009-05-18 09:21:32 -0700 (Mon, 18 May 2009) | 2 lines

Put in missing end-of-comment */ line.

------------------------------------------------------------------------
r200 | rcohen | 2009-05-18 01:40:18 -0700 (Mon, 18 May 2009) | 3 lines

Corrected error in documentation: spaces rather than commas required for specification
of gksystem.fixed_plot_indices

------------------------------------------------------------------------
r199 | rcohen | 2009-05-18 01:28:07 -0700 (Mon, 18 May 2009) | 11 lines

Added input variables to control what HDF5 files are made (For plotting) instead of
hard-wiring; also added input to control what phase space indices are held fixed when
f is to be plotted versus two indices with others held fixed.  This is now documented
in GKSystem.H and so should show up in doxygen documentation.   The new coding uses
query commands so defaults are used if lines are not added to .in files.  The defaults are,
plot density, don't plot either of the two distribution function files; and, if plot distribution
function, the default (irad, ipol, itor, ivpar, imu) is 0 0 0 0 0.   I should add checks that the
specified indices are within bounds.  Not done yet.  Also I haven't checked in any input
files that actually specify any of these hdf5 generating options, but it appears that they
do work.  Will check in examples tomorrow.

------------------------------------------------------------------------
r198 | rcohen | 2009-05-17 23:35:09 -0700 (Sun, 17 May 2009) | 3 lines

Commented out print statement that will attempt to access bad memory if run in
parallel.   Use for serial debugging only.

------------------------------------------------------------------------
r197 | rcohen | 2009-05-15 15:43:23 -0700 (Fri, 15 May 2009) | 3 lines

Banana motion of localized blob.  Seems to create infiniband errors
routinely on smaug when writing to hdf5.

------------------------------------------------------------------------
r196 | rcohen | 2009-05-15 15:32:26 -0700 (Fri, 15 May 2009) | 2 lines

Added 1.0 * to sqrt (nproc) arguments so compiler on grendel is happy

------------------------------------------------------------------------
r195 | rcohen | 2009-05-15 09:31:10 -0700 (Fri, 15 May 2009) | 2 lines

Oops, forgot to add the second inheritance on CommonBC.  Fixed

------------------------------------------------------------------------
r194 | rcohen | 2009-05-15 09:06:17 -0700 (Fri, 15 May 2009) | 6 lines

Reorganized to put the common methods for configuration space boundary conditions
into a separate class from which TanhSpatialIBC derives.  This will allow other spatial
initializations to share the same BC methods without recoding.   THis is a warm-up
exercise to doing the same thing in the phase directory.   As previously the BC methods
allow only for periodic or Dirichlet.

------------------------------------------------------------------------
r193 | rcohen | 2009-05-13 21:11:36 -0700 (Wed, 13 May 2009) | 4 lines

Updated MillerMagGeomCoordSysF.ChF to follow the simpler cylindrical coordinate derivation.
So far I have minimally tested this on a low resolution run.
The previous F.ChF file is committed now as ...F.ChF.previous

------------------------------------------------------------------------
r192 | rcohen | 2009-05-07 07:12:58 -0700 (Thu, 07 May 2009) | 2 lines

Prettied up indentation in the divide by Bstarpar.

------------------------------------------------------------------------
r191 | dmartin | 2009-05-06 23:54:36 -0700 (Wed, 06 May 2009) | 2 lines

fixed creation of temporary for dfn = soln_dfn/BStarParallel so that we're not trashing soln_dfn every time we write plotfiles

------------------------------------------------------------------------
r190 | dmartin | 2009-05-06 23:26:53 -0700 (Wed, 06 May 2009) | 2 lines

removed extra ".hdf5" from filename specification, which was apparently confusig visit's mapping macro

------------------------------------------------------------------------
r189 | dmartin | 2009-05-06 22:08:20 -0700 (Wed, 06 May 2009) | 3 lines

added
#include <limits>

------------------------------------------------------------------------
r188 | rcohen | 2009-05-06 08:45:43 -0700 (Wed, 06 May 2009) | 3 lines

Re-added Milo's cout timestep print statement so one can see the progress
without opening a pout file

------------------------------------------------------------------------
r187 | dmartin | 2009-05-05 18:45:58 -0700 (Tue, 05 May 2009) | 2 lines

added factor of two to multiplier in limiter to bring into sync with Colella-Sekora.

------------------------------------------------------------------------
r186 | dmartin | 2009-05-05 18:19:37 -0700 (Tue, 05 May 2009) | 4 lines

implemented DisjointBoxLayout-derived class which allows access to the ProblemDomain (implemented in IBCInterface.H). This allows a prototype of Ron's partial-periodic BC. The idea is to grab the ProblemDomain, switch it to periodic, do an exchange, switch it back to non-periodic (very important step), and then do the non-periodic portion of the boundary.

This is a non-pretty temporary approach which will be superceded when we've got multiblock up and running.

------------------------------------------------------------------------
r185 | dmartin | 2009-05-05 18:14:47 -0700 (Tue, 05 May 2009) | 2 lines

added m_cfl member data, along with ability to set it from the inputs file. (default is 1.0)

------------------------------------------------------------------------
r184 | dmartin | 2009-05-05 17:08:01 -0700 (Tue, 05 May 2009) | 4 lines

oops -- blindly growing the required number of limited face values to 2 in all directions resulted in stepping out of bounds.

Implemented normalGrow and transverseGrow parameters in the limiter, and then resized all temp boxes to their proper sizes based on these parameters. At the moment, normalGrow = 0 (no extra faces in the normal direction) and transverseGrow  = 2 (due to the requirements of the two 4th-order multiplications)

------------------------------------------------------------------------
r183 | dmartin | 2009-05-05 01:58:53 -0700 (Tue, 05 May 2009) | 2 lines

re-ordered initializations in constructor to match the ordering in the .H file to quiet some annoying compiler warnings.

------------------------------------------------------------------------
r182 | dmartin | 2009-05-05 01:46:44 -0700 (Tue, 05 May 2009) | 3 lines

1. extended limiter computation out to 2 ghost layers rather than one, since that's what we need for the mapped-grid code
2. re-instated bogus-value setting of non-limited values, since that's what alerted us to the fact that we weren't limiting a wide enough domain.

------------------------------------------------------------------------
r181 | rcohen | 2009-05-04 22:23:12 -0700 (Mon, 04 May 2009) | 5 lines

Commenting out diagnostic printout from MTanhIonIBC.cpp and PoloidalIBC.ChF.
Adding comment about presently unused FluxBC in MTanhIonIBC.cpp.   Putting corrected
code for setBoundary that has been in MTanhIonIBC.cpp into MTanhElecIBC.cpp.
Commenting out extra timestep print statement in Simulation.cpp

------------------------------------------------------------------------
r180 | dmartin | 2009-05-04 17:52:37 -0700 (Mon, 04 May 2009) | 2 lines

commented out ill-advised setval(100000) which was creeping into the solution for Ron's test case. Need to go back and fix it right, but commenting it out rightnow at least keeps the solution values reasonable

------------------------------------------------------------------------
r179 | dmartin | 2009-05-04 13:09:54 -0700 (Mon, 04 May 2009) | 4 lines

switched number of ghost cells in m_phi from 3->4 to match up with everything else. This fixes the out-of-bounds in fortran which was occurring in set_poloidal_bc.

This is not meant to be an endorsement of this change as the correct thing to do -- it's just less wrong (were "less wrong" may also be "correct")

------------------------------------------------------------------------
r178 | rcohen | 2009-05-04 00:08:14 -0700 (Mon, 04 May 2009) | 22 lines

LocalizedIBC.cpp has fixes to poloidal  setBoundaryValues so that it will execute (though with
bogus values next to boundary).   This coding is not executed for poidally periodic b.c.'s

MTanhIonIBC.cpp has the same fixes, as well as Dan's fluxBC (which in this check-in is not
being used).  It also has some commented out print statements.

MillerMagGeomCoorSys shows no difference with cvs diff -rHEAD.  I don't know why it appears
as a modified file.

GKVlasov.cpp, added lines (but commented out) to invoke Dan's fluxBC.

MTanhIonIBC.H and BCInterface.H have headers for Dan's fluxBC function.

The new input file, blob_const_rvpol_polnonper.in is a script for debugging: a small probem with
poloidal periodicity set to zero, and a blob initially localized far away from the poloidal boundary.
It also sets phase_space_mapping.velocity_type to "annular_poloidal_velocity".  RUNNING this
input file exposes the bug near the poloidal boundary, a large increment to the first
poloidal cell in from the boundary, by an amount that is proportional to timestep and roughly
the cube of the poloidal cell size. This increment appears to be independent of the value of
f in neighboring cells, and is there even for this test problem where f is very close to zero
everywhere around the poloidal boundary.

------------------------------------------------------------------------
r177 | rcohen | 2009-04-30 14:32:03 -0700 (Thu, 30 Apr 2009) | 4 lines

Modified MTanhIonIBC.cpp so that upper bounding box is passed to Fortran for
poloidal upper limit.   Modified MTanhElectronIBC.cpp to replicate this
correction and the earlier ones made by Dan to MTanhIon...

------------------------------------------------------------------------
r176 | dmartin | 2009-04-30 13:39:51 -0700 (Thu, 30 Apr 2009) | 2 lines

fixed a couple of bugs in the flippedGrids stuff

------------------------------------------------------------------------
r175 | rcohen | 2009-04-30 12:59:29 -0700 (Thu, 30 Apr 2009) | 2 lines

a GKSystem which uses the periodic directions from the input deck to set up the ProblemDomain.

------------------------------------------------------------------------
r174 | rcohen | 2009-04-30 11:52:29 -0700 (Thu, 30 Apr 2009) | 2 lines

small-grid test of toroidal limiter

------------------------------------------------------------------------
r173 | dmartin | 2009-04-30 10:24:07 -0700 (Thu, 30 Apr 2009) | 2 lines

defer definition of flippedData LevelData until after flippedGrids are defined

------------------------------------------------------------------------
r172 | rcohen | 2009-04-30 08:59:54 -0700 (Thu, 30 Apr 2009) | 3 lines

Checking in code with commented-out print statements which can be
used to help diagnose periodicity issue

------------------------------------------------------------------------
r171 | dmartin | 2009-04-30 00:12:22 -0700 (Thu, 30 Apr 2009) | 2 lines

re-ordered initializations in constructor to match the order in the header file (so that the g++ compiler will stop nagging me...)

------------------------------------------------------------------------
r170 | rcohen | 2009-04-29 11:16:44 -0700 (Wed, 29 Apr 2009) | 2 lines

modified plot f vs r, theta at fixed vparallel, mu to actually plot f, not f*BStarParallel

------------------------------------------------------------------------
r169 | rcohen | 2009-04-28 23:27:02 -0700 (Tue, 28 Apr 2009) | 2 lines

Parameters used for Sherwood run, longer time than before.

------------------------------------------------------------------------
r168 | rcohen | 2009-04-28 22:55:37 -0700 (Tue, 28 Apr 2009) | 3 lines

Added invocation of plot of r vs theta at fixed vparallel, mu for Tom's test case.
My initial testing at very low resolution shows slightly negative f developing.

------------------------------------------------------------------------
r167 | rcohen | 2009-04-28 19:22:55 -0700 (Tue, 28 Apr 2009) | 5 lines

Removed the if 0's that were preventing the b.c.'s from being applied.
Also added an inspect function to MTanhIBCF.ChF, which I used for diagnosis
but is now not used.  Note it has print statements in it, so be careful if you
try it.

------------------------------------------------------------------------
r166 | rcohen | 2009-04-28 11:53:18 -0700 (Tue, 28 Apr 2009) | 2 lines

Better choices for upper limits of vparallel and mu

------------------------------------------------------------------------
r165 | rcohen | 2009-04-28 10:46:59 -0700 (Tue, 28 Apr 2009) | 4 lines

Moved multiplication of f by BStarPar to initialize of MTanhIonIBC and MTanhElecIBC.  Did
the multiplication before the copy to m_initial_dfn, so that the saved i.c.'s (used for
boundary conditions) are also multiplied.

------------------------------------------------------------------------
r164 | rcohen | 2009-04-28 08:38:32 -0700 (Tue, 28 Apr 2009) | 3 lines

Better input parameters for Tom's test; and modified filling of mu ghost cells
in MTanhIBC

------------------------------------------------------------------------
r163 | rcohen | 2009-04-27 19:14:19 -0700 (Mon, 27 Apr 2009) | 15 lines

Added mass to IBC constructor; corrected normalization factors in Maxwellians:
(m/2)^(3/2) in pre-exponential factor; mass multiplying vparallel squared in
exponent.  Also added the charge to the IBC constructor; was hard-wired
to 1 before.

Note there is a mass factor in the electron IBC class.  It is for now set to 1, which
implies a different choice for normalizing mass for electrons than ions, which is
reasonable but is not the only possible choice.  In particular the implied choice is
that the normalizing mass for electrons is the electron mass.  Alternatively it
could be set to be the same as for the ions, in which case the electron mass
should be set to 1/the normalizing ion mass.  This choice impacts how the
range of vparallel for electrons should be taken.  The choice of normalizing
electron mass = 1 allows the same set of vparallels to be used for electrons
and ions.

------------------------------------------------------------------------
r162 | mdorr | 2009-04-27 14:02:57 -0700 (Mon, 27 Apr 2009) | 2 lines

Removing temporary diagnostic (previously commented out).

------------------------------------------------------------------------
r161 | mdorr | 2009-04-27 13:59:46 -0700 (Mon, 27 Apr 2009) | 2 lines

Removing residual J reference in setInitialCondition.

------------------------------------------------------------------------
r160 | mdorr | 2009-04-27 13:56:58 -0700 (Mon, 27 Apr 2009) | 2 lines

Fixing distribution function normalization to agree with that in Table 2 of the model document.

------------------------------------------------------------------------
r159 | rcohen | 2009-04-27 13:38:33 -0700 (Mon, 27 Apr 2009) | 10 lines

Added 1/2**(3/2) to normalization of Maxwellian.

Removed spurious B that I had
added to GKUNit's distribution function normalization -- or should I? Is this used
as the normalization for f or for B*f?  If it is for f the B should be there. if for Bf, then
not.   Also need to figure out if the pi should be there.

Removed or commented out most of the printouts from MTanh... files, as these were
causing index address errors in parallel.

------------------------------------------------------------------------
r158 | mdorr | 2009-04-27 12:48:47 -0700 (Mon, 27 Apr 2009) | 2 lines

Replacing LevelData copy constructor in computeIntegrand() with explicit loop over box and copies.

------------------------------------------------------------------------
r157 | mdorr | 2009-04-27 12:28:32 -0700 (Mon, 27 Apr 2009) | 2 lines

Multiplying initial conditions by BStarParallel.  Removed previous multiplication by J.

------------------------------------------------------------------------
r156 | rcohen | 2009-04-26 20:36:57 -0700 (Sun, 26 Apr 2009) | 3 lines

Linear extrapolation of f to negative mu.   And a low-resolution test case
for "Tom's problem"

------------------------------------------------------------------------
r155 | rcohen | 2009-04-26 13:18:39 -0700 (Sun, 26 Apr 2009) | 2 lines

Corrected dimensions of distribution function

------------------------------------------------------------------------
r154 | rcohen | 2009-04-26 13:14:47 -0700 (Sun, 26 Apr 2009) | 3 lines

Committing versions with diagnostic print statements.   There are min and max
values of f are 0 and something huge; apparently an indexing probem somewhere.

------------------------------------------------------------------------
r153 | rcohen | 2009-04-26 12:16:34 -0700 (Sun, 26 Apr 2009) | 4 lines

GKSystem.cpp, made "safe" indices in vpoloidal-theta plot so will work for small problems
IBC's: fixed error in order of arguments to the tanh function.  Added parsing of tanh widths
from input deck; was defaulting to zero.   Removed diagnostic printouts.

------------------------------------------------------------------------
r152 | rcohen | 2009-04-26 11:08:12 -0700 (Sun, 26 Apr 2009) | 2 lines

Added diagnostic print statements.   Getting nan's.

------------------------------------------------------------------------
r151 | rcohen | 2009-04-26 10:08:16 -0700 (Sun, 26 Apr 2009) | 2 lines

Undoing the overwrite of the Maxwell-Tanh distribution function which was just putting a unit f in a particular spatial cell.

------------------------------------------------------------------------
r150 | rcohen | 2009-04-25 13:01:07 -0700 (Sat, 25 Apr 2009) | 2 lines

Another small parameter change

------------------------------------------------------------------------
r149 | rcohen | 2009-04-25 12:50:12 -0700 (Sat, 25 Apr 2009) | 2 lines

More reasonable limits on grid

------------------------------------------------------------------------
r148 | rcohen | 2009-04-25 12:32:05 -0700 (Sat, 25 Apr 2009) | 2 lines

An input deck for "Tom's test case" based on looking at plots in Tom's memo.

------------------------------------------------------------------------
r147 | rcohen | 2009-04-25 11:48:17 -0700 (Sat, 25 Apr 2009) | 4 lines

Deleted banana_thin.in test case, replaced by banana_test.in, which has
more realistic parameters and an interesting banana thickness.
Left banana_fat.in in repo for an example of a super-fat banana.

------------------------------------------------------------------------
r146 | rcohen | 2009-04-25 11:39:55 -0700 (Sat, 25 Apr 2009) | 2 lines

Corrected sign error in tanh specification

------------------------------------------------------------------------
r145 | rcohen | 2009-04-24 11:49:42 -0700 (Fri, 24 Apr 2009) | 3 lines

Changed order of poloidal and radial decomposition in GKSystem.cpp.
Added scripts for "thin" "fat" banana orbit blob tests.

------------------------------------------------------------------------
r144 | rcohen | 2009-04-23 08:30:58 -0700 (Thu, 23 Apr 2009) | 7 lines

Corrected errors in GKUnit.cpp: wrong expressions for gyrofrequency and gyroradius -- specious
divide by sqrt(permittivity*permeability) in gyrofrequency; multiply instead of divide in
gyroradius.  Combined these make a difference of 10**16 in magnitude of the larmor number!

Changed input units for temperature and mass from degrees K and kG to eV and AMU,
respectively, in order to follow common plasma physics practice.

------------------------------------------------------------------------
r143 | rcohen | 2009-04-22 13:52:25 -0700 (Wed, 22 Apr 2009) | 2 lines

Multiply dv_parallel by factor of 2 since now running from -vparallelmax to +vparallelmax.

------------------------------------------------------------------------
r142 | mdorr | 2009-04-22 11:56:22 -0700 (Wed, 22 Apr 2009) | 2 lines

Fixing vparallel domain box direction to be centered at 0 with an even number of cells.  Replaced some VP_DIR indices with MU_DIR indices in the phase space injection functions.

------------------------------------------------------------------------
r141 | rcohen | 2009-04-21 17:11:59 -0700 (Tue, 21 Apr 2009) | 3 lines

Replaced reused stringstream "filename" by locally defined "filename1" and
"filename2" as the former was not working on the Mac.

------------------------------------------------------------------------
r140 | rcohen | 2009-04-21 16:03:57 -0700 (Tue, 21 Apr 2009) | 4 lines

Changed "if 0" to "if 1" to activate vpar vs poloidal plotting --
except on Smaug it seems to do nothing (no file generated).  And on
the mac I get an illegal name errror at run time.

------------------------------------------------------------------------
r139 | rcohen | 2009-04-21 12:43:07 -0700 (Tue, 21 Apr 2009) | 14 lines

Changed name of m_maxwellian to m_initial_dfn, and added explicit copies to set
its values; this fixes getting specious values for boundary conditions.   Also removed
an "if 0" in LocalizedIBC.cpp that was skipping around the copy into boundary cells.
The copying into m_initial_dfn was added into LocalizedIBC and also MTanhElecIBC
and MTanhIonIBC.

Also incorporated Milo's new coding to plot f versus vparallel and poloidal angle, but
for now this is skipped with an "if 0" because it produces an invalid file name error.

Added a preprocessor flag "NORADDECOMP" which, if set, puts the entire radial domain
on each patch (no radial decomposition), useful for testing poloidal advection issues. This flag
will cause lines to compile which Milo had hard-wired into his latest emailed version
of GKSystem.cpp

------------------------------------------------------------------------
r138 | rcohen | 2009-04-17 15:47:58 -0700 (Fri, 17 Apr 2009) | 2 lines

Moved mirrortest.in to the input directory

------------------------------------------------------------------------
r137 | rcohen | 2009-04-17 15:46:26 -0700 (Fri, 17 Apr 2009) | 2 lines

Adding test of mirroring blob of phase space

------------------------------------------------------------------------
r136 | dmartin | 2009-04-17 00:02:35 -0700 (Fri, 17 Apr 2009) | 2 lines

re-fixed factor of 1/12 vs. 1/24 confusion for the tangential gradient dot-product factor in the fourth-order multiplication

------------------------------------------------------------------------
r135 | rcohen | 2009-04-16 21:11:34 -0700 (Thu, 16 Apr 2009) | 2 lines

Added print statement before fixed-time "Mayday" so that the limiting timestep is printed

------------------------------------------------------------------------
r134 | rcohen | 2009-04-16 20:56:45 -0700 (Thu, 16 Apr 2009) | 2 lines

Lowered the poloidal resolution to 16 for some quick testing of parallel problems

------------------------------------------------------------------------
r133 | mdorr | 2009-04-16 14:45:09 -0700 (Thu, 16 Apr 2009) | 6 lines

Fixed radial drifts (at least to the extent that uninitialized values are no longer appearing).

Added psidr to the specification of the Miller magnetic geometry.  Also added a missing factor of 1/kappa to the poloidal field component.

Fixed the velocity for the radial test.

------------------------------------------------------------------------
r132 | mdorr | 2009-04-15 18:04:35 -0700 (Wed, 15 Apr 2009) | 8 lines

Removed temporary modifications to the gyrokinetic velocities.  Added an option to the phase_space_mapping input parameters to enable special purpose velocities to be specified for testing purposes.  Two such subroutines are provided (the poloidal and radial advection cases), but more can be added using these examples as a template.

Also added a no_drifts option to the phase_space_mapping.

Modified the input files to reflect these changes.

Also fixed a problem with the routing to plot velocity data at a particular configuration space point.

------------------------------------------------------------------------
r131 | rcohen | 2009-04-15 17:30:13 -0700 (Wed, 15 Apr 2009) | 4 lines

Mia culpa -- factor of two missing in the Maxwellian normalizations for the temperature
and thermal speeds to be consistent with usage elsewhere in the code.  Corrected in
these commits.

------------------------------------------------------------------------
r130 | rcohen | 2009-04-14 22:36:25 -0700 (Tue, 14 Apr 2009) | 3 lines

Corrected initialization of localized blob to account for periodicity in poloidal and toroidal
directions

------------------------------------------------------------------------
r129 | mdorr | 2009-04-11 17:23:56 -0700 (Sat, 11 Apr 2009) | 2 lines

Fixed RK4 function evaluations.  Added SpeciesModel copy member.  Fixed GKSystem advance (old and new solution vectors were actually aliased).  Changed GKVlasov setRHS member to divide my mapped cell volume instead of physical cell volume.  The blob advection test seems to now work correctly.

------------------------------------------------------------------------
r128 | mdorr | 2009-04-10 18:14:31 -0700 (Fri, 10 Apr 2009) | 2 lines

Fixing phase space cell volume area factors used in flux divergence calculation (correctly this time, I hope).

------------------------------------------------------------------------
r127 | mdorr | 2009-04-09 19:07:29 -0700 (Thu, 09 Apr 2009) | 2 lines

Updated input files to be consistent with the new way of specifying the geometry radial extent.

------------------------------------------------------------------------
r126 | mdorr | 2009-04-09 19:05:51 -0700 (Thu, 09 Apr 2009) | 2 lines

Changed specificatoin of Miller geometry radial coordinate by changing the domain of the mapped grid radial coordinate to go from 0 to the domain radial width.  Added accessor functions to the magnetic geometry to return the location of the inner and outer radial boundaries.  Other changes related to this.

------------------------------------------------------------------------
r125 | mdorr | 2009-04-08 09:55:39 -0700 (Wed, 08 Apr 2009) | 6 lines

Fixed phase space metric factors to include correct (phase space) face areas rather than just the configuration or velocity space area factors from which they are derived.

Corrected Vlasov RHS calculation to return the (negative) average divergence instead of the (negative) cell-integrated divergence.

Changed the velocity space coordinate system to distribute it over all processors, rather than just one.

------------------------------------------------------------------------
r124 | rcohen | 2009-03-31 09:35:59 -0700 (Tue, 31 Mar 2009) | 11 lines

Added option to read psi_limiter in GKSystem.cpp and associated modifications to
GKSystem.H.   Added documentation on use of input variables to GKSystem.H, so should
appear in doxygen output.

Added poloidal limiter logic to poloidal boundary conditions for localizedIBC.
Restored localization in vparallel and mu to localizedIBC; please set vparallel, mu widths to large
numbers in input deck following current example in blob_test.in, rather than modifying the
source, to run a case with no localization in vparallel and mu.

Made nrad a const int in MtanhElecIBC.cpp and MTanhIonIBC.cpp

------------------------------------------------------------------------
r123 | mdorr | 2009-03-30 17:17:37 -0700 (Mon, 30 Mar 2009) | 2 lines

Fixing bug that was causing the magnetic geometry to be shifted by a half cell.

------------------------------------------------------------------------
r122 | dmartin | 2009-03-23 16:26:25 -0700 (Mon, 23 Mar 2009) | 2 lines

fixed factor of 1/12 vs. 1/24 confusion in fourth-order multiplication in advection

------------------------------------------------------------------------
r121 | dmartin | 2009-03-17 14:48:56 -0700 (Tue, 17 Mar 2009) | 2 lines

cleaned up filename generation for the density 2d plots.

------------------------------------------------------------------------
r120 | mdorr | 2009-03-14 19:41:26 -0700 (Sat, 14 Mar 2009) | 2 lines

In copy constructor, changing to explicit LevelData defines and FAB by FAB copies, since the LevelData copy constructor doesn't seem to be working...

------------------------------------------------------------------------
r119 | mdorr | 2009-03-14 18:05:19 -0700 (Sat, 14 Mar 2009) | 2 lines

Restructuring phase space coordinate systems to reduce data duplication.

------------------------------------------------------------------------
r118 | mdorr | 2009-03-13 18:21:36 -0700 (Fri, 13 Mar 2009) | 2 lines

Fixed velocity space decomposition bug.  For initial testing purposes only, buggered the velocity to be the normalized field times the minor radius.  Removed the toroidal component in the annulus test problem and the velocity space localization in the blob initial condition function.

------------------------------------------------------------------------
r117 | rcohen | 2009-03-13 17:10:38 -0700 (Fri, 13 Mar 2009) | 9 lines

Added the setting of poloidal limter boundary conditions.    This requires adding
an input variable for the limiter radius, which hasn't been done yet; so for now, if
the poloidal direction is periodic, these b.c.'s are ignored; if poloidal direction is
not periodic, the entire radial domain has a poloidal limiter.   Also poloidal limiter
b.c.'s should be set to explicit prescription (reflecting or zero) or set to extrapolation
based on the sign of the poloidal component of the total flow.   For now this is done
solely on the basis of vparallel.   We need to have access to the total flow across the
boundary face to improve upon this.

------------------------------------------------------------------------
r116 | dmartin | 2009-03-12 17:43:42 -0700 (Thu, 12 Mar 2009) | 2 lines

switched all instances (at least all that I could find) of reversed ReductionCopiers to SpreadingCopiers.

------------------------------------------------------------------------
r115 | dmartin | 2009-03-12 17:42:56 -0700 (Thu, 12 Mar 2009) | 2 lines

fixed some dimensioning issues for temporaries which (I think) were reducing us to 2nd-order along edges of grid boxes

------------------------------------------------------------------------
r114 | rcohen | 2009-03-10 15:25:54 -0700 (Tue, 10 Mar 2009) | 2 lines

Corrected prefix for IBC boundary conditions in input deck, should be "IBC", was "IC".

------------------------------------------------------------------------
r113 | rcohen | 2009-03-03 12:41:12 -0800 (Tue, 03 Mar 2009) | 4 lines

Added blob_test.in, an input script that initializes a blob localized in psi, theta, vparallel, mu.
Also corrected the comments in LocalizedIBC.H to reflect a sample input deck with proper
variables.

------------------------------------------------------------------------
r112 | mdorr | 2009-03-02 13:30:49 -0800 (Mon, 02 Mar 2009) | 2 lines

Adding ghostcell vector to spread operators.

------------------------------------------------------------------------
r111 | mdorr | 2009-02-27 16:04:31 -0800 (Fri, 27 Feb 2009) | 2 lines

Fixes to moments, injection and several other things.  Added temporary plotting capability.

------------------------------------------------------------------------
r110 | rcohen | 2009-02-27 00:49:08 -0800 (Fri, 27 Feb 2009) | 15 lines

Added poloidal limiter boundary conditions -- entailed adding an overloaded def.
of setBoundaryValues to MTanhElecIBC and MTanhIonIBC's cpp and H files, adding
invocation of Fortran, and, in PoloidalIBCF.ChF, spelling out the limiter b.c.'s.

Note present implementation requres no patch decomposition in parallel direction,
as f(vparallel) and f(-vparallel) are assumed to be in the same patch.

Also note, psi_lim, the beginning psi for limiter b.c.'s, is an optional argument to
the IBC constructor; if not set it defaults to zero meaning the limiter covers all radii.
We need to add a read to fetch psi_lim from an input file, probably in GKSystem.cpp,
and then add to the IBC constructors.

Finally exchange should be called before ghostCellBC, or within ghostCellBC before calls
to setBoundaryValues, so that poloidal periodicity is enforced for radii less than psi_lim.

------------------------------------------------------------------------
r109 | rcohen | 2009-02-26 10:54:07 -0800 (Thu, 26 Feb 2009) | 3 lines

Modified psi_mid for n and T to place them within the physical domain (but different
from one another, for testing purposes

------------------------------------------------------------------------
r108 | rcohen | 2009-02-26 10:12:11 -0800 (Thu, 26 Feb 2009) | 2 lines

Added parameters for tanh initialization

------------------------------------------------------------------------
r107 | mdorr | 2009-02-24 23:51:37 -0800 (Tue, 24 Feb 2009) | 2 lines

Some minor tidying up.  Fixed the GKSystem destructor that was seg faulting at the end of runs.

------------------------------------------------------------------------
r106 | mdorr | 2009-02-24 13:06:03 -0800 (Tue, 24 Feb 2009) | 2 lines

Fixed some problems with the velocity calculation.  Added some members to plot stuff.

------------------------------------------------------------------------
r105 | mdorr | 2009-02-24 13:05:01 -0800 (Tue, 24 Feb 2009) | 2 lines

Adding input file for annular geometry (just the Miller geometry made round).

------------------------------------------------------------------------
r104 | rcohen | 2009-02-19 22:08:13 -0800 (Thu, 19 Feb 2009) | 2 lines

Corrected comments for PointVal

------------------------------------------------------------------------
r103 | rcohen | 2009-02-19 22:04:43 -0800 (Thu, 19 Feb 2009) | 7 lines

GKSystem.cpp: added instantiation of class for new ics_type, "localized" (class files had
been checked in previously).
MTanhElecIBC.H, MTanhElecIBC.cpp and MTanhIBCF.ChF are modified to initialize the
quasineutral electron density corrected for the difference between theoretical and
numerical densities of an electron Maxwellian distribution function, in accord with the
pdf document I emailed recently.

------------------------------------------------------------------------
r102 | dmartin | 2009-02-19 17:12:12 -0800 (Thu, 19 Feb 2009) | 2 lines

implement real dt computation. Not quite soup yet but close... (should still compile, at least)

------------------------------------------------------------------------
r101 | dmartin | 2009-02-19 17:11:22 -0800 (Thu, 19 Feb 2009) | 2 lines

fix mis-spelling

------------------------------------------------------------------------
r100 | mdorr | 2009-02-19 15:54:37 -0800 (Thu, 19 Feb 2009) | 2 lines

Fixed boundary condition bug.

------------------------------------------------------------------------
r99 | mdorr | 2009-02-19 10:45:38 -0800 (Thu, 19 Feb 2009) | 2 lines

Fixes to phase space divergence calculation.

------------------------------------------------------------------------
r98 | mdorr | 2009-02-17 18:37:26 -0800 (Tue, 17 Feb 2009) | 2 lines

Added define() to override that in FourthOrderCoordSys.  Added dXdxi and computePointwiseJ() members, based on their configuration and velocity space analogs.

------------------------------------------------------------------------
r97 | rcohen | 2009-02-17 16:31:47 -0800 (Tue, 17 Feb 2009) | 6 lines

Commented out the 5D lines and the not-working #if test in LocalizedIBCF.ChF file.
It would be nice in the future if there were macros available in the ChF files to test
on dimension and include/exclude lines accordingly.  This will be needed to have
a version of Localized.cpp that works in either 4D or 5D.  Note that the #if CFG_DIM
macros ARE in place in LocalizedIBC.cpp.

------------------------------------------------------------------------
r96 | rcohen | 2009-02-15 10:29:47 -0800 (Sun, 15 Feb 2009) | 2 lines

Added hooks into GKSystem.cpp to use the Localized ibc option.

------------------------------------------------------------------------
r95 | rcohen | 2009-02-15 10:20:41 -0800 (Sun, 15 Feb 2009) | 7 lines

Added files to create an initial blob of f localized in all dimensions.   I can't get this to build
successfully when I try to have a 4D or 5D version -- see LocalizedIBCF.ChF.try1 and
LocalizedIBCF.ChF.try2.   Seems like if #CFG_DIM==3 preprocessor macros don't work
in ChF files.

Also updated comments in MTanhElecIBC.H and MTanhIonIBC.H.

------------------------------------------------------------------------
r94 | rcohen | 2009-02-12 23:05:51 -0800 (Thu, 12 Feb 2009) | 7 lines

Added vparshift to vparallel computation in IBC classes.
Shifted from CFG  potential to potential injected into phase space in the IBC
classes, and in the invocation in GKSystem.cpp; added the injected potential
as member data in GKSystem.H and did the injection in GKSystem.cpp.  This is
in preparation for implementing potential-dependent boundary conditions
at poloidal limiters.

------------------------------------------------------------------------
r93 | dmartin | 2009-02-12 16:10:46 -0800 (Thu, 12 Feb 2009) | 2 lines

change to always inject at low end of domain rather than arbitrarily picking 0.  This is useful when your domain doesn't include 0.

------------------------------------------------------------------------
r92 | mdorr | 2009-02-12 14:52:41 -0800 (Thu, 12 Feb 2009) | 2 lines

Adding velocity to phase space injection.

------------------------------------------------------------------------
r91 | mdorr | 2009-02-12 12:09:06 -0800 (Thu, 12 Feb 2009) | 2 lines

Fixing and cleaning up the construction of the configuration, velocity and phase space datalayouts.  The code still doesn't run correctly in parallel, but this will help.

------------------------------------------------------------------------
r90 | dmartin | 2009-02-09 16:45:21 -0800 (Mon, 09 Feb 2009) | 4 lines

fixed a couple of DisjointBoxLayout inconsistencies in the spreading operations.

also removed temporary LevelData<FArrayBox> which was no longer necessary.

------------------------------------------------------------------------
r89 | dmartin | 2009-02-06 17:09:16 -0800 (Fri, 06 Feb 2009) | 2 lines

switch to using adjCellLo with a lenght of -1, which should result in boxes inside the domain

------------------------------------------------------------------------
r88 | mdorr | 2009-02-06 15:22:09 -0800 (Fri, 06 Feb 2009) | 2 lines

one more time with conflicts resolved.

------------------------------------------------------------------------
r87 | mdorr | 2009-02-06 15:17:53 -0800 (Fri, 06 Feb 2009) | 2 lines

Adding call to set initial conditions

------------------------------------------------------------------------
r86 | mdorr | 2009-02-06 15:15:17 -0800 (Fri, 06 Feb 2009) | 2 lines

Commenting out assertions on unused m_params_are_set

------------------------------------------------------------------------
r85 | mdorr | 2009-02-06 15:13:37 -0800 (Fri, 06 Feb 2009) | 2 lines

Added domain argument to ReductionOp.

------------------------------------------------------------------------
r84 | mdorr | 2009-02-06 15:12:29 -0800 (Fri, 06 Feb 2009) | 2 lines

Making the geometry smaller to speed up testing.

------------------------------------------------------------------------
r83 | rcohen | 2009-02-06 12:10:06 -0800 (Fri, 06 Feb 2009) | 2 lines

Added comments about addition of phi to constructors

------------------------------------------------------------------------
r82 | rcohen | 2009-02-06 12:06:45 -0800 (Fri, 06 Feb 2009) | 4 lines

Added comments into GKSystem source about the future need for iteration
between distribution function initialization and field solve if we have potential-dependent
initial conditions

------------------------------------------------------------------------
r81 | rcohen | 2009-02-06 12:00:23 -0800 (Fri, 06 Feb 2009) | 8 lines

Added an initialization (to zero) of the potential, and added potential to constructors
for MTanhElecIBC and MTanhIonIBC classes.  This is in preparation for limiter
boundary conditions.  Also moved the definition of the potential to ahead of
the creation of the kinetic species.  This is fine for a non-evolving potential,
or for an evolving potential upon which the initial conditions don't depend. But
if we move to potential-dependent initial conditions with a self-consistent
potential, iteration will be required.

------------------------------------------------------------------------
r80 | mdorr | 2009-02-06 10:51:29 -0800 (Fri, 06 Feb 2009) | 4 lines

Fixing the 1D array indexing.

At some point, it would be helpful to have Chombo Fortran macros that allow the passing of 1D arrays specifying the lower and upper index bounds to be used in the Fortran.

------------------------------------------------------------------------
r79 | rcohen | 2009-02-05 23:04:35 -0800 (Thu, 05 Feb 2009) | 3 lines

Correcting typo: in assigning values to the mu array, elements of vp were set instead
of mu

------------------------------------------------------------------------
r78 | rcohen | 2009-02-05 21:49:41 -0800 (Thu, 05 Feb 2009) | 2 lines

Deleted my erroneous comment about OS X

------------------------------------------------------------------------
r77 | dmartin | 2009-02-05 17:38:28 -0800 (Thu, 05 Feb 2009) | 2 lines

advection now appears to compile and run in the GKVlasov sandbox.  Whether it's correct or not is a question for tomorrow...

------------------------------------------------------------------------
r76 | dmartin | 2009-02-05 00:48:28 -0800 (Thu, 05 Feb 2009) | 2 lines

updated AdvectOp.ChF to (mostly) compile in 4D, commented out stuff which is still broken so that code at least compiles.

------------------------------------------------------------------------
r75 | dmartin | 2009-02-05 00:45:54 -0800 (Thu, 05 Feb 2009) | 2 lines

added virtual destructors for the sole purpose of quieting the compiler warnings

------------------------------------------------------------------------
r74 | dmartin | 2009-02-04 22:55:48 -0800 (Wed, 04 Feb 2009) | 2 lines

progress on implementing advection. Nothing "hooked up" yet.

------------------------------------------------------------------------
r73 | mdorr | 2009-02-04 17:46:56 -0800 (Wed, 04 Feb 2009) | 2 lines

Converted to Chombo Fortran macros

------------------------------------------------------------------------
r72 | mdorr | 2009-02-04 17:36:44 -0800 (Wed, 04 Feb 2009) | 2 lines

Modification to the injection of configuration space data to phase space data based on Dan's new spreading operator.

------------------------------------------------------------------------
r71 | dmartin | 2009-02-04 09:30:34 -0800 (Wed, 04 Feb 2009) | 3 lines

adding hooks for advection. No functionality yet, but almost.
(for the moment, still return 0 fluxes)

------------------------------------------------------------------------
r70 | dmartin | 2009-02-03 14:33:15 -0800 (Tue, 03 Feb 2009) | 2 lines

uncommented rule which calls "moveToBoxTools" script in Chombo/example/FourthOrderCoordSys...

------------------------------------------------------------------------
r69 | rcohen | 2009-01-24 12:11:41 -0800 (Sat, 24 Jan 2009) | 2 lines

added boundary ghost cells to initialized density and temperature profiles

------------------------------------------------------------------------
r68 | rcohen | 2009-01-23 15:35:34 -0800 (Fri, 23 Jan 2009) | 3 lines

Changed name of fortran file, removing "Ion" from name, since it applies to both ions
and electrons.

------------------------------------------------------------------------
r67 | rcohen | 2009-01-23 15:33:21 -0800 (Fri, 23 Jan 2009) | 5 lines

Added fortran initialization of electron distribution function.  Changed name of subroutine
that does the ions (in MTanhIonIBC.cpp and MTanhiIonIBCF_F.f) to distinguish it from the
electron method; specfically it differs by having a 1D rather than 2D density.  So it
is now called set_maxwell4d_1dnt.

------------------------------------------------------------------------
r66 | mdorr | 2009-01-22 15:10:37 -0800 (Thu, 22 Jan 2009) | 2 lines

Modifications to support the restructuring of the initial and boundary condition setting stuff.

------------------------------------------------------------------------
r65 | mdorr | 2009-01-22 15:09:46 -0800 (Thu, 22 Jan 2009) | 2 lines

Added new src/ibc directory for initial condition and boundary condition setting stuff.  Under src/ibc, further added phase and configuration subdirectories.  Moved all of the previous initial and boundary condition files from src/core to the new directories, putting the base class files in ibc and the files containing the concrete classes in the phase and configuration directories as appropriate.

------------------------------------------------------------------------
r64 | rcohen | 2009-01-22 14:08:57 -0800 (Thu, 22 Jan 2009) | 3 lines

Replaced references to PhaseSpaceCoords by refs. to MagGeomCoords and substituted
appropriate header file

------------------------------------------------------------------------
r63 | rcohen | 2009-01-22 13:44:24 -0800 (Thu, 22 Jan 2009) | 2 lines

Class to initialize configuration space fields as a radial tanh.   This compiles, but wrongly extracts the problem domain from a PhaseSPaceCoordSys object.  Not sure how this plays with linking this in a CFG namespace.

------------------------------------------------------------------------
r62 | mdorr | 2009-01-20 16:28:52 -0800 (Tue, 20 Jan 2009) | 2 lines

Adding some Fortran for setting the Maxwellian initial and boundary conditions.

------------------------------------------------------------------------
r61 | rcohen | 2009-01-09 10:14:22 -0800 (Fri, 09 Jan 2009) | 3 lines


Created instance of * bcs, set to ics.

------------------------------------------------------------------------
r60 | mdorr | 2009-01-09 08:52:27 -0800 (Fri, 09 Jan 2009) | 2 lines

Added missing public modifier to publically derive from BCInterface.

------------------------------------------------------------------------
r59 | rcohen | 2009-01-08 18:19:12 -0800 (Thu, 08 Jan 2009) | 11 lines

Updated MaxwellTanh*IC.* to remove references to m_speciesname and a_speciesname
which are no longer used.

Added files MTanhElecIBC.H MTanhElecIBC.cpp MTanhIonIBC.H MTanhIonIBC.cpp  for
combined initial-boundary condition setting for case where b.c.'s are stationary and
consistent with ic's.

Partially modified GKSystem.cpp to take the IBC class -- compiles as committed, but won't
compile if I attempt to define a bcs object and set it equal to the successfully defined
ics instance of IBCinterface.   See comment lines with *** in GKSystem.cpp.

------------------------------------------------------------------------
r58 | rcohen | 2009-01-08 14:11:06 -0800 (Thu, 08 Jan 2009) | 2 lines

Committing Jeff's definition of SpeciesPtr

------------------------------------------------------------------------
r57 | rcohen | 2009-01-08 13:42:54 -0800 (Thu, 08 Jan 2009) | 2 lines

Removed redeclaration of ics, which was causing warnings in compilation. (Thanks, Jeff!).

------------------------------------------------------------------------
r56 | rcohen | 2009-01-08 10:52:55 -0800 (Thu, 08 Jan 2009) | 5 lines

ICInterface: removed speciesname from ICInterface's initialize(); should have done this earlier.

GKSystem.cpp: added coding to use the MaxwellTanh initialization
classes.  Compiles, but gives warnings about the created ics objects not being used.

------------------------------------------------------------------------
r55 | rcohen | 2009-01-06 16:30:07 -0800 (Tue, 06 Jan 2009) | 3 lines

Proper electron and ion initial condition files, which calculate electron density from summed
computed ion densities

------------------------------------------------------------------------
r54 | dmartin | 2009-01-06 14:07:10 -0800 (Tue, 06 Jan 2009) | 2 lines

moved "all" target out of the Make.multidim.basic file to make things work a bit better

------------------------------------------------------------------------
r53 | dmartin | 2009-01-06 13:43:06 -0800 (Tue, 06 Jan 2009) | 5 lines

made a new default target called "all-with-move", which depends on the newly-added move-script target as well as the pre-existing "all" target. At this point, one of two things will happen. Typing "make" will either:
1. run the moveToBoxTools script and then do a make all
or
2. break horribly on any machine other than loren.

------------------------------------------------------------------------
r52 | jhittinger | 2009-01-05 15:26:29 -0800 (Mon, 05 Jan 2009) | 2 lines

Added dimensionality to SpeciesModel and Kineticspecies, and Moment operator is now defined.

------------------------------------------------------------------------
r51 | jhittinger | 2008-12-31 16:11:56 -0800 (Wed, 31 Dec 2008) | 2 lines

Helper headers that define the multiple dimensions and enums for the directions, respectively.  These should be used to reduce the redundancy of these definitions in multiple files.

------------------------------------------------------------------------
r50 | dmartin | 2008-12-22 01:17:22 -0800 (Mon, 22 Dec 2008) | 2 lines

some factoring and cleanup of the Chombo multidim build system. GNUmakefile now simply defines a couple of relevant variables, then includes Chombo/lib/mk/Make.multidim.basic, which contains the relevant rules and scripts.

------------------------------------------------------------------------
r49 | mdorr | 2008-12-19 17:12:56 -0800 (Fri, 19 Dec 2008) | 8 lines

Adding IBCInterface class, which is derived from both ICInterface and
BCInterface.  The intent is to enable a single class to be used for both
boundary and initial condition setting.  Such a unified class can then
be used to, say, set Maxwellian initial and boundary conditions, without
duplicating the same code in two places.  MaxwellianIBCInterface (derived
from IBCInterface) is a skeleton such a class, into which I imagined some
of Ron's ICTanh coding being incorporated (had I more time today).

------------------------------------------------------------------------
r48 | rcohen | 2008-12-19 16:09:13 -0800 (Fri, 19 Dec 2008) | 3 lines

Removed restriction on number of kinetic species from ICTanh.cpp.
Code should now construct initialelectron density from summing over ion densities times charges

------------------------------------------------------------------------
r47 | rcohen | 2008-12-19 14:24:59 -0800 (Fri, 19 Dec 2008) | 2 lines

added ; to end of class definition in .H.

------------------------------------------------------------------------
r46 | mdorr | 2008-12-19 13:20:35 -0800 (Fri, 19 Dec 2008) | 2 lines

Change PhaseSpaceCoordSys argument on initialize function to CoordSys and added dynamic cast.

------------------------------------------------------------------------
r45 | rcohen | 2008-12-19 12:54:39 -0800 (Fri, 19 Dec 2008) | 2 lines

Added speciesname to initialize's interface

------------------------------------------------------------------------
r44 | rcohen | 2008-12-19 12:41:18 -0800 (Fri, 19 Dec 2008) | 5 lines

Lots of fixes to ICTanh, and renamed database file in ICInterface.H.
Note there is still one compile error inICTanh.cpp associated with namespacefooter.H.  It
occurs even if namespacefooter is placed directly after namespace header.  The error is:
./../Chombo/lib/include/multidim/NamespaceFooter.H:19: error: expected unqualified-id before '}' token

------------------------------------------------------------------------
r43 | dmartin | 2008-12-18 23:42:50 -0800 (Thu, 18 Dec 2008) | 2 lines

added some NamespaceFooters

------------------------------------------------------------------------
r42 | rcohen | 2008-12-18 15:34:20 -0800 (Thu, 18 Dec 2008) | 3 lines

first version of ICTanh.cpp, concrete implementation of distribution function initialization.
Suffix "dev" has been added so that it will not mess up a build.

------------------------------------------------------------------------
r41 | rcohen | 2008-12-18 15:20:31 -0800 (Thu, 18 Dec 2008) | 2 lines

Changed type of arg. a_dfn in PointVal to be consistent with type in calling function

------------------------------------------------------------------------
r40 | dmartin | 2008-12-18 14:26:02 -0800 (Thu, 18 Dec 2008) | 2 lines

reordered some initializations to quiet some compiler warnings

------------------------------------------------------------------------
r39 | rcohen | 2008-12-18 14:16:44 -0800 (Thu, 18 Dec 2008) | 2 lines

Deleted unused argument includeJ from PointVal

------------------------------------------------------------------------
r38 | rcohen | 2008-12-18 13:58:14 -0800 (Thu, 18 Dec 2008) | 2 lines

Corrected for consistency with interfaces used in ICTanh.cpp

------------------------------------------------------------------------
r37 | rcohen | 2008-12-18 13:42:35 -0800 (Thu, 18 Dec 2008) | 2 lines

Corrected sequence for including NameSpaceHeader.H

------------------------------------------------------------------------
r36 | rcohen | 2008-12-18 13:37:10 -0800 (Thu, 18 Dec 2008) | 2 lines

Corrected type for a_coordSys

------------------------------------------------------------------------
r35 | rcohen | 2008-12-18 13:23:18 -0800 (Thu, 18 Dec 2008) | 3 lines

Header file for concrete distribution function initialization class that sets up radial tanh functions
times a maxwellian.

------------------------------------------------------------------------
r34 | rcohen | 2008-12-18 13:17:23 -0800 (Thu, 18 Dec 2008) | 2 lines

Added a ParmParse object to constructor of ICInterface

------------------------------------------------------------------------
r33 | ligocki | 2008-12-17 18:34:02 -0800 (Wed, 17 Dec 2008) | 11 lines

Changed make system so it doesn't need "multiDimBuild.csh" (as was the case in
"Chombo/example/MultiDimPhase/exec").

Now, all options set on the "make" command line are passed through to the rest
of the build and you don't have to change make options in the shell script.
Further, parallel build flags, (e.g., "-j8") are passed through and used at
all levels of the build.

Finally, "USE_MT" ISN'T set to "FALSE" by default.  This will have to be done
on the "make" command line or in the "GNUmakefile"...

------------------------------------------------------------------------
r32 | dmartin | 2008-12-17 14:50:51 -0800 (Wed, 17 Dec 2008) | 2 lines

moved "Constants.H" to "ESLConstants.H" to avoid possible collision with "CONSTANTS.H"

------------------------------------------------------------------------
r31 | mdorr | 2008-11-21 16:23:11 -0800 (Fri, 21 Nov 2008) | 2 lines

Changed the phase space domain decomposition strategy.  Changed preprocessor macros CDIM and VDIM to CFG_DIM and VEL_DIM for clarity and consistency with other macros.

------------------------------------------------------------------------
r30 | mdorr | 2008-11-21 09:10:34 -0800 (Fri, 21 Nov 2008) | 2 lines

Miscellaneous changes associated with the calculation of the phase space velocities.

------------------------------------------------------------------------
r29 | mdorr | 2008-11-19 08:48:45 -0800 (Wed, 19 Nov 2008) | 2 lines

Many changes to support the construction of the phase space velocities.  The phase space coordinate system now belongs to species objects, since gyrocenter coordinates depend upon species data (mass and charge state).  The magnetic geometry now returns cell-averaged quantities rather than face-averaged quantities as before.  Cell-averaged configuration space quantities (e.g. field quantities) are injected into face-averaged quantities in phase space by a PhaseSpaceCoordSys member that uses the Chombo multidim injection and spreading operations.

------------------------------------------------------------------------
r28 | dmartin | 2008-11-01 16:26:36 -0700 (Sat, 01 Nov 2008) | 2 lines

various changes hither and yon to follow the Chombo BaseTools migration

------------------------------------------------------------------------
r27 | dmartin | 2008-11-01 16:26:05 -0700 (Sat, 01 Nov 2008) | 5 lines

incorporating Terry's improvements to the multidim build setup:
1. replaced multiDimBuild.pl perl script with multiDimBuild.chs shell script
2. replaced GNUmakefile.multiDim with GNUmakefile.multidim for consistency with MultiDimPhase example
3. modified base GNUmakefile so that typing "make all" now does the multidim build

------------------------------------------------------------------------
r26 | dmartin | 2008-11-01 16:24:15 -0700 (Sat, 01 Nov 2008) | 3 lines

updated to follow ParmParse's move out of the dimensional namespaces
(no longer need to call it once for 2d and once for 4d)

------------------------------------------------------------------------
r25 | mdorr | 2008-10-30 18:05:27 -0700 (Thu, 30 Oct 2008) | 2 lines

Just syncing recent changes since I haven't commited for a while.  Modified GKSystem to read in species data.  Made many modifications to MagGeomCoordSys, GKVlasov and PhaseSpaceCoordSys to compute the actual gyrocenter fluxes, which is still in progress.

------------------------------------------------------------------------
r24 | dmartin | 2008-10-17 16:42:30 -0700 (Fri, 17 Oct 2008) | 2 lines

renamed multiDimBuild perl script from .pm (perl module) to .pl following the naming convention used pretty much everywhere else

------------------------------------------------------------------------
r23 | dmartin | 2008-10-17 16:40:55 -0700 (Fri, 17 Oct 2008) | 2 lines

multidim build works again...

------------------------------------------------------------------------
r22 | dmartin | 2008-10-15 17:49:27 -0700 (Wed, 15 Oct 2008) | 2 lines

more hacking away at the makefiles. Multidim build is still somewhat unhappy, though

------------------------------------------------------------------------
r21 | mdorr | 2008-10-08 17:40:11 -0700 (Wed, 08 Oct 2008) | 2 lines

Just commiting latest version so Dan can see the next problem.

------------------------------------------------------------------------
r20 | dmartin | 2008-10-08 16:19:12 -0700 (Wed, 08 Oct 2008) | 2 lines

removed makefile comment which was making emacs unhappy...

------------------------------------------------------------------------
r19 | dmartin | 2008-10-08 16:18:23 -0700 (Wed, 08 Oct 2008) | 2 lines

removed part of comment which was making emacs unhappy...

------------------------------------------------------------------------
r18 | mdorr | 2008-10-06 09:51:50 -0700 (Mon, 06 Oct 2008) | 4 lines

Converted from 2D to 4D.  Changed UsingNamespace.H includes to NamespaceHeader.\
H and NamespaceFooter.H.  Subdivided the /src/coord directory into the phase an\
d configuration subdirectories

------------------------------------------------------------------------
r17 | mdorr | 2008-10-01 17:16:28 -0700 (Wed, 01 Oct 2008) | 2 lines

Updated Miller geometry to include a toroidal field component that varies radially as 1/R, but is constant in the other coordinate directions.

------------------------------------------------------------------------
r16 | dmartin | 2008-09-24 18:20:16 -0700 (Wed, 24 Sep 2008) | 7 lines

changes for multidimensional building:
1. added #include "UsingNamespace.H" to each *.[H,cpp] file
2. for now, at least, put esl.cpp specifically in 2D
3. renamed fortran subroutine calls from cpp to use Chombo macro convention
4. in a couple of places, started adding D_DECL where appropriate
5. added GNUmakefile.multiDim and multiDimBuild.pm to do multidim builds (left original non-multidim makefile in place and unchanged for now).

------------------------------------------------------------------------
r15 | dmartin | 2008-09-24 15:27:48 -0700 (Wed, 24 Sep 2008) | 2 lines

switch char* to const char* to avoid compiler warning

------------------------------------------------------------------------
r14 | dmartin | 2008-09-24 15:20:29 -0700 (Wed, 24 Sep 2008) | 2 lines

re-order variable initialization in constructor to match declaration order in Simulation.H (in order to avoid compiler warning)

------------------------------------------------------------------------
r13 | mdorr | 2008-09-23 13:49:02 -0700 (Tue, 23 Sep 2008) | 2 lines

Adding Miller et al. magnetic geometry implementation.

------------------------------------------------------------------------
r12 | jhittinger | 2008-09-04 16:01:25 -0700 (Thu, 04 Sep 2008) | 2 lines

Code runs through GKSystem initialization

------------------------------------------------------------------------
r11 | jhittinger | 2008-09-04 14:50:44 -0700 (Thu, 04 Sep 2008) | 2 lines

Fixed link problem.

------------------------------------------------------------------------
r10 | jhittinger | 2008-08-29 10:18:10 -0700 (Fri, 29 Aug 2008) | 2 lines

Changes compile (with icpc)

------------------------------------------------------------------------
r9 | jhittinger | 2008-08-29 00:09:04 -0700 (Fri, 29 Aug 2008) | 2 lines

Incremental additions

------------------------------------------------------------------------
r8 | jhittinger | 2008-08-28 17:15:14 -0700 (Thu, 28 Aug 2008) | 2 lines

Temporary update so that I have recent changes stored.  Note that these changes currently break the build (not that the code would do anything once built anyway).

------------------------------------------------------------------------
r7 | dmartin | 2008-08-18 15:37:51 -0700 (Mon, 18 Aug 2008) | 2 lines

couple of small changes to make the skeleton compile...

------------------------------------------------------------------------
r6 | dmartin | 2008-08-15 17:20:13 -0700 (Fri, 15 Aug 2008) | 2 lines

removed semicolon from end of namespace

------------------------------------------------------------------------
r5 | dmartin | 2008-08-15 17:19:53 -0700 (Fri, 15 Aug 2008) | 2 lines

commented out application-specific variables not specific to this application

------------------------------------------------------------------------
r4 | jhittinger | 2008-08-15 16:37:51 -0700 (Fri, 15 Aug 2008) | 2 lines

Added missing files

------------------------------------------------------------------------
r2 | jhittinger | 2008-08-15 16:29:31 -0700 (Fri, 15 Aug 2008) | 2 lines

Imported initial version of ESL code

------------------------------------------------------------------------
r1 | (no author) | 2008-08-15 16:29:31 -0700 (Fri, 15 Aug 2008) | 1 line

Standard project directories initialized by cvs2svn.
------------------------------------------------------------------------
